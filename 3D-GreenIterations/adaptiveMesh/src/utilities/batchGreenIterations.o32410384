Running on
      1 nyx7510
Running from /home/njvaughn/Greens-Functions-Iterative-Methods/3D-GreenIterations/adaptiveMesh/src/utilities
gradientFree =  True
Mixing scheme =  Anderson
vtk directory =  /home/njvaughn/O_with_anderson/LW5_1500o5_plots_eigRes
======================================================================
======================================================================
====================================================================== 

Reading atomic coordinates from:  ../src/utilities/molecularConfigurations/carbonMonoxide.csv
in testBatchGreen..., nOrbitals =  8
['../src/utilities/molecularConfigurations/carbonMonoxide.csv', '/home/njvaughn/O_with_anderson/LW5o5_1500_6_orbitals.csv', 14.0, 8, -112.471443237994, -11.997011069615391, -0.94214407530225852, -62.898682441673358, -1.0]
[ -1.87191496e+01  -9.90709856e+00  -1.07530710e+00  -5.21534840e-01
  -4.45554611e-01  -4.45554331e-01  -3.35142164e-01  -8.27912477e-02
  -8.27912477e-02   1.29036768e-02]
(10,)
Reading atomic coordinates from:  ../src/utilities/molecularConfigurations/carbonMonoxide.csv
Using single atom data from:
/home/njvaughn/AtomicData/allElectron/z6/singleAtomData/
Using single atom data from:
/home/njvaughn/AtomicData/allElectron/z8/singleAtomData/
Gauge shift  -1.0
Nuclear energy:  22.5181832905
Atom is contained in cell    which has no children.  Divide at atomic location.
There are now 8 leaf cells.
Atom located inside child  111
Calling recursive divide for this child, but not others.
Atom is contained in cell  111  which has no children.  Divide at atomic location.
There are now 15 leaf cells.
After aspect ratio divide there are 825 leaf cells.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~ Atoms ~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Z = 6 located at (x, y, z) = ( 0.615,  0.615,  0.615)
Z = 8 located at (x, y, z) = (-0.615, -0.615, -0.615)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

On the tree, nOrbitals =  8
type:  <class 'int'>
max depth  20
Number of gridpoints:  786500
max density:  125.388686535
Integrated density before normalization:  6.0083931269
Integrated density after normalization:  6.0
max density:  306.671323615
Integrated density before normalization:  14.0000576751
Integrated density after normalization:  14.0
Initializing density EXTERNALLY took 9.285 seconds.
Initializing orbitals for atom Z = 6 located at (x, y, z) = ( 0.615,  0.615,  0.615)
Orbital index = 0
Orbital 0 filled with (n,ell,m) = (1,0,0) 
Orbital 1 filled with (n,ell,m) = (2,0,0) 
Initializing orbitals for atom Z = 8 located at (x, y, z) = (-0.615, -0.615, -0.615)
Orbital index = 2
Orbital 2 filled with (n,ell,m) = (1,0,0) 
Orbital 3 filled with (n,ell,m) = (2,0,0) 
Didn't fill all the orbitals.  Should you initialize more?  Randomly, or using more single atom data?
Filling extra orbitals with random initial data.
Initializing orbital  4  randomly...
Initializing orbitals randomly inside Tree Structure took 1.241 seconds.
Initializing orbital  5  randomly...
Initializing orbitals randomly inside Tree Structure took 1.232 seconds.
Initializing orbital  6  randomly...
Initializing orbitals randomly inside Tree Structure took 1.236 seconds.
Initializing orbital  7  randomly...
Initializing orbitals randomly inside Tree Structure took 1.250 seconds.
Initializing orbitals EXTERNAL to Tree Structure took 92.142 seconds.
Tree build completed. 
Domain Size:                 [-20.0, 20.0] 
Divide Criterion:             LW5 
Divide Parameter:            1.00e+03 
Total Number of Cells:       7885 
Total Number of Leaf Cells:  6292 
Total Number of Gridpoints:  786500 
Minimum Depth                3 levels 
Maximum Depth:               12 levels 
Cell Order:                  5 
Construction time:           134 seconds.
Closest gridpoint to origin:  [-0.0075292575233478209, -0.0075292575233478209, -0.0075292575233478209]
For a distance of:  0.013041056573708638
Part of a cell centered at:  [-0.15383574999999999, -0.15383574999999999, -0.15383574999999999]

Entering greenIterations_KohnSham_SCF()

Number of targets:    786500
Threads per block:    512
Blocks per grid:      1537
[111.85061770418731, -11.997011069615391, -0.94214407530225852, -211.38290579726365, -112.471443237994, -1.0]
Integrated density:  14.0
Using Gaussian singularity subtraction, alpha =  1
Computing Vcoulomb took:    90.0114 seconds. 
Update orbital energies after computing the initial Veff.  Save them as the reference values for each cell
Computing orbital kinetics using Gradients
Orbital Energy:            [-11.00917496  -1.72094055 -19.86893231  -2.07798688   1.89837216
   9.38103837  10.01497424  10.17349287]
Sorted eigenvalues:  [-19.86893231 -11.00917496  -2.07798688  -1.72094055   1.89837216
   9.38103837  10.01497424  10.17349287]
New order:  [2 0 3 1 4 5 6 7]
Orbital energies after initial sort: 
 [-19.86893231 -11.00917496  -2.07798688  -1.72094055   1.89837216
   9.38103837  10.01497424  10.17349287]
Kinetic:    [ 15.71410223   1.64669004  28.75700974   3.19601829   2.90358765
  10.38523567  11.01900066  11.17747301]
Potential:  [-26.72327719  -3.36763058 -48.62594205  -5.27400518  -1.00521549
  -1.0041973   -1.00402642  -1.00398014]
Computing band energy.  Current orbital energies are:  [-19.86893231 -11.00917496  -2.07798688  -1.72094055   1.89837216
   9.38103837  10.01497424  10.17349287]
Electrostatic Energies:
Hartree:          74.8683834662
External:         -308.495981402
Nuclear-Nuclear:  22.5181832905
Updating total energy WITH explicit kinetic evaluation.
Orbital Energies:  [-19.86893231 -11.00917496  -2.07798688  -1.72094055   1.89837216
   9.38103837  10.01497424  10.17349287]
Orbital Energy Errors after initialization:  [ -1.49782693e-01  -1.02076395e-01  -2.67978682e-03  -1.99405707e-01
   3.34392678e+00   1.08265927e+01   1.13501164e+01   1.12562841e+01]
Updated V_x:                           -15.8117190048 Hartree
Updated V_c:                           -1.0427594488 Hartree
Updated Band Energy:                   -12.7652998580 H, -1.2461591756e+02 H
Updated Kinetic Energy:                 162.8483930647 H, 1.7484540413e+02 H
Updated E_x:                           -11.8587892536 H, -1.0916645178e+01 H
Updated E_c:                           -0.9340716599 H, 2.1044883414e+02 H
Updated totalElectrostatic:            -211.1094146448 H, -9.8637971407e+01 H
Total Energy:                          -61.0538824936 H, -6.0053882494e+01 H



SCF Count  1
Orbital Energies:  [-19.86893231 -11.00917496  -2.07798688  -1.72094055  -2.          -2.          -2.
  -2.        ]
Working on orbital 0
Using singularity subtraction.  Convolution time:  74.42249870300293
Norm of psiNew =  1.00005664365
eigenvalueHistory:  -19.870242335862553
Orbital energy after Harrison update:  -19.8702423359
Orbital 0 error and eigenvalue residual:   -1.511e-01 and 1.310e-03
Orbital 0 wavefunction residual: 9.621e-04


Turning on Anderson Mixing for wavefunction 0
Using singularity subtraction.  Convolution time:  74.40270662307739
Norm of psiNew =  0.999944140677
eigenvalueHistory:  [-19.87024234 -19.87025752]
Orbital energy after Harrison update:  -19.8702575175
Anderson mixing on the orbital.
Input densities has shape  (786500, 1)

Anderson weights:  [] 1.0
Orbital 0 error and eigenvalue residual:   -1.511e-01 and 1.518e-05
Orbital 0 wavefunction residual: 3.353e-04


Using singularity subtraction.  Convolution time:  74.42291212081909
Norm of psiNew =  0.99999958416
eigenvalueHistory:  [-19.87024234 -19.87025752 -19.87025875]
Orbital energy after Harrison update:  -19.8702587541
Anderson mixing on the orbital.
Input densities has shape  (786500, 2)

Anderson weights:  [-0.95620997] 1.95620997425
Orbital 0 error and eigenvalue residual:   -1.511e-01 and 1.237e-06
Orbital 0 wavefunction residual: 2.156e-04


Using singularity subtraction.  Convolution time:  74.40180945396423
Norm of psiNew =  1.00000006633
eigenvalueHistory:  [-19.87024234 -19.87025752 -19.87025875 -19.87025974]
Orbital energy after Harrison update:  -19.8702597407
Anderson mixing on the orbital.
Input densities has shape  (786500, 3)

Anderson weights:  [ 0.01782936 -0.64702112] 1.62919175627
Orbital 0 error and eigenvalue residual:   -1.511e-01 and 9.866e-07
Orbital 0 wavefunction residual: 8.367e-05


Using singularity subtraction.  Convolution time:  74.3903157711029
Norm of psiNew =  0.999999913393
eigenvalueHistory:  [-19.87024234 -19.87025752 -19.87025875 -19.87025974 -19.87025995]
Orbital energy after Harrison update:  -19.870259949
Anderson mixing on the orbital.
Input densities has shape  (786500, 4)

Anderson weights:  [-0.0155811   1.10196443 -2.87024822] 2.78386489407
Orbital 0 error and eigenvalue residual:   -1.511e-01 and 2.083e-07
Orbital 0 wavefunction residual: 1.110e-05


Using singularity subtraction.  Convolution time:  74.3925838470459
Norm of psiNew =  0.999999999557
eigenvalueHistory:  [-19.87024234 -19.87025752 -19.87025875 -19.87025974 -19.87025995
 -19.87025995]
Orbital energy after Harrison update:  -19.8702599541
Anderson mixing on the orbital.
Input densities has shape  (786500, 5)

Anderson weights:  [ 0.02870585 -2.00741435  5.22696226 -5.07777847] 2.82952471255
Orbital 0 error and eigenvalue residual:   -1.511e-01 and 5.084e-09
Orbital 0 wavefunction residual: 7.019e-07


Used 6 iterations for orbital 0.



Working on orbital 1
Using singularity subtraction.  Convolution time:  74.39992809295654
Norm of psiNew =  1.00016701543
eigenvalueHistory:  -11.009708435839698
Orbital energy after Harrison update:  -11.0097084358
Orbital 1 error and eigenvalue residual:   -1.026e-01 and 5.335e-04
Orbital 1 wavefunction residual: 2.046e-03


Using singularity subtraction.  Convolution time:  74.37796092033386
Norm of psiNew =  0.99988984719
eigenvalueHistory:  [-11.00970844 -11.00973925]
Orbital energy after Harrison update:  -11.0097392511
Orbital 1 error and eigenvalue residual:   -1.026e-01 and 3.082e-05
Orbital 1 wavefunction residual: 7.293e-04


Turning on Anderson Mixing for wavefunction 1
Using singularity subtraction.  Convolution time:  74.3688132762909
Norm of psiNew =  1.0001338469
eigenvalueHistory:  [-11.00970844 -11.00973925 -11.00974362]
Orbital energy after Harrison update:  -11.0097436161
Anderson mixing on the orbital.
Input densities has shape  (786500, 1)

Anderson weights:  [] 1.0
Orbital 1 error and eigenvalue residual:   -1.026e-01 and 4.365e-06
Orbital 1 wavefunction residual: 3.465e-04


Using singularity subtraction.  Convolution time:  74.39096188545227
Norm of psiNew =  1.0000049938
eigenvalueHistory:  [-11.00970844 -11.00973925 -11.00974362 -11.00974404]
Orbital energy after Harrison update:  -11.00974404
Anderson mixing on the orbital.
Input densities has shape  (786500, 2)

Anderson weights:  [-0.16232189] 1.16232189104
Orbital 1 error and eigenvalue residual:   -1.026e-01 and 4.239e-07
Orbital 1 wavefunction residual: 1.706e-04


Using singularity subtraction.  Convolution time:  74.3666079044342
Norm of psiNew =  1.00000344823
eigenvalueHistory:  [-11.00970844 -11.00973925 -11.00974362 -11.00974404 -11.00974428]
Orbital energy after Harrison update:  -11.0097442793
Anderson mixing on the orbital.
Input densities has shape  (786500, 3)

Anderson weights:  [  5.28094222e-04  -1.80864503e+00] 2.80811693176
Orbital 1 error and eigenvalue residual:   -1.026e-01 and 2.393e-07
Orbital 1 wavefunction residual: 1.102e-04


Using singularity subtraction.  Convolution time:  74.37601208686829
Norm of psiNew =  1.0000003382
eigenvalueHistory:  [-11.00970844 -11.00973925 -11.00974362 -11.00974404 -11.00974428
 -11.00974447]
Orbital energy after Harrison update:  -11.0097444651
Anderson mixing on the orbital.
Input densities has shape  (786500, 4)

Anderson weights:  [  3.31175250e-03   3.50192291e+00  -5.46539673e+00] 2.96016206042
Orbital 1 error and eigenvalue residual:   -1.026e-01 and 1.858e-07
Orbital 1 wavefunction residual: 8.102e-06


Used 6 iterations for orbital 1.



Working on orbital 2
Using singularity subtraction.  Convolution time:  74.38239645957947
Norm of psiNew =  1.01471636037
eigenvalueHistory:  -2.141807239464495
Orbital energy after Harrison update:  -2.14180723946
Orbital 2 error and eigenvalue residual:   -6.650e-02 and 6.382e-02
Orbital 2 wavefunction residual: 1.201e-01


Using singularity subtraction.  Convolution time:  74.405508518219
Norm of psiNew =  0.979938103504
eigenvalueHistory:  [-2.14180724 -2.10493952]
Orbital energy after Harrison update:  -2.1049395186
Orbital 2 error and eigenvalue residual:   -2.963e-02 and 3.687e-02
Orbital 2 wavefunction residual: 6.363e-02


Using singularity subtraction.  Convolution time:  74.37449836730957
Norm of psiNew =  1.02603203808
eigenvalueHistory:  [-2.14180724 -2.10493952 -2.12591066]
Orbital energy after Harrison update:  -2.12591065813
Orbital 2 error and eigenvalue residual:   -5.060e-02 and 2.097e-02
Orbital 2 wavefunction residual: 6.448e-02


Using singularity subtraction.  Convolution time:  74.37078642845154
Norm of psiNew =  0.976963306399
eigenvalueHistory:  [-2.14180724 -2.10493952 -2.12591066 -2.1399893 ]
Orbital energy after Harrison update:  -2.13998930452
Orbital 2 error and eigenvalue residual:   -6.468e-02 and 1.408e-02
Orbital 2 wavefunction residual: 6.190e-02


Using singularity subtraction.  Convolution time:  74.38641023635864
Norm of psiNew =  1.02452577156
eigenvalueHistory:  [-2.14180724 -2.10493952 -2.12591066 -2.1399893  -2.15038731]
Orbital energy after Harrison update:  -2.15038731287
Orbital 2 error and eigenvalue residual:   -7.508e-02 and 1.040e-02
Orbital 2 wavefunction residual: 5.743e-02


Using singularity subtraction.  Convolution time:  74.3962049484253
Norm of psiNew =  0.976101982266
eigenvalueHistory:  [-2.14180724 -2.10493952 -2.12591066 -2.1399893  -2.15038731 -2.15832735]
Orbital energy after Harrison update:  -2.15832735112
Orbital 2 error and eigenvalue residual:   -8.302e-02 and 7.940e-03
Orbital 2 wavefunction residual: 5.582e-02


