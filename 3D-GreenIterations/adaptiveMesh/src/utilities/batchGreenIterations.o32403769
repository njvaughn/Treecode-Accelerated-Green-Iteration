Running on
      1 nyx7506
Running from /home/njvaughn/Greens-Functions-Iterative-Methods/3D-GreenIterations/adaptiveMesh/src/utilities
gradientFree =  True
Mixing scheme =  Anderson
vtk directory =  /home/njvaughn/O_with_anderson/LW5_1500o5_plots_eigRes
======================================================================
======================================================================
====================================================================== 

Reading atomic coordinates from:  ../src/utilities/molecularConfigurations/oxygenAtom.csv
Setting nOrbitals to six for purposes of testing the adaptivity on the oxygen atom.
in testBatchGreen..., nOrbitals =  6
['../src/utilities/molecularConfigurations/oxygenAtom.csv', '/home/njvaughn/O_with_anderson/LW5o5_1000_6_orbitals.csv', 8.0, 6, -74.469337501098821, -7.219370082893998, -0.54455323568788838, -40.613397710076626, -0.5]
[-18.75890296  -0.87120699  -0.33829445  -0.33829445  -0.33829445   0.           0.
   0.           0.        ]
(9,)
Reading atomic coordinates from:  ../src/utilities/molecularConfigurations/oxygenAtom.csv
Using single atom data from:
/home/njvaughn/AtomicData/allElectron/z8/singleAtomData/
Gauge shift  -0.5
Nuclear energy:  0.0
Atom is contained in cell    which has no children.  Divide at atomic location.
There are now 8 leaf cells.
After aspect ratio divide there are 8 leaf cells.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~ Atoms ~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Z = 8 located at (x, y, z) = ( 0.000,  0.000,  0.000)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

On the tree, nOrbitals =  6
type:  <class 'int'>
max depth  20
Number of gridpoints:  484000
max density:  306.586216826
Integrated density before normalization:  8.00005789033
Integrated density after normalization:  8.0
Initializing density EXTERNALLY took 3.431 seconds.
Initializing orbitals for atom Z = 8 located at (x, y, z) = ( 0.000,  0.000,  0.000)
Orbital index = 0
Orbital 0 filled with (n,ell,m) = (1,0,0) 
Orbital 1 filled with (n,ell,m) = (2,0,0) 
Orbital 2 filled with (n,ell,m) = (2,1,-1) 
Orbital 3 filled with (n,ell,m) = (2,1,0) 
Orbital 4 filled with (n,ell,m) = (2,1,1) 
Didn't fill all the orbitals.  Should you initialize more?  Randomly, or using more single atom data?
Filling extra orbitals with random initial data.
Initializing orbital  5  randomly...
Initializing orbitals randomly inside Tree Structure took 0.802 seconds.
Initializing orbitals EXTERNAL to Tree Structure took 20.617 seconds.
Tree build completed. 
Domain Size:                 [-20.0, 20.0] 
Divide Criterion:             LW5 
Divide Parameter:            1.00e+03 
Total Number of Cells:       4425 
Total Number of Leaf Cells:  3872 
Total Number of Gridpoints:  484000 
Minimum Depth                3 levels 
Maximum Depth:               12 levels 
Cell Order:                  5 
Construction time:           42.1 seconds.
Closest gridpoint to origin:  [-0.00023898185402757011, -0.00023898185402757011, -0.00023898185402757011]
For a distance of:  0.00041392871326276036
Part of a cell centered at:  [-0.0048828125, -0.0048828125, -0.0048828125]

Entering greenIterations_KohnSham_SCF()

Number of targets:    484000
Threads per block:    512
Blocks per grid:      946
[74.112730191157425, -7.219370082893998, -0.54455323568788838, -140.81814437367436, -74.469337501098821, -0.5]
Integrated density:  8.0
Using Gaussian singularity subtraction, alpha =  1
Computing Vcoulomb took:    34.1896 seconds. 
Update orbital energies after computing the initial Veff.  Save them as the reference values for each cell
Computing orbital kinetics using Gradients
Orbital Energy:            [-19.25979178  -1.37123541  -0.83829197  -0.83829197  -0.83829197
   1.75495036]
Sorted eigenvalues:  [-19.25979178  -1.37123541  -0.83829197  -0.83829197  -0.83829197
   1.75495036]
New order:  [0 1 3 4 2 5]
Orbital energies after initial sort: 
 [-19.25979178  -1.37123541  -0.83829197  -0.83829197  -0.83829197
   1.75495036]
Kinetic:    [ 28.75701121   3.19602104   2.55203853   2.55203853   2.55203853
   2.25779625]
Potential:  [-48.01680299  -4.56725646  -3.39033051  -3.39033051  -3.39033051
  -0.50284589]
Computing band energy.  Current orbital energies are:  [-19.25979178  -1.37123541  -0.83829197  -0.83829197  -0.83829197
   1.75495036]
Electrostatic Energies:
Hartree:          36.3250195668
External:         -177.146329145
Nuclear-Nuclear:  0.0
Updating total energy WITH explicit kinetic evaluation.
Orbital Energies:  [-19.25979178  -1.37123541  -0.83829197  -0.83829197  -0.83829197
   1.75495036]
Orbital Energy Errors after initialization:  [ -8.88825266e-04  -2.84245901e-05   2.47808291e-06   2.47808026e-06
   2.47807621e-06   2.25495036e+00]
Updated V_x:                           -9.6257967162 Hartree
Updated V_c:                           -0.6072438701 Hartree
Updated Band Energy:                   -41.2918062472 H, -1.1540453644e+02 H
Updated Kinetic Energy:                 73.4375243504 H, 8.0656894433e+01 H
Updated E_x:                           -7.2193475372 H, -6.6747943015e+00 H
Updated E_c:                           -0.5445524598 H, 1.4027359191e+02 H
Updated totalElectrostatic:            -140.8213095781 H, -6.6351972077e+01 H
Total Energy:                          -75.1476852246 H, -7.4647685225e+01 H



SCF Count  1
Orbital Energies:  [-19.25979178  -1.37123541  -0.83829197  -0.83829197  -0.83829197  -1.5       ]
Working on orbital 0
Using singularity subtraction
Norm of psiNew =  0.999997957085
eigenvalueHistory:  -19.26107792102537
Orbital energy after Harrison update:  -19.261077921
Orbital 0 error and eigenvalue residual:   -2.175e-03 and 1.286e-03
Orbital 0 wavefunction residual: 9.350e-05


Turning on Anderson Mixing for wavefunction 0
Using singularity subtraction
Norm of psiNew =  0.999976761307
eigenvalueHistory:  [-19.26107792 -19.26107934]
Orbital energy after Harrison update:  -19.2610793422
Anderson mixing on the orbital.
Input densities has shape  (484000, 1)

Anderson weights:  [] 1.0
Orbital 0 error and eigenvalue residual:   -2.176e-03 and 1.421e-06
Orbital 0 wavefunction residual: 2.819e-05


Using singularity subtraction
Norm of psiNew =  0.999983361188
eigenvalueHistory:  [-19.26107792 -19.26107934 -19.26107937]
Orbital energy after Harrison update:  -19.2610793721
Anderson mixing on the orbital.
Input densities has shape  (484000, 2)

Anderson weights:  [-2.49165063] 3.49165062651
Orbital 0 error and eigenvalue residual:   -2.176e-03 and 2.992e-08
Orbital 0 wavefunction residual: 2.016e-05


Using singularity subtraction
Norm of psiNew =  0.999999947226
eigenvalueHistory:  [-19.26107792 -19.26107934 -19.26107937 -19.2610794 ]
Orbital energy after Harrison update:  -19.2610794018
Anderson mixing on the orbital.
Input densities has shape  (484000, 3)

Anderson weights:  [ 3.17602281 -4.45103915] 2.27501634545
Orbital 0 error and eigenvalue residual:   -2.176e-03 and 2.973e-08
Orbital 0 wavefunction residual: 1.004e-06


Using singularity subtraction
Norm of psiNew =  0.999999993748
eigenvalueHistory:  [-19.26107792 -19.26107934 -19.26107937 -19.2610794  -19.2610794 ]
Orbital energy after Harrison update:  -19.2610794021
Anderson mixing on the orbital.
Input densities has shape  (484000, 4)

Anderson weights:  [-3.39683859  4.75551885 -2.42702369] 2.06834342815
Orbital 0 error and eigenvalue residual:   -2.176e-03 and 2.289e-10
Orbital 0 wavefunction residual: 9.675e-08


Used 5 iterations for orbital 0.



Working on orbital 1
Using singularity subtraction
Norm of psiNew =  0.999988650394
eigenvalueHistory:  -1.3713381444587123
Orbital energy after Harrison update:  -1.37133814446
Orbital 1 error and eigenvalue residual:   -1.312e-04 and 1.027e-04
Orbital 1 wavefunction residual: 7.650e-05


Turning on Anderson Mixing for wavefunction 1
Using singularity subtraction
Norm of psiNew =  0.999989171196
eigenvalueHistory:  [-1.37133814 -1.37133822]
Orbital energy after Harrison update:  -1.37133821778
Anderson mixing on the orbital.
Input densities has shape  (484000, 1)

Anderson weights:  [] 1.0
Orbital 1 error and eigenvalue residual:   -1.312e-04 and 7.332e-08
Orbital 1 wavefunction residual: 4.111e-05


Using singularity subtraction
Norm of psiNew =  0.999993840098
eigenvalueHistory:  [-1.37133814 -1.37133822 -1.37133822]
Orbital energy after Harrison update:  -1.37133822211
Anderson mixing on the orbital.
Input densities has shape  (484000, 2)

Anderson weights:  [-2.8760315] 3.87603150214
Orbital 1 error and eigenvalue residual:   -1.312e-04 and 4.330e-09
Orbital 1 wavefunction residual: 3.065e-05


Using singularity subtraction
Norm of psiNew =  1.00000754855
eigenvalueHistory:  [-1.37133814 -1.37133822 -1.37133822 -1.37133822]
Orbital energy after Harrison update:  -1.37133822381
Anderson mixing on the orbital.
Input densities has shape  (484000, 3)

Anderson weights:  [ 5.87637226 -7.91423776] 3.0378654992
Orbital 1 error and eigenvalue residual:   -1.312e-04 and 1.706e-09
Orbital 1 wavefunction residual: 3.025e-06


Using singularity subtraction
Norm of psiNew =  1.00000783146
eigenvalueHistory:  [-1.37133814 -1.37133822 -1.37133822 -1.37133822 -1.37133822]
Orbital energy after Harrison update:  -1.37133822443
Anderson mixing on the orbital.
Input densities has shape  (484000, 4)

Anderson weights:  [ -7.57235115  10.19456008  -3.95658014] 2.33437121232
Orbital 1 error and eigenvalue residual:   -1.312e-04 and 6.204e-10
Orbital 1 wavefunction residual: 3.635e-07


Using singularity subtraction
