Running on
      1 nyx7506
Running from /home/njvaughn/Greens-Functions-Iterative-Methods/3D-GreenIterations/adaptiveMesh/src/utilities
gradientFree =  True
Mixing scheme =  Anderson
======================================================================
======================================================================
====================================================================== 

['../src/utilities/molecularConfigurations/carbonMonoxide.csv', '/home/njvaughn/CO_with_anderson/LW5_500_andersonMixing_p5_1em76.csv', 14, 10, -112.471443237994, -11.997011069615391, -0.94214407530225852, -62.898682441673358, -0.5]
Reading atomic coordinates from:  ../src/utilities/molecularConfigurations/carbonMonoxide.csv
Using single atom data from:
/home/njvaughn/AtomicData/allElectron/z6/singleAtomData/
Atom with Z=6 will get 5 atomic orbitals initialized.
Using single atom data from:
/home/njvaughn/AtomicData/allElectron/z8/singleAtomData/
Atom with Z=8 will get 5 atomic orbitals initialized.
Gauge shift  -0.5
Nuclear energy:  22.5180848369

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~ Atoms ~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Z = 6 located at (x, y, z) = ( 1.066,  0.000,  0.000)
Z = 8 located at (x, y, z) = (-1.066,  0.000,  0.000)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

max depth  20
Number of gridpoints:  379500
Initializing orbitals for atom Z = 6 located at (x, y, z) = ( 1.066,  0.000,  0.000)
Orbital index = 0
Orbital 0 filled with (n,ell,m) = (1,0,0) 
Orbital 1 filled with (n,ell,m) = (2,0,0) 
Orbital 2 filled with (n,ell,m) = (2,1,-1) 
Orbital 3 filled with (n,ell,m) = (2,1,0) 
Orbital 4 filled with (n,ell,m) = (2,1,1) 
Initializing orbitals for atom Z = 8 located at (x, y, z) = (-1.066,  0.000,  0.000)
Orbital index = 5
Orbital 5 filled with (n,ell,m) = (1,0,0) 
Orbital 6 filled with (n,ell,m) = (2,0,0) 
Orbital 7 filled with (n,ell,m) = (2,1,-1) 
Orbital 8 filled with (n,ell,m) = (2,1,0) 
Orbital 9 filled with (n,ell,m) = (2,1,1) 
Tree build completed. 
Domain Size:                 [-20.0, 20.0] 
Divide Criterion:             LW5 
Divide Parameter:            5.00e+02 
Total Number of Cells:       3521 
Total Number of Leaf Cells:  3036 
Total Number of Gridpoints:  379500 
Minimum Depth                3 levels 
Maximum Depth:               12 levels 
Cell Order:                  5 
Construction time:           184 seconds.
Closest gridpoint to origin:  [-0.0065205567959327748, -0.0076474193288822434, -0.0076474193288822434]
For a distance of:  0.012628685826819376
Part of a cell centered at:  [-0.13322624999999999, -0.15625, -0.15625]

Orbital  0  moments:
x1 =  -1.21969855554
y1 =  1.41694615297e-16
z1 =  4.35395436002e-16
x2 =  -1.4700672485
y2 =  -0.170100520525
z2 =  -0.170100520525 


Orbital  1  moments:
x1 =  -13.7571554875
y1 =  4.35460248047e-14
z1 =  -3.49431516166e-14
x2 =  -56.1624074994
y2 =  -41.4903354097
z2 =  -41.4903354097 


Orbital  2  moments:
x1 =  -39.310997987
y1 =  -1.19948755789e-13
z1 =  5.01174622636e-14
x2 =  -83.5249050329
y2 =  -0.0265930979017
z2 =  -0.026593097901 


Orbital  3  moments:
x1 =  3.95919191529e-14
y1 =  2.1473315205e-14
z1 =  -39.2859197147
x2 =  2.44700093521e-14
y2 =  -2.07777263277e-13
z2 =  -9.71648434454e-14 


Orbital  4  moments:
x1 =  -1.94961234656e-15
y1 =  -39.2859197147
z1 =  2.11081288082e-14
x2 =  4.72729494438e-14
y2 =  3.92985774131e-13
z2 =  -2.63494711076e-13 


Orbital  5  moments:
x1 =  0.765387386341
y1 =  -1.64504192188e-16
z1 =  1.27068244906e-15
x2 =  -0.872562177642
y2 =  -0.0568046270465
z2 =  -0.0568046270465 


Orbital  6  moments:
x1 =  -8.62415643162
y1 =  -1.44971156541e-14
z1 =  -5.2217512483e-14
x2 =  23.5357760231
y2 =  14.3440394455
z2 =  14.3440394455 


Orbital  7  moments:
x1 =  -18.0623590869
y1 =  8.35327488499e-14
z1 =  6.29600681672e-14
x2 =  38.5027993163
y2 =  0.000194177457367
z2 =  0.000194177457356 


Orbital  8  moments:
x1 =  8.66027011528e-14
y1 =  -5.30531245767e-14
z1 =  -18.0623120466
x2 =  -6.73665958644e-14
y2 =  -7.27408353012e-14
z2 =  2.68845457882e-14 


Orbital  9  moments:
x1 =  -6.1492023105e-14
y1 =  -18.0623120466
z1 =  -5.3089593256e-14
x2 =  2.02444994389e-13
y2 =  1.8746375708e-13
z2 =  1.29811239801e-13 

Assuming this is the carbon monoxide test case...

Entering greenIterations_KohnSham_SCF()

Number of targets:    379500
Threads per block:    512
Blocks per grid:      742
[-62.898682441673358, 111.85061770418731, -11.997011069615391, -0.94214407530225852, -211.38290579726365, -112.471443237994]
Using Gaussian singularity subtraction, alpha =  1
Computing Vcoulomb took:    21.1326 seconds. 
Update orbital energies after computing the initial Veff.  Save them as the reference values for each cell
Computing orbital kinetics using Gradients
Need to re-order orbitals.
Sorted eigenvalues:  [-19.36877284 -10.4968054   -1.57445899  -1.22270554  -1.2157037
  -1.15220701  -0.95673233  -0.95673233  -0.77251627  -0.77251627]
New order:  [5 0 6 7 1 2 8 9 3 4]
Computing orbital kinetics using Gradients
Orbital Energy:            [-19.36877284 -10.4968054   -1.57445899  -1.22270554  -1.2157037
  -1.15220701  -0.95673233  -0.95673233  -0.77251627  -0.77251627]
Sorted eigenvalues:  [-19.36877284 -10.4968054   -1.57445899  -1.22270554  -1.2157037
  -1.15220701  -0.95673233  -0.95673233  -0.77251627  -0.77251627]
New order:  [0 1 2 3 4 5 6 7 8 9]
../src/dataStructures/TreeStruct_CC.py:145: RuntimeWarning: overflow encountered in exp
  temp = 1/(1+np.exp( exponentialArg ) )
Fermi energy:  -0.9567323284380187
../src/dataStructures/TreeStruct_CC.py:162: RuntimeWarning: overflow encountered in exp
  self.occupations = 2*1/(1+np.exp( exponentialArg ) )  # these are # of electrons, not fractional occupancy.  Hence the 2*
Occupations:  [ 2.  2.  2.  2.  2.  2.  1.  1.  0.  0.]
Fermi energy:  -0.9567323284380187
Occupations:  [ 2.  2.  2.  2.  2.  2.  1.  1.  0.  0.]
Kinetic Errors:    [  1.61323111e-03  -1.30415890e+01  -2.55601343e+01  -2.62041562e+01
  -2.71094854e+01  -2.75230520e+01  -2.62041797e+01  -2.62041797e+01
  -2.75230448e+01  -2.75230448e+01]
Potential Errors:  [ -0.11159979  21.80356992  43.24446157  44.24023698  45.15256802
  45.62963125  44.50623365  44.50623365  46.00931485  46.00931485]
Computing band energy.  Current orbital energies are:  [-19.36877284 -10.4968054   -1.57445899  -1.22270554  -1.2157037
  -1.15220701  -0.95673233  -0.95673233  -0.77251627  -0.77251627]
Electrostatic Energies:
Hartree:          74.9482453127
External:         -308.664291601
Nuclear-Nuclear:  22.5180848369
Updating total energy WITH explicit kinetic evaluation.
Orbital Energies:  [-19.36877284 -10.4968054   -1.57445899  -1.22270554  -1.2157037
  -1.15220701  -0.95673233  -0.95673233  -0.77251627  -0.77251627]
Traceback (most recent call last):
  File "testBatchGreenIterations_KS.py", line 219, in <module>
    testGreenIterationsGPU(tree,vtkExport=False,onTheFlyRefinement=False)
  File "testBatchGreenIterations_KS.py", line 120, in testGreenIterationsGPU
    onTheFlyRefinement=onTheFlyRefinement, vtkExport=vtkExport, maxOrbitals=maxOrbitals, maxSCFIterations=maxSCFIterations)
  File "../src/utilities/greenIterations.py", line 228, in greenIterations_KohnSham_SCF
    print('Orbital Energy Errors after initialization: ', tree.orbitalEnergies-dftfeOrbitalEnergies-tree.gaugeShift)
ValueError: operands could not be broadcast together with shapes (10,) (9,) 
gradientFree =  True
Mixing scheme =  Anderson
======================================================================
======================================================================
====================================================================== 

['../src/utilities/molecularConfigurations/carbonMonoxide.csv', '/home/njvaughn/CO_with_anderson/LW5_1500_andersonMixing_p5_1em76.csv', 14, 10, -112.471443237994, -11.997011069615391, -0.94214407530225852, -62.898682441673358, -0.5]
Reading atomic coordinates from:  ../src/utilities/molecularConfigurations/carbonMonoxide.csv
Using single atom data from:
/home/njvaughn/AtomicData/allElectron/z6/singleAtomData/
Atom with Z=6 will get 5 atomic orbitals initialized.
Using single atom data from:
/home/njvaughn/AtomicData/allElectron/z8/singleAtomData/
Atom with Z=8 will get 5 atomic orbitals initialized.
Gauge shift  -0.5
Nuclear energy:  22.5180848369

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~ Atoms ~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Z = 6 located at (x, y, z) = ( 1.066,  0.000,  0.000)
Z = 8 located at (x, y, z) = (-1.066,  0.000,  0.000)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

max depth  20
Number of gridpoints:  1034000
Initializing orbitals for atom Z = 6 located at (x, y, z) = ( 1.066,  0.000,  0.000)
Orbital index = 0
Orbital 0 filled with (n,ell,m) = (1,0,0) 
Orbital 1 filled with (n,ell,m) = (2,0,0) 
Orbital 2 filled with (n,ell,m) = (2,1,-1) 
Orbital 3 filled with (n,ell,m) = (2,1,0) 
Orbital 4 filled with (n,ell,m) = (2,1,1) 
Initializing orbitals for atom Z = 8 located at (x, y, z) = (-1.066,  0.000,  0.000)
Orbital index = 5
Orbital 5 filled with (n,ell,m) = (1,0,0) 
Orbital 6 filled with (n,ell,m) = (2,0,0) 
Orbital 7 filled with (n,ell,m) = (2,1,-1) 
Orbital 8 filled with (n,ell,m) = (2,1,0) 
Orbital 9 filled with (n,ell,m) = (2,1,1) 
Tree build completed. 
Domain Size:                 [-20.0, 20.0] 
Divide Criterion:             LW5 
Divide Parameter:            1.50e+03 
Total Number of Cells:       9505 
Total Number of Leaf Cells:  8272 
Total Number of Gridpoints:  1034000 
Minimum Depth                3 levels 
Maximum Depth:               14 levels 
Cell Order:                  5 
Construction time:           511 seconds.
Closest gridpoint to origin:  [-0.0065205567959327748, -0.0076474193288822434, -0.0076474193288822434]
For a distance of:  0.012628685826819376
Part of a cell centered at:  [-0.13322624999999999, -0.15625, -0.15625]

Orbital  0  moments:
x1 =  -1.2197003118
y1 =  3.26405781058e-15
z1 =  -2.00700807007e-15
x2 =  -1.47006935866
y2 =  -0.170100608206
z2 =  -0.170100608206 


Orbital  1  moments:
x1 =  -13.7574165051
y1 =  -3.02881973517e-14
z1 =  3.76266129799e-14
x2 =  -56.1622730952
y2 =  -41.482609184
z2 =  -41.482609184 


Orbital  2  moments:
x1 =  -39.3091890604
y1 =  -1.88705388121e-14
z1 =  -2.05549010972e-14
x2 =  -83.7232291125
y2 =  0.00557808331518
z2 =  0.00557808331452 


Orbital  3  moments:
x1 =  8.35299711344e-14
y1 =  1.79495930923e-13
z1 =  -39.2643732115
x2 =  1.17435575153e-13
y2 =  1.56273052224e-13
z2 =  -6.35493637964e-13 


Orbital  4  moments:
x1 =  8.22748986995e-14
y1 =  -39.2643732115
z1 =  1.78391603247e-13
x2 =  -2.79229764311e-13
y2 =  1.82035376356e-13
z2 =  3.75329460437e-13 


Orbital  5  moments:
x1 =  0.765389828626
y1 =  -2.15201096982e-15
z1 =  6.10627779063e-17
x2 =  -0.87256495227
y2 =  -0.0568050186115
z2 =  -0.0568050186115 


Orbital  6  moments:
x1 =  -8.62414663312
y1 =  -3.2729803839e-14
z1 =  -8.52388150703e-14
x2 =  23.5357046573
y2 =  14.3440043241
z2 =  14.3440043241 


Orbital  7  moments:
x1 =  -18.0621564822
y1 =  8.31204617468e-14
z1 =  8.73925653054e-14
x2 =  38.5013710343
y2 =  -3.7300391805e-05
z2 =  -3.73003916798e-05 


Orbital  8  moments:
x1 =  -5.044008723e-14
y1 =  3.0311349821e-14
z1 =  -18.062182281
x2 =  -1.71223608583e-13
y2 =  -3.55333053319e-14
z2 =  -1.89587977659e-14 


Orbital  9  moments:
x1 =  -1.43616762863e-13
y1 =  -18.062182281
z1 =  3.10958655114e-14
x2 =  8.85540697295e-13
y2 =  -1.08342643521e-12
z2 =  -2.16861513772e-13 

Assuming this is the carbon monoxide test case...

Entering greenIterations_KohnSham_SCF()

Number of targets:    1034000
Threads per block:    512
Blocks per grid:      2020
[-62.898682441673358, 111.85061770418731, -11.997011069615391, -0.94214407530225852, -211.38290579726365, -112.471443237994]
Using Gaussian singularity subtraction, alpha =  1
Computing Vcoulomb took:    154.2184 seconds. 
Update orbital energies after computing the initial Veff.  Save them as the reference values for each cell
Computing orbital kinetics using Gradients
