Running on
      1 nyx7512
Running from /home/njvaughn/Greens-Functions-Iterative-Methods/3D-GreenIterations/adaptiveMesh/src/utilities
gradientFree =  False
Mixing scheme =  Anderson
======================================================================
======================================================================
====================================================================== 

Hard coding nOrbitals to 7
['../src/utilities/molecularConfigurations/carbonMonoxide.csv', '/home/njvaughn/GImixingO/LW5_500_1em6_gradient_largeDomain.csv', 14, 7, -112.471443237994, -11.997011069615391, -0.94214407530225852, -62.898682441673358, -0.5]
Reading atomic coordinates from:  ../src/utilities/molecularConfigurations/carbonMonoxide.csv
Using single atom data from:
/home/njvaughn/AtomicData/allElectron/z8/singleAtomData/
Atom with Z=8 will get 5 atomic orbitals initialized.
Using single atom data from:
/home/njvaughn/AtomicData/allElectron/z6/singleAtomData/
Atom with Z=6 will get 5 atomic orbitals initialized.
Gauge shift  -0.5
Nuclear energy:  22.5180848369

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~ Atoms ~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Z = 8 located at (x, y, z) = ( 1.066,  0.000,  0.000)
Z = 6 located at (x, y, z) = (-1.066,  0.000,  0.000)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

max depth  20
Number of gridpoints:  194304
max density:  302.638355155
Initializing density EXTERNALLY took 0.655 seconds.
Setting second atom nOrbitals to 2 for carbon monoxide.  Also setting tree.nOrbitals to 7
Initializing orbitals for atom Z = 8 located at (x, y, z) = ( 1.066,  0.000,  0.000)
Orbital index = 0
Orbital 0 filled with (n,ell,m) = (1,0,0) 
Orbital 1 filled with (n,ell,m) = (2,0,0) 
Orbital 2 filled with (n,ell,m) = (2,1,-1) 
Orbital 3 filled with (n,ell,m) = (2,1,0) 
Orbital 4 filled with (n,ell,m) = (2,1,1) 
Initializing orbitals for atom Z = 6 located at (x, y, z) = (-1.066,  0.000,  0.000)
Orbital index = 5
Orbital 5 filled with (n,ell,m) = (1,0,0) 
Orbital 6 filled with (n,ell,m) = (2,0,0) 
Initializing orbitals EXTERNAL to Tree Structure took 4.923 seconds.
Tree build completed. 
Domain Size:                 [-20.0, 20.0] 
Divide Criterion:             LW5 
Divide Parameter:            5.00e+02 
Total Number of Cells:       3521 
Total Number of Leaf Cells:  3036 
Total Number of Gridpoints:  194304 
Minimum Depth                3 levels 
Maximum Depth:               12 levels 
Cell Order:                  4 
Construction time:           15.7 seconds.
Closest gridpoint to origin:  [-0.01014124443176817, -0.01189382304511144, -0.01189382304511144]
For a distance of:  0.019641051190853222
Part of a cell centered at:  [-0.13322624999999999, -0.15625, -0.15625]
Assuming this is the carbon monoxide test case...

Entering greenIterations_KohnSham_SCF()

Number of targets:    194304
Threads per block:    512
Blocks per grid:      380
[-62.898682441673358, 111.85061770418731, -11.997011069615391, -0.94214407530225852, -211.38290579726365, -112.471443237994]
Using Gaussian singularity subtraction, alpha =  1
Computing Vcoulomb took:    0.9260 seconds. 
Update orbital energies after computing the initial Veff.  Save them as the reference values for each cell
Computing orbital kinetics using Gradients
Orbital Energy:            [-19.37156715  -1.57349278  -1.22128167  -0.95512872  -0.95512872
 -10.49522667  -1.2150229 ]
Sorted eigenvalues:  [-19.37156715 -10.49522667  -1.57349278  -1.2150229   -1.22128167
  -0.95512872  -0.95512872]
New order:  [0, 5, 1, 6, 2, 3, 4]
Orbital energies after initial sort: 
 [-19.37156715 -10.49522667  -1.57349278  -1.2150229   -1.22128167
  -0.95512872  -0.95512872]
Kinetic Errors:    [  1.06776373e-02  -2.55585920e+01  -2.62030891e+01  -2.62030361e+01
  -2.62030361e+01  -1.30354852e+01  -2.71088248e+01]
Potential Errors:  [ -0.12345851  43.24388553  44.24059367  44.50669365  44.50669365
  21.79904481  45.15258819]
Computing band energy.  Current orbital energies are:  [-19.37156715 -10.49522667  -1.57349278  -1.2150229   -1.22128167
  -0.95512872  -0.95512872]
Electrostatic Energies:
Hartree:          74.958132904
External:         -308.731928056
Nuclear-Nuclear:  22.5180848369
Updating total energy WITH explicit kinetic evaluation.
Orbital Energies:  [-19.37156715 -10.49522667  -1.57349278  -1.2150229   -1.22128167
  -0.95512872  -0.95512872]
Orbital Energy Errors after initialization:  [-0.15241754 -0.08812811  0.00181431 -0.19348806 -0.27572706 -0.00957439
 -0.11998655]
Updated V_x:                           -15.8249062010 Hartree
Updated V_c:                           -1.0434925270 Hartree
Updated Band Energy:                   -64.5736972202 H, -1.6750147785e+00 H
Updated Kinetic Energy:                 111.1103637563 H, -7.4025394786e-01 H
Updated E_x:                           -11.8686796507 H, 1.2833141889e-01 H
Updated E_c:                           -0.9347318525 H, 7.4122227922e-03 H
Updated totalElectrostatic:            -211.2557103156 H, 1.2719548165e-01 H
Total Energy:                          -112.9487580625 H, -4.7731482453e-01 H
Computing L2 residual for initialized orbitals...
Energy Eigenvalue:  -19.3715671526
L2 norm of wavefunction residual (H*psi-lambda*psi):    26.9679712633
Energy Eigenvalue:  -10.4952266701
L2 norm of wavefunction residual (H*psi-lambda*psi):    12.9724281248
Energy Eigenvalue:  -1.57349278307
L2 norm of wavefunction residual (H*psi-lambda*psi):    6.37623780331
Energy Eigenvalue:  -1.21502289949
L2 norm of wavefunction residual (H*psi-lambda*psi):    3.15718546298
Energy Eigenvalue:  -1.22128166774
L2 norm of wavefunction residual (H*psi-lambda*psi):    1.20061366297
Energy Eigenvalue:  -0.955128718557
L2 norm of wavefunction residual (H*psi-lambda*psi):    0.346580561629
Energy Eigenvalue:  -0.955128718557
L2 norm of wavefunction residual (H*psi-lambda*psi):    0.346580561629



SCF Count  1
Orbital Energies:  [-19.37156715 -10.49522667  -1.57349278  -1.2150229   -1.22128167
  -0.95512872  -0.95512872]
Working on orbital 0
Using singularity skipping
Computing orbital kinetics using Gradients
Orbital Energy:            [-19.37156715  -1.57349278  -1.22128167  -0.95512872  -0.95512872
 -10.49522667  -1.2150229 ]
Orbital 0 error and residual:   -1.524e-01 and 1.000e+00


Using singularity skipping
Computing orbital kinetics using Gradients
Orbital Energy:            [  1.26540504e-38  -1.57349278e+00  -1.22128167e+00  -9.55128719e-01
  -9.55128719e-01  -1.04952267e+01  -1.21502290e+00]
Orbital 0 error and residual:   1.922e+01 and 1.081e-19


Used 2 iterations for orbital 0.
Working on orbital 1
Using singularity skipping
Computing orbital kinetics using Gradients
Orbital Energy:            [  1.26540504e-38  -1.04952267e+01  -1.22128167e+00  -9.55128719e-01
  -9.55128719e-01  -1.04952267e+01  -1.21502290e+00]
Orbital 1 error and residual:   -8.813e-02 and 1.414e+00


Using singularity skipping
Computing orbital kinetics using Gradients
Orbital Energy:            [  1.26540504e-38   4.11053404e-01  -1.22128167e+00  -9.55128719e-01
  -9.55128719e-01  -1.04952267e+01  -1.21502290e+00]
Orbital 1 error and residual:   1.082e+01 and 4.859e-01


Wanrning: Orbital energy greater than gauge shift.
Updating with gradient calculation to get back on track.
Computing orbital kinetics using Gradients
Orbital Energy:            [  1.26540504e-38   1.36557374e+00  -1.22128167e+00  -9.55128719e-01
  -9.55128719e-01  -1.04952267e+01  -1.21502290e+00]
../src/utilities/greenIterations.py:469: RuntimeWarning: invalid value encountered in sqrt
  k = np.sqrt(-2*tree.orbitalEnergies[m])
Using singularity skipping
Computing orbital kinetics using Gradients
Orbital Energy:            [  1.26540504e-38   1.36557374e+00  -1.22128167e+00  -9.55128719e-01
  -9.55128719e-01  -1.04952267e+01  -1.21502290e+00]
Orbital 1 error and residual:   1.177e+01 and 0.000e+00


Used 3 iterations for orbital 1.
Working on orbital 2
Using singularity skipping
Computing orbital kinetics using Gradients
Orbital Energy:            [  1.26540504e-38   1.36557374e+00  -1.57349278e+00  -9.55128719e-01
  -9.55128719e-01  -1.04952267e+01  -1.21502290e+00]
Orbital 2 error and residual:   1.814e-03 and 0.000e+00


Used 1 iterations for orbital 2.
Working on orbital 3
Using singularity skipping
Computing orbital kinetics using Gradients
Orbital Energy:            [  1.26540504e-38   1.36557374e+00  -1.57349278e+00  -1.21502290e+00
  -9.55128719e-01  -1.04952267e+01  -1.21502290e+00]
Orbital 3 error and residual:   -1.935e-01 and 0.000e+00


Used 1 iterations for orbital 3.
Working on orbital 4
Using singularity skipping
Computing orbital kinetics using Gradients
Orbital Energy:            [  1.26540504e-38   1.36557374e+00  -1.57349278e+00  -1.21502290e+00
  -1.22128167e+00  -1.04952267e+01  -1.21502290e+00]
Orbital 4 error and residual:   -2.757e-01 and 0.000e+00


Used 1 iterations for orbital 4.
Working on orbital 5
Using singularity skipping
Computing orbital kinetics using Gradients
Orbital Energy:            [  1.26540504e-38   1.36557374e+00  -1.57349278e+00  -1.21502290e+00
  -1.22128167e+00  -9.55128719e-01  -1.21502290e+00]
Orbital 5 error and residual:   -9.574e-03 and 0.000e+00


Used 1 iterations for orbital 5.
Working on orbital 6
Using singularity skipping
Computing orbital kinetics using Gradients
Orbital Energy:            [  1.26540504e-38   1.36557374e+00  -1.57349278e+00  -1.21502290e+00
  -1.22128167e+00  -9.55128719e-01  -9.55128719e-01]
Orbital 6 error and residual:   -1.200e-01 and 0.000e+00


Used 1 iterations for orbital 6.
Sorted eigenvalues:  [ -1.57349278e+00  -1.22128167e+00  -1.21502290e+00  -9.55128719e-01
  -9.55128719e-01   1.26540504e-38   1.36557374e+00]
New order:  [2 4 3 5 6 0 1]
../src/dataStructures/TreeStruct_CC.py:146: RuntimeWarning: overflow encountered in exp
  temp = 1/(1+np.exp( exponentialArg ) )
Traceback (most recent call last):
  File "testBatchGreenIterations_KS.py", line 219, in <module>
    testGreenIterationsGPU(tree,vtkExport=False,onTheFlyRefinement=False)
  File "testBatchGreenIterations_KS.py", line 120, in testGreenIterationsGPU
    onTheFlyRefinement=onTheFlyRefinement, vtkExport=vtkExport, maxOrbitals=maxOrbitals, maxSCFIterations=maxSCFIterations)
  File "../src/utilities/greenIterations.py", line 724, in greenIterations_KohnSham_SCF
    tree.computeOccupations()
  File "../src/dataStructures/TreeStruct_CC.py", line 159, in computeOccupations
    eF = brentq(self.fermiObjectiveFunction, self.orbitalEnergies[0], 1, xtol=1e-14)
  File "/sw/lsa/centos7/python-anaconda3/created-20170424/lib/python3.5/site-packages/scipy/optimize/zeros.py", line 442, in brentq
    r = _zeros._brentq(f,a,b,xtol,rtol,maxiter,args,full_output,disp)
ValueError: f(a) and f(b) must have different signs
