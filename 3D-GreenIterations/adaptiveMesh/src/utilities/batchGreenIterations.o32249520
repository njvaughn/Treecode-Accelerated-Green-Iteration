Running on
      1 nyx7506
Running from /home/njvaughn/Greens-Functions-Iterative-Methods/3D-GreenIterations/adaptiveMesh/src/utilities
gradientFree =  True
Mixing scheme =  Anderson
vtk directory =  /home/njvaughn/CO_with_anderson/LW5_1000o5_plots_gradient
======================================================================
======================================================================
====================================================================== 

Hard coding nOrbitals to 7
['../src/utilities/molecularConfigurations/carbonMonoxide.csv', '/home/njvaughn/CO_with_anderson/LW5_1000o5_gradient_looseInitially.csv', 14, 7, -112.471443237994, -11.997011069615391, -0.94214407530225852, -62.898682441673358, -0.5]
Reading atomic coordinates from:  ../src/utilities/molecularConfigurations/carbonMonoxide.csv
Using single atom data from:
/home/njvaughn/AtomicData/allElectron/z8/singleAtomData/
Atom with Z=8 will get 5 atomic orbitals initialized.
Using single atom data from:
/home/njvaughn/AtomicData/allElectron/z6/singleAtomData/
Atom with Z=6 will get 5 atomic orbitals initialized.
Gauge shift  -0.5
Nuclear energy:  22.5180848369

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~ Atoms ~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Z = 8 located at (x, y, z) = ( 1.066,  0.000,  0.000)
Z = 6 located at (x, y, z) = (-1.066,  0.000,  0.000)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

max depth  20
Number of gridpoints:  708500
max density:  306.704219679
Initializing density EXTERNALLY took 2.220 seconds.
Setting second atom nOrbitals to 2 for carbon monoxide.  Also setting tree.nOrbitals to 7
Initializing orbitals for atom Z = 8 located at (x, y, z) = ( 1.066,  0.000,  0.000)
Orbital index = 0
Orbital 0 filled with (n,ell,m) = (1,0,0) 
Orbital 1 filled with (n,ell,m) = (2,0,0) 
Orbital 2 filled with (n,ell,m) = (2,1,-1) 
Orbital 3 filled with (n,ell,m) = (2,1,0) 
Orbital 4 filled with (n,ell,m) = (2,1,1) 
Initializing orbitals for atom Z = 6 located at (x, y, z) = (-1.066,  0.000,  0.000)
Orbital index = 5
Orbital 5 filled with (n,ell,m) = (1,0,0) 
Orbital 6 filled with (n,ell,m) = (2,0,0) 
Initializing orbitals EXTERNAL to Tree Structure took 16.386 seconds.
Tree build completed. 
Domain Size:                 [-20.0, 20.0] 
Divide Criterion:             LW5 
Divide Parameter:            1.00e+03 
Total Number of Cells:       6529 
Total Number of Leaf Cells:  5668 
Total Number of Gridpoints:  708500 
Minimum Depth                3 levels 
Maximum Depth:               13 levels 
Cell Order:                  5 
Construction time:           50.7 seconds.
Closest gridpoint to origin:  [-0.0065205567959327748, -0.0076474193288822434, -0.0076474193288822434]
For a distance of:  0.012628685826819376
Part of a cell centered at:  [-0.13322624999999999, -0.15625, -0.15625]
Assuming this is the carbon monoxide test case...

Entering greenIterations_KohnSham_SCF()

Number of targets:    708500
Threads per block:    512
Blocks per grid:      1384
[-62.898682441673358, 111.85061770418731, -11.997011069615391, -0.94214407530225852, -211.38290579726365, -112.471443237994]
Using Gaussian singularity subtraction, alpha =  1
Computing Vcoulomb took:    73.3254 seconds. 
Update orbital energies after computing the initial Veff.  Save them as the reference values for each cell
Computing orbital kinetics using Gradients
Orbital Energy:            [-19.36504277  -1.57431647  -1.22279589  -0.95679593  -0.95679593
 -10.49594242  -1.21568216]
Sorted eigenvalues:  [-19.36504277 -10.49594242  -1.57431647  -1.21568216  -1.22279589
  -0.95679593  -0.95679593]
New order:  [0, 5, 1, 6, 2, 3, 4]
Orbital energies after initial sort: 
 [-19.36504277 -10.49594242  -1.57431647  -1.21568216  -1.22279589
  -0.95679593  -0.95679593]
Kinetic Errors:    [  7.44832160e-04  -2.55602289e+01  -2.62042126e+01  -2.62042099e+01
  -2.62042099e+01  -1.30421487e+01  -2.71095564e+01]
Potential Errors:  [ -0.10700132  43.24469875  44.24020296  44.50620023  44.50620023
  21.80499258  45.15266057]
Computing band energy.  Current orbital energies are:  [-19.36504277 -10.49594242  -1.57431647  -1.21568216  -1.22279589
  -0.95679593  -0.95679593]
Electrostatic Energies:
Hartree:          74.9475212918
External:         -308.649576819
Nuclear-Nuclear:  22.5180848369
Updating total energy WITH explicit kinetic evaluation.
Orbital Energies:  [-19.36504277 -10.49594242  -1.57431647  -1.21568216  -1.22279589
  -0.95679593  -0.95679593]
Orbital Energy Errors after initialization:  [-0.14589315 -0.08884386  0.00099063 -0.19414732 -0.27724128 -0.01124159
 -0.12165376]
Updated V_x:                           -15.8230138132 Hartree
Updated V_c:                           -1.0434269284 Hartree
Updated Band Energy:                   -64.5747431011 H, -1.6760606595e+00 H
Updated Kinetic Energy:                 111.0462318756 H, -8.0438582857e-01 H
Updated E_x:                           -11.8672603599 H, 1.2975070971e-01 H
Updated E_c:                           -0.9346719069 H, 7.4721684521e-03 H
Updated totalElectrostatic:            -211.1839706900 H, 1.9893510726e-01 H
Total Energy:                          -112.9396710811 H, -4.6822784315e-01 H
Computing L2 residual for initialized orbitals...
Energy Eigenvalue:  -19.365042768
L2 norm of wavefunction residual (H*psi-lambda*psi):    14.6763155548
Energy Eigenvalue:  -10.495942419
L2 norm of wavefunction residual (H*psi-lambda*psi):    6.98327045576
Energy Eigenvalue:  -1.57431646799
L2 norm of wavefunction residual (H*psi-lambda*psi):    3.50487945057
Energy Eigenvalue:  -1.21568215641
L2 norm of wavefunction residual (H*psi-lambda*psi):    1.93322671754
Energy Eigenvalue:  -1.22279588807
L2 norm of wavefunction residual (H*psi-lambda*psi):    1.17276766305
Energy Eigenvalue:  -0.95679592552
L2 norm of wavefunction residual (H*psi-lambda*psi):    0.195573086384
Energy Eigenvalue:  -0.95679592552
L2 norm of wavefunction residual (H*psi-lambda*psi):    0.195573086384



SCF Count  1
Orbital Energies:  [-19.36504277 -10.49594242  -1.57431647  -1.21568216  -1.22279589
  -0.95679593  -0.95679593]
setting loose tolerance for initial few SCFs
Working on orbital 0
Using singularity subtraction
Orthonormalizing phiNew.
Norm of psiNew =  1.00005846343
eigenvalueHistory:  -19.366306800033136
Orbital energy after Harrison update:  -19.3663068
Copying phiNew into Phi array after the energy update and normalization.
Orbital 0 error and residual:   -1.472e-01 and 9.723e-04


Used 1 iterations for orbital 0.
Working on orbital 1
Using singularity subtraction
Orthonormalizing phiNew.
Norm of psiNew =  1.0
eigenvalueHistory:  -10.490325943783002
Orbital energy after Harrison update:  -10.4903259438
Copying phiNew into Phi array after the energy update and normalization.
Orbital 1 error and residual:   -8.323e-02 and 2.140e-03


Used 1 iterations for orbital 1.
Working on orbital 2
Using singularity subtraction
Orthonormalizing phiNew.
Norm of psiNew =  1.0
eigenvalueHistory:  -1.4994447955654693
Orbital energy after Harrison update:  -1.49944479557
Copying phiNew into Phi array after the energy update and normalization.
Orbital 2 error and residual:   7.586e-02 and 1.388e-01


Using singularity subtraction
Orthonormalizing phiNew.
Norm of psiNew =  1.0
eigenvalueHistory:  [-1.4994448  -1.43033316]
Orbital energy after Harrison update:  -1.43033315754
Copying phiNew into Phi array after the energy update and normalization.
Orbital 2 error and residual:   1.450e-01 and 6.197e-02


Using singularity subtraction
Orthonormalizing phiNew.
Norm of psiNew =  1.0
eigenvalueHistory:  [-1.4994448  -1.43033316 -1.3635326 ]
Orbital energy after Harrison update:  -1.3635325968
Copying phiNew into Phi array after the energy update and normalization.
Orbital 2 error and residual:   2.118e-01 and 4.818e-02


Using singularity subtraction
Orthonormalizing phiNew.
Norm of psiNew =  1.0
eigenvalueHistory:  [-1.4994448  -1.43033316 -1.3635326  -1.30117473]
Orbital energy after Harrison update:  -1.30117473476
Copying phiNew into Phi array after the energy update and normalization.
Orbital 2 error and residual:   2.741e-01 and 3.924e-02


Used 4 iterations for orbital 2.
Working on orbital 3
Using singularity subtraction
Orthonormalizing phiNew.
Norm of psiNew =  1.0
eigenvalueHistory:  -0.6719449936946086
Orbital energy after Harrison update:  -0.671944993695
Copying phiNew into Phi array after the energy update and normalization.
Orbital 3 error and residual:   3.496e-01 and 6.251e-01


Using singularity subtraction
Orthonormalizing phiNew.
Norm of psiNew =  1.0
eigenvalueHistory:  [-0.67194499 -0.55740051]
Orbital energy after Harrison update:  -0.557400506458
Copying phiNew into Phi array after the energy update and normalization.
Orbital 3 error and residual:   4.641e-01 and 9.949e-02


Using singularity subtraction
Orthonormalizing phiNew.
Norm of psiNew =  1.0
eigenvalueHistory:  [-0.67194499 -0.55740051 -0.43519341]
Orbital energy after Harrison update:  -0.435193407836
Copying phiNew into Phi array after the energy update and normalization.
Orbital 3 error and residual:   5.863e-01 and 8.653e-02


Using singularity subtraction
Orthonormalizing phiNew.
Norm of psiNew =  1.0
eigenvalueHistory:  [-0.67194499 -0.55740051 -0.43519341 -0.29431575]
Orbital energy after Harrison update:  -0.294315751141
Copying phiNew into Phi array after the energy update and normalization.
Orbital 3 error and residual:   7.272e-01 and 9.510e-02


Using singularity subtraction
Orthonormalizing phiNew.
Norm of psiNew =  1.0
eigenvalueHistory:  [-0.67194499 -0.55740051 -0.43519341 -0.29431575 -0.11179504]
Orbital energy after Harrison update:  -0.111795037046
Copying phiNew into Phi array after the energy update and normalization.
Orbital 3 error and residual:   9.097e-01 and 1.349e-01


Using singularity subtraction
Orthonormalizing phiNew.
Norm of psiNew =  1.0
eigenvalueHistory:  [-0.67194499 -0.55740051 -0.43519341 -0.29431575 -0.11179504  0.19579067]
Orbital energy after Harrison update:  0.195790667181
setting eigenvalue to gauge shift minus 0.5 because it was positive
Copying phiNew into Phi array after the energy update and normalization.
Orbital 3 error and residual:   2.153e-02 and 2.950e-01


Using singularity subtraction
Orthonormalizing phiNew.
Norm of psiNew =  1.0
eigenvalueHistory:  [-0.67194499 -0.55740051 -0.43519341 -0.29431575 -0.11179504  0.19579067
 -1.18057418]
Orbital energy after Harrison update:  -1.18057417802
Copying phiNew into Phi array after the energy update and normalization.
Orbital 3 error and residual:   -1.590e-01 and 2.072e-01


Using singularity subtraction
Orthonormalizing phiNew.
Norm of psiNew =  1.0
eigenvalueHistory:  [-0.67194499 -0.55740051 -0.43519341 -0.29431575 -0.11179504  0.19579067
 -1.18057418 -1.40824866]
Orbital energy after Harrison update:  -1.40824866104
Copying phiNew into Phi array after the energy update and normalization.
Orbital 3 error and residual:   -3.867e-01 and 1.900e-01


Using singularity subtraction
Orthonormalizing phiNew.
Norm of psiNew =  1.0
eigenvalueHistory:  [-0.67194499 -0.55740051 -0.43519341 -0.29431575 -0.11179504  0.19579067
 -1.18057418 -1.40824866 -1.63729225]
Orbital energy after Harrison update:  -1.63729224999
Copying phiNew into Phi array after the energy update and normalization.
Orbital 3 error and residual:   -6.158e-01 and 1.604e-01


Using singularity subtraction
Orthonormalizing phiNew.
Norm of psiNew =  1.0
eigenvalueHistory:  [-0.67194499 -0.55740051 -0.43519341 -0.29431575 -0.11179504  0.19579067
 -1.18057418 -1.40824866 -1.63729225 -1.85162173]
Orbital energy after Harrison update:  -1.85162173017
Copying phiNew into Phi array after the energy update and normalization.
Orbital 3 error and residual:   -8.301e-01 and 1.304e-01


Using singularity subtraction
Orthonormalizing phiNew.
Norm of psiNew =  1.0
eigenvalueHistory:  [-0.67194499 -0.55740051 -0.43519341 -0.29431575 -0.11179504  0.19579067
 -1.18057418 -1.40824866 -1.63729225 -1.85162173 -2.0501107 ]
Orbital energy after Harrison update:  -2.05011070135
Copying phiNew into Phi array after the energy update and normalization.
Orbital 3 error and residual:   -1.029e+00 and 1.112e-01


Using singularity subtraction
