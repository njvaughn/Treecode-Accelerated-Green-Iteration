Running on
      1 nyx7506
Running from /home/njvaughn/Greens-Functions-Iterative-Methods/3D-GreenIterations/adaptiveMesh/src/utilities
gradientFree =  True
Mixing scheme =  Anderson
vtk directory =  /home/njvaughn/CO_with_anderson/LW5_1000o5_plots_gradient
======================================================================
======================================================================
====================================================================== 

Hard coding nOrbitals to 7
['../src/utilities/molecularConfigurations/carbonMonoxide.csv', '/home/njvaughn/CO_with_anderson/LW5_1000o5_gradient_looseInitially.csv', 14, 7, -112.471443237994, -11.997011069615391, -0.94214407530225852, -62.898682441673358, -0.5]
Reading atomic coordinates from:  ../src/utilities/molecularConfigurations/carbonMonoxide.csv
Using single atom data from:
/home/njvaughn/AtomicData/allElectron/z8/singleAtomData/
Atom with Z=8 will get 5 atomic orbitals initialized.
Using single atom data from:
/home/njvaughn/AtomicData/allElectron/z6/singleAtomData/
Atom with Z=6 will get 5 atomic orbitals initialized.
Gauge shift  -0.5
Nuclear energy:  22.5180848369

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~ Atoms ~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Z = 8 located at (x, y, z) = ( 1.066,  0.000,  0.000)
Z = 6 located at (x, y, z) = (-1.066,  0.000,  0.000)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

max depth  20
Number of gridpoints:  379500
max density:  304.767624612
Initializing density EXTERNALLY took 1.145 seconds.
Setting second atom nOrbitals to 2 for carbon monoxide.  Also setting tree.nOrbitals to 7
Initializing orbitals for atom Z = 8 located at (x, y, z) = ( 1.066,  0.000,  0.000)
Orbital index = 0
Orbital 0 filled with (n,ell,m) = (1,0,0) 
Orbital 1 filled with (n,ell,m) = (2,0,0) 
Orbital 2 filled with (n,ell,m) = (2,1,-1) 
Orbital 3 filled with (n,ell,m) = (2,1,0) 
Orbital 4 filled with (n,ell,m) = (2,1,1) 
Initializing orbitals for atom Z = 6 located at (x, y, z) = (-1.066,  0.000,  0.000)
Orbital index = 5
Orbital 5 filled with (n,ell,m) = (1,0,0) 
Orbital 6 filled with (n,ell,m) = (2,0,0) 
Initializing orbitals EXTERNAL to Tree Structure took 9.025 seconds.
Tree build completed. 
Domain Size:                 [-20.0, 20.0] 
Divide Criterion:             LW5 
Divide Parameter:            5.00e+02 
Total Number of Cells:       3521 
Total Number of Leaf Cells:  3036 
Total Number of Gridpoints:  379500 
Minimum Depth                3 levels 
Maximum Depth:               12 levels 
Cell Order:                  5 
Construction time:           27.2 seconds.
Closest gridpoint to origin:  [-0.0065205567959327748, -0.0076474193288822434, -0.0076474193288822434]
For a distance of:  0.012628685826819376
Part of a cell centered at:  [-0.13322624999999999, -0.15625, -0.15625]
Assuming this is the carbon monoxide test case...

Entering greenIterations_KohnSham_SCF()

Number of targets:    379500
Threads per block:    512
Blocks per grid:      742
[-62.898682441673358, 111.85061770418731, -11.997011069615391, -0.94214407530225852, -211.38290579726365, -112.471443237994]
Using Gaussian singularity subtraction, alpha =  1
Computing Vcoulomb took:    21.2584 seconds. 
Update orbital energies after computing the initial Veff.  Save them as the reference values for each cell
Computing orbital kinetics using Gradients
Orbital Energy:            [-19.36877283  -1.57445898  -1.22270553  -0.95673232  -0.95673232
 -10.49680538  -1.21569148]
Sorted eigenvalues:  [-19.36877283 -10.49680538  -1.57445898  -1.21569148  -1.22270553
  -0.95673232  -0.95673232]
New order:  [0, 5, 1, 6, 2, 3, 4]
Orbital energies after initial sort: 
 [-19.36877283 -10.49680538  -1.57445898  -1.21569148  -1.22270553
  -0.95673232  -0.95673232]
Kinetic Errors:    [  1.61323110e-03  -2.55601343e+01  -2.62041562e+01  -2.62041797e+01
  -2.62041797e+01  -1.30415890e+01  -2.71095169e+01]
Potential Errors:  [ -0.11159978  43.24446158  44.24023698  44.50623365  44.50623365
  21.80356993  45.15261175]
Computing band energy.  Current orbital energies are:  [-19.36877283 -10.49680538  -1.57445898  -1.21569148  -1.22270553
  -0.95673232  -0.95673232]
Electrostatic Energies:
Hartree:          74.9482454931
External:         -308.664291781
Nuclear-Nuclear:  22.5180848369
Updating total energy WITH explicit kinetic evaluation.
Orbital Energies:  [-19.36877283 -10.49680538  -1.57445898  -1.21569148  -1.22270553
  -0.95673232  -0.95673232]
Orbital Energy Errors after initialization:  [-0.14962321 -0.08970682  0.00084812 -0.19415664 -0.27715092 -0.01117799
 -0.12159015]
Updated V_x:                           -15.8231707082 Hartree
Updated V_c:                           -1.0434329492 Hartree
Updated Band Energy:                   -64.5837976574 H, -1.6851152157e+00 H
Updated Kinetic Energy:                 111.0506067947 H, -8.0001090945e-01 H
Updated E_x:                           -11.8673780311 H, 1.2963303848e-01 H
Updated E_c:                           -0.9346774583 H, 7.4666170404e-03 H
Updated totalElectrostatic:            -211.1979614510 H, 1.8494434628e-01 H
Total Energy:                          -112.9494101457 H, -4.7796690766e-01 H
Computing L2 residual for initialized orbitals...
Energy Eigenvalue:  -19.368772832
L2 norm of wavefunction residual (H*psi-lambda*psi):    20.7302714844
Energy Eigenvalue:  -10.4968053831
L2 norm of wavefunction residual (H*psi-lambda*psi):    9.95943073512
Energy Eigenvalue:  -1.57445897662
L2 norm of wavefunction residual (H*psi-lambda*psi):    4.91242888584
Energy Eigenvalue:  -1.21569147655
L2 norm of wavefunction residual (H*psi-lambda*psi):    2.52166021254
Energy Eigenvalue:  -1.22270552739
L2 norm of wavefunction residual (H*psi-lambda*psi):    1.1748997065
Energy Eigenvalue:  -0.956732316527
L2 norm of wavefunction residual (H*psi-lambda*psi):    0.201545734944
Energy Eigenvalue:  -0.956732316527
L2 norm of wavefunction residual (H*psi-lambda*psi):    0.201545734944



SCF Count  1
Orbital Energies:  [-19.36877283 -10.49680538  -1.57445898  -1.21569148  -1.22270553
  -0.95673232  -0.95673232]
setting loose tolerance for initial few SCFs
Working on orbital 0
Using singularity subtraction
Orthonormalizing phiNew.
Norm of psiNew =  1.0000172794
eigenvalueHistory:  -19.371585097970673
Orbital energy after Harrison update:  -19.371585098
Copying phiNew into Phi array after the energy update and normalization.
Orbital 0 error and residual:   -1.524e-01 and 9.855e-04


Used 1 iterations for orbital 0.
Working on orbital 1
Using singularity subtraction
Orthonormalizing phiNew.
Norm of psiNew =  1.0
eigenvalueHistory:  -10.492274276560332
Orbital energy after Harrison update:  -10.4922742766
Copying phiNew into Phi array after the energy update and normalization.
Orbital 1 error and residual:   -8.518e-02 and 2.137e-03


Used 1 iterations for orbital 1.
Working on orbital 2
Using singularity subtraction
Orthonormalizing phiNew.
Norm of psiNew =  1.0
eigenvalueHistory:  -1.4994301990744727
Orbital energy after Harrison update:  -1.49943019907
Copying phiNew into Phi array after the energy update and normalization.
Orbital 2 error and residual:   7.588e-02 and 1.388e-01


Using singularity subtraction
Orthonormalizing phiNew.
Norm of psiNew =  1.0
eigenvalueHistory:  [-1.4994302  -1.43051504]
Orbital energy after Harrison update:  -1.43051504133
Copying phiNew into Phi array after the energy update and normalization.
Orbital 2 error and residual:   1.448e-01 and 6.197e-02


Using singularity subtraction
Orthonormalizing phiNew.
Norm of psiNew =  1.0
eigenvalueHistory:  [-1.4994302  -1.43051504 -1.36385829]
Orbital energy after Harrison update:  -1.36385828884
Copying phiNew into Phi array after the energy update and normalization.
Orbital 2 error and residual:   2.114e-01 and 4.816e-02


Using singularity subtraction
Orthonormalizing phiNew.
Norm of psiNew =  1.0
eigenvalueHistory:  [-1.4994302  -1.43051504 -1.36385829 -1.30160616]
Orbital energy after Harrison update:  -1.30160616379
Copying phiNew into Phi array after the energy update and normalization.
Orbital 2 error and residual:   2.737e-01 and 3.922e-02


Used 4 iterations for orbital 2.
Working on orbital 3
Using singularity subtraction
Orthonormalizing phiNew.
Norm of psiNew =  1.0
eigenvalueHistory:  -0.6718893213131962
Orbital energy after Harrison update:  -0.671889321313
Copying phiNew into Phi array after the energy update and normalization.
Orbital 3 error and residual:   3.496e-01 and 6.251e-01


Using singularity subtraction
Orthonormalizing phiNew.
Norm of psiNew =  1.0
eigenvalueHistory:  [-0.67188932 -0.55740755]
Orbital energy after Harrison update:  -0.55740754589
Copying phiNew into Phi array after the energy update and normalization.
Orbital 3 error and residual:   4.641e-01 and 9.950e-02


Using singularity subtraction
Orthonormalizing phiNew.
Norm of psiNew =  1.0
eigenvalueHistory:  [-0.67188932 -0.55740755 -0.43523844]
Orbital energy after Harrison update:  -0.435238435422
Copying phiNew into Phi array after the energy update and normalization.
Orbital 3 error and residual:   5.863e-01 and 8.652e-02


Using singularity subtraction
Orthonormalizing phiNew.
Norm of psiNew =  1.0
eigenvalueHistory:  [-0.67188932 -0.55740755 -0.43523844 -0.29439832]
Orbital energy after Harrison update:  -0.294398323785
Copying phiNew into Phi array after the energy update and normalization.
Orbital 3 error and residual:   7.271e-01 and 9.508e-02


Using singularity subtraction
Orthonormalizing phiNew.
Norm of psiNew =  1.0
eigenvalueHistory:  [-0.67188932 -0.55740755 -0.43523844 -0.29439832 -0.1119412 ]
Orbital energy after Harrison update:  -0.111941204072
Copying phiNew into Phi array after the energy update and normalization.
Orbital 3 error and residual:   9.096e-01 and 1.348e-01


Using singularity subtraction
Orthonormalizing phiNew.
Norm of psiNew =  1.0
eigenvalueHistory:  [-0.67188932 -0.55740755 -0.43523844 -0.29439832 -0.1119412   0.1950645 ]
Orbital energy after Harrison update:  0.195064500921
setting eigenvalue to gauge shift minus 0.5 because it was positive
Copying phiNew into Phi array after the energy update and normalization.
Orbital 3 error and residual:   2.153e-02 and 2.948e-01


Using singularity subtraction
Orthonormalizing phiNew.
Norm of psiNew =  1.0
eigenvalueHistory:  [-0.67188932 -0.55740755 -0.43523844 -0.29439832 -0.1119412   0.1950645
 -1.18207643]
Orbital energy after Harrison update:  -1.18207642516
Copying phiNew into Phi array after the energy update and normalization.
Orbital 3 error and residual:   -1.605e-01 and 2.071e-01


Using singularity subtraction
Orthonormalizing phiNew.
Norm of psiNew =  1.0
eigenvalueHistory:  [-0.67188932 -0.55740755 -0.43523844 -0.29439832 -0.1119412   0.1950645
 -1.18207643 -1.40998364]
Orbital energy after Harrison update:  -1.40998363943
Copying phiNew into Phi array after the energy update and normalization.
Orbital 3 error and residual:   -3.884e-01 and 1.901e-01


Using singularity subtraction
Orthonormalizing phiNew.
Norm of psiNew =  1.0
eigenvalueHistory:  [-0.67188932 -0.55740755 -0.43523844 -0.29439832 -0.1119412   0.1950645
 -1.18207643 -1.40998364 -1.63929622]
Orbital energy after Harrison update:  -1.63929622162
Copying phiNew into Phi array after the energy update and normalization.
Orbital 3 error and residual:   -6.178e-01 and 1.605e-01


Using singularity subtraction
Orthonormalizing phiNew.
Norm of psiNew =  1.0
eigenvalueHistory:  [-0.67188932 -0.55740755 -0.43523844 -0.29439832 -0.1119412   0.1950645
 -1.18207643 -1.40998364 -1.63929622 -1.85387631]
Orbital energy after Harrison update:  -1.85387631448
Copying phiNew into Phi array after the energy update and normalization.
Orbital 3 error and residual:   -8.323e-01 and 1.305e-01


Using singularity subtraction
Orthonormalizing phiNew.
Norm of psiNew =  1.0
eigenvalueHistory:  [-0.67188932 -0.55740755 -0.43523844 -0.29439832 -0.1119412   0.1950645
 -1.18207643 -1.40998364 -1.63929622 -1.85387631 -2.05260625]
Orbital energy after Harrison update:  -2.05260625329
Copying phiNew into Phi array after the energy update and normalization.
Orbital 3 error and residual:   -1.031e+00 and 1.113e-01


Using singularity subtraction
Orthonormalizing phiNew.
Norm of psiNew =  1.0
eigenvalueHistory:  [-0.67188932 -0.55740755 -0.43523844 -0.29439832 -0.1119412   0.1950645
 -1.18207643 -1.40998364 -1.63929622 -1.85387631 -2.05260625 -2.24065257]
Orbital energy after Harrison update:  -2.24065257483
Copying phiNew into Phi array after the energy update and normalization.
Orbital 3 error and residual:   -1.219e+00 and 1.058e-01


Using singularity subtraction
Orthonormalizing phiNew.
Norm of psiNew =  1.0
eigenvalueHistory:  [-0.67188932 -0.55740755 -0.43523844 -0.29439832 -0.1119412   0.1950645
 -1.18207643 -1.40998364 -1.63929622 -1.85387631 -2.05260625 -2.24065257
 -2.42486131]
Orbital energy after Harrison update:  -2.42486130546
Copying phiNew into Phi array after the energy update and normalization.
Orbital 3 error and residual:   -1.403e+00 and 1.109e-01


Using singularity subtraction
Orthonormalizing phiNew.
Norm of psiNew =  1.0
eigenvalueHistory:  [-0.67188932 -0.55740755 -0.43523844 -0.29439832 -0.1119412   0.1950645
 -1.18207643 -1.40998364 -1.63929622 -1.85387631 -2.05260625 -2.24065257
 -2.42486131 -2.61191834]
Orbital energy after Harrison update:  -2.61191833716
Copying phiNew into Phi array after the energy update and normalization.
Orbital 3 error and residual:   -1.590e+00 and 1.212e-01


Using singularity subtraction
Orthonormalizing phiNew.
Norm of psiNew =  1.0
eigenvalueHistory:  [-0.67188932 -0.55740755 -0.43523844 -0.29439832 -0.1119412   0.1950645
 -1.18207643 -1.40998364 -1.63929622 -1.85387631 -2.05260625 -2.24065257
 -2.42486131 -2.61191834 -2.80662582]
Orbital energy after Harrison update:  -2.80662581716
Copying phiNew into Phi array after the energy update and normalization.
Orbital 3 error and residual:   -1.785e+00 and 1.311e-01


Using singularity subtraction
Orthonormalizing phiNew.
