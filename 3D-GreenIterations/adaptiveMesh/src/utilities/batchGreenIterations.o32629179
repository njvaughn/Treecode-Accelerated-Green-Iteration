Running on
      1 nyx7506
Running from /home/njvaughn/Greens-Functions-Iterative-Methods/3D-GreenIterations/adaptiveMesh/src/utilities
os.uname()[1] =  nyx7506.arc-ts.umich.edu
Unable to import directSumWrappers due to OSError
Unable to import treecodeWrapper due to OSError
gradientFree =  True
Mixing scheme =  Anderson
vtk directory =  /home/njvaughn/O_with_anderson/LW5_1500o5_plots_eigRes
======================================================================
======================================================================
====================================================================== 

Reading atomic coordinates from:  ../src/utilities/molecularConfigurations/berylliumAtom.csv
in testBatchGreen..., nOrbitals =  2
['../src/utilities/molecularConfigurations/berylliumAtom.csv', '/home/njvaughn/LWvsBiros/Beryllium/Biros_o8_5em3_max13.csv', 4.0, 2, -14.446201118081863, -2.2903921833555341, -0.22343205529440757, -8.1232305760491457, -0.5]
[-3.85561542 -0.20599987 -0.07579017]
(3,)
Reading atomic coordinates from:  ../src/utilities/molecularConfigurations/berylliumAtom.csv
Using single atom data from:
/home/njvaughn/AtomicData/allElectron/z4/singleAtomData/
Gauge shift  -0.5
Nuclear energy:  0.0
Atom is contained in cell    which has no children.  Divide at atomic location.
There are now 8 leaf cells.
After aspect ratio divide there are 8 leaf cells.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~ Atoms ~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Z = 4 located at (x, y, z) = ( 0.000,  0.000,  0.000)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

On the tree, nOrbitals =  2
type:  <class 'int'>
max depth  12
Number of gridpoints:  329280
max density:  34.7349394545
Integrated density before normalization:  4.00004857387
Integrated density after normalization:  4.0
Initializing density EXTERNALLY took 2.260 seconds.
Initializing orbitals for atom Z = 4 located at (x, y, z) = ( 0.000,  0.000,  0.000)
Orbital index = 0
Orbital 0 filled with (n,ell,m) = (1,0,0) 
Orbital 1 filled with (n,ell,m) = (2,0,0) 
Initializing orbitals EXTERNAL to Tree Structure took 2.205 seconds.
Tree build completed. 
Domain Size:                 [-20.0, 20.0] 
Divide Criterion:             Biros 
Divide Parameter:            2.00e-04 
Total Number of Cells:       1097 
Total Number of Leaf Cells:  960 
Total Number of Gridpoints:  329280 
Minimum Depth                3 levels 
Maximum Depth:               11 levels 
Cell Order:                  7 
Construction time:           29.1 seconds.
Closest gridpoint to origin:  [0.00024484460759937872, 0.00024484460759937872, 0.00024484460759937872]
For a distance of:  0.00042408330032138875
Part of a cell centered at:  [0.009765625, 0.009765625, 0.009765625]

Entering greenIterations_KohnSham_SCF()

Number of targets:    329280
Threads per block:    512
Blocks per grid:      644
[-8.1232305760491457, 14.309060170370618, -2.2903921833555341, -0.22343205529440757, -26.241437049802535, -14.446201118081863]
Integrated density:  4.0
Using Gaussian singularity subtraction, alpha =  1
GPUpresent set to  True
Type:  <class 'bool'>
Update orbital energies after computing the initial Veff.  Save them as the reference values for each cell
Computing orbital kinetics using Gradients
Orbital Energy:            [-4.35571888 -0.70601317]
Sorted eigenvalues:  [-4.35571888 -0.70601317]
New order:  [0 1]
Orbital energies after initial sort: 
 [-4.35571888 -0.70601317]
Kinetic:    [ 6.58706272  0.56743159]
Potential:  [-10.9427816   -1.27344477]
Computing band energy.  Current orbital energies are:  [-4.35571888 -0.70601317]
Electrostatic Energies:
Hartree:          7.11517332978
External:         -33.3567200758
Nuclear-Nuclear:  0.0
Updating total energy WITH explicit kinetic evaluation.
Orbital Energies:  [-4.35571888 -0.70601317]
Orbital Energy Errors after initialization:  [ -1.03461102e-04  -1.33039696e-05]
Updated V_x:                           -3.0538441878 Hartree
Updated V_c:                           -0.2522040963 Hartree
Updated Band Energy:                   -8.1234641062 H, -2.3353014809e-04 H
Updated Kinetic Energy:                 14.3089575942 H, -1.0257621062e-04 H
Updated E_x:                           -2.2903831408 H, 9.0425102619e-06 H
Updated E_c:                           -0.2234317252 H, 3.3007589537e-07 H
Updated totalElectrostatic:            -26.2415467460 H, -1.0969623842e-04 H
Total Energy:                          -14.4464040179 H, -2.0289986287e-04 H



SCF Count  1
Orbital Energies:  [-4.35571888 -0.70601317]
Working on orbital 0
Using singularity subtraction.  Convolution time:  13.339022874832153
Norm of psiNew =  0.999998820234
eigenvalueHistory: 
 -4.355787038636751
Orbital energy after Harrison update:  -4.35578703864
Orbital 0 error and eigenvalue residual:   -1.716e-04 and 6.816e-05
Orbital 0 wavefunction residual: 9.114e-05


Turning on Anderson Mixing for wavefunction 0
Using singularity subtraction.  Convolution time:  13.339020013809204
Norm of psiNew =  0.999994106916
eigenvalueHistory: 
 [-4.35578704 -4.35578709]
Orbital energy after Harrison update:  -4.35578709289
Anderson mixing on the orbital.
Input densities has shape  (329280, 1)

Anderson weights:  [] 1.0
Orbital 0 error and eigenvalue residual:   -1.717e-04 and 5.425e-08
Orbital 0 wavefunction residual: 7.666e-06


Using singularity subtraction.  Convolution time:  13.351126670837402
Norm of psiNew =  0.999995745032
eigenvalueHistory: 
 [-4.35578704 -4.35578709 -4.35578709]
Orbital energy after Harrison update:  -4.35578709333
Anderson mixing on the orbital.
Input densities has shape  (329280, 2)

Anderson weights:  [-2.25981315] 3.25981314966
Orbital 0 error and eigenvalue residual:   -1.717e-04 and 4.424e-10
Orbital 0 wavefunction residual: 5.413e-06


Using singularity subtraction.  Convolution time:  13.341065168380737
Norm of psiNew =  0.999999617849
eigenvalueHistory: 
 [-4.35578704 -4.35578709 -4.35578709 -4.35578709]
Orbital energy after Harrison update:  -4.35578709377
Anderson mixing on the orbital.
Input densities has shape  (329280, 3)

Anderson weights:  [ 2.92928317 -4.27289282] 2.34360964712
Orbital 0 error and eigenvalue residual:   -1.717e-04 and 4.381e-10
Orbital 0 wavefunction residual: 8.302e-07


Used 4 iterations for orbital 0.



Working on orbital 1
Using singularity subtraction.  Convolution time:  13.32498288154602
Norm of psiNew =  1.00004762128
eigenvalueHistory: 
 -0.706058840051165
Orbital energy after Harrison update:  -0.706058840051
Orbital 1 error and eigenvalue residual:   -5.897e-05 and 4.567e-05
Orbital 1 wavefunction residual: 5.578e-04


Turning on Anderson Mixing for wavefunction 1
Using singularity subtraction.  Convolution time:  13.323273658752441
Norm of psiNew =  1.00000011206
eigenvalueHistory: 
 [-0.70605884 -0.70605906]
Orbital energy after Harrison update:  -0.706059060381
Anderson mixing on the orbital.
Input densities has shape  (329280, 1)

Anderson weights:  [] 1.0
Orbital 1 error and eigenvalue residual:   -5.919e-05 and 2.203e-07
Orbital 1 wavefunction residual: 9.026e-05


Using singularity subtraction.  Convolution time:  13.335846185684204
Norm of psiNew =  0.999999728819
eigenvalueHistory: 
 [-0.70605884 -0.70605906 -0.70605906]
Orbital energy after Harrison update:  -0.706059064312
Anderson mixing on the orbital.
Input densities has shape  (329280, 2)

Anderson weights:  [-1.79041221] 2.79041220769
Orbital 1 error and eigenvalue residual:   -5.919e-05 and 3.931e-09
Orbital 1 wavefunction residual: 5.977e-05


Using singularity subtraction.  Convolution time:  13.330490589141846
Norm of psiNew =  0.99999944908
eigenvalueHistory: 
 [-0.70605884 -0.70605906 -0.70605906 -0.70605907]
Orbital energy after Harrison update:  -0.706059067434
Anderson mixing on the orbital.
Input densities has shape  (329280, 3)

Anderson weights:  [ 3.40555077 -5.37422514] 2.96867437269
Orbital 1 error and eigenvalue residual:   -5.920e-05 and 3.122e-09
Orbital 1 wavefunction residual: 1.371e-05


Using singularity subtraction.  Convolution time:  13.324429512023926
Norm of psiNew =  0.999999318012
eigenvalueHistory: 
 [-0.70605884 -0.70605906 -0.70605906 -0.70605907 -0.70605907]
Orbital energy after Harrison update:  -0.706059067632
Anderson mixing on the orbital.
Input densities has shape  (329280, 4)

Anderson weights:  [-4.70078118  7.42197597 -4.26052434] 2.53932955543
Orbital 1 error and eigenvalue residual:   -5.920e-05 and 1.980e-10
Orbital 1 wavefunction residual: 4.473e-06


Using singularity subtraction.  Convolution time:  13.33469843864441
Norm of psiNew =  0.999999262713
eigenvalueHistory: 
 [-0.70605884 -0.70605906 -0.70605906 -0.70605907 -0.70605907 -0.70605907]
Orbital energy after Harrison update:  -0.706059067652
Anderson mixing on the orbital.
Input densities has shape  (329280, 5)

Anderson weights:  [  8.79131429 -13.88094846   7.98540676  -5.05640565] 3.16063305497
Orbital 1 error and eigenvalue residual:   -5.920e-05 and 2.014e-11
Orbital 1 wavefunction residual: 1.954e-06


Using singularity subtraction.  Convolution time:  13.323762655258179
Norm of psiNew =  0.999999228608
eigenvalueHistory: 
 [-0.70605884 -0.70605906 -0.70605906 -0.70605907 -0.70605907 -0.70605907
 -0.70605907]
Orbital energy after Harrison update:  -0.706059067656
Anderson mixing on the orbital.
Input densities has shape  (329280, 6)

Anderson weights:  [-3.61322648  5.70521422 -3.28233283  2.11107188 -1.5328567 ] 1.61212992112
Orbital 1 error and eigenvalue residual:   -5.920e-05 and 3.807e-12
Orbital 1 wavefunction residual: 7.351e-07


Used 7 iterations for orbital 1.



Sorted eigenvalues:  [-4.35578709 -0.70605907]
New order:  [0 1]
../src/dataStructures/TreeStruct_CC.py:156: RuntimeWarning: overflow encountered in exp
  temp = 1/(1+np.exp( exponentialArg ) )
Fermi energy:  1.0
Occupations:  [ 2.  2.]


Integrated density:  4.00000000013
Density Residual  0.000258491012908
Density Residual from arrays  0.000258491012908
Shape of density histories:  (329280, 1) (329280, 1)
Using anderson mixing.
Input densities has shape  (329280, 1)

Anderson weights:  [] 1.0
Integrated anderson density:  4.00000000007
Computing band energy.  Current orbital energies are:  [-4.35578709 -0.70605907]
Electrostatic Energies:
Hartree:          7.11518353838
External:         -33.3570625069
Nuclear-Nuclear:  0.0
Updating total energy without explicit kinetic evaluation.
Band energies after Veff update: -8.123692 H, -4.62e-04 H
Orbital Energy Errors after Veff Update:  [ -1.71676248e-04  -5.91971467e-05]
Orbital 0 error: -1.717e-04
Orbital 1 error: -5.920e-05
Orbital Energies:  [-4.35578709 -0.70605907]
Updated V_x:                           -3.0538633574 Hartree
Updated V_c:                           -0.2522040391 Hartree
Updated Band Energy:                   -8.1236923228 H, -4.6174679403e-04 H
Updated Kinetic Energy:                 14.3090705039 H, 1.0333492483e-05 H
Updated E_x:                           -2.2903975181 H, -5.3347228852e-06 H
Updated E_c:                           -0.2234316771 H, 3.7818249080e-07 H
Updated totalElectrostatic:            -26.2418789686 H, -4.4191875210e-04 H
Total Energy:                          -14.4466376599 H, -4.3654180000e-04 H
Energy Residual:                        1.345e+01
Density Residual:                       2.585e-04





SCF Count  2
Orbital Energies:  [-4.35578709 -0.70605907]
Working on orbital 0
Using singularity subtraction.  Convolution time:  13.338633060455322
Norm of psiNew =  0.999999729491
eigenvalueHistory: 
 -4.355780929145647
Orbital energy after Harrison update:  -4.35578092915
Orbital 0 error and eigenvalue residual:   -1.655e-04 and 6.165e-06
Orbital 0 wavefunction residual: 5.227e-07


Turning on Anderson Mixing for wavefunction 0
Used 1 iterations for orbital 0.



Working on orbital 1
Using singularity subtraction.  Convolution time:  13.34542465209961
Norm of psiNew =  1.00000348344
eigenvalueHistory: 
 -0.7060625391736158
Orbital energy after Harrison update:  -0.706062539174
Orbital 1 error and eigenvalue residual:   -6.267e-05 and 3.472e-06
Orbital 1 wavefunction residual: 4.331e-06


Turning on Anderson Mixing for wavefunction 1
Using singularity subtraction.  Convolution time:  13.32683539390564
Norm of psiNew =  0.999999453486
eigenvalueHistory: 
 [-0.70606254 -0.70606254]
Orbital energy after Harrison update:  -0.706062539537
Anderson mixing on the orbital.
Input densities has shape  (329280, 1)

Anderson weights:  [] 1.0
Orbital 1 error and eigenvalue residual:   -6.267e-05 and 3.634e-10
Orbital 1 wavefunction residual: 1.861e-06


Using singularity subtraction.  Convolution time:  13.334659337997437
Norm of psiNew =  0.999999490728
eigenvalueHistory: 
 [-0.70606254 -0.70606254 -0.70606254]
Orbital energy after Harrison update:  -0.706062539539
Anderson mixing on the orbital.
Input densities has shape  (329280, 2)

Anderson weights:  [-2.86064549] 3.86064549351
Orbital 1 error and eigenvalue residual:   -6.267e-05 and 2.270e-12
Orbital 1 wavefunction residual: 1.454e-06


Using singularity subtraction.  Convolution time:  13.324136972427368
Norm of psiNew =  0.999999613905
eigenvalueHistory: 
 [-0.70606254 -0.70606254 -0.70606254 -0.70606254]
Orbital energy after Harrison update:  -0.706062539543
Anderson mixing on the orbital.
Input densities has shape  (329280, 3)

Anderson weights:  [  8.50377972 -11.65516554] 4.15138582433
Orbital 1 error and eigenvalue residual:   -6.267e-05 and 3.923e-12
Orbital 1 wavefunction residual: 5.481e-07


Used 4 iterations for orbital 1.



Sorted eigenvalues:  [-4.35578093 -0.70606254]
New order:  [0 1]
Fermi energy:  1.0
Occupations:  [ 2.  2.]


Integrated density:  4.0
Density Residual  0.000128849099696
Density Residual from arrays  0.000128849099696
Shape of density histories:  (329280, 2) (329280, 2)
Using anderson mixing.
Input densities has shape  (329280, 2)

Anderson weights:  [-0.99335886] 1.993358857
Integrated anderson density:  4.0
Computing band energy.  Current orbital energies are:  [-4.35578093 -0.70606254]
Electrostatic Energies:
Hartree:          7.11520018876
External:         -33.3574064263
Nuclear-Nuclear:  0.0
Updating total energy without explicit kinetic evaluation.
Band energies after Veff update: -8.123687 H, -4.56e-04 H
Orbital Energy Errors after Veff Update:  [ -1.65511628e-04  -6.26690343e-05]
Orbital 0 error: -1.655e-04
Orbital 1 error: -6.267e-05
Orbital Energies:  [-4.35578093 -0.70606254]
Updated V_x:                           -3.0538833888 Hartree
Updated V_c:                           -0.2522041398 Hartree
Updated Band Energy:                   -8.1236869374 H, -4.5636132859e-04 H
Updated Kinetic Energy:                 14.3094066399 H, 3.4646956337e-04 H
Updated E_x:                           -2.2904125416 H, -2.0358215841e-05 H
Updated E_c:                           -0.2234317737 H, 2.8162910706e-07 H
Updated totalElectrostatic:            -26.2422062375 H, -7.6918774104e-04 H
Total Energy:                          -14.4466439128 H, -4.4279476440e-04 H
Energy Residual:                        6.253e-06
Density Residual:                       1.288e-04





SCF Count  3
Orbital Energies:  [-4.35578093 -0.70606254]
Working on orbital 0
Using singularity subtraction.  Convolution time:  13.328102588653564
Norm of psiNew =  0.999999808087
eigenvalueHistory: 
 -4.3557727504344195
Orbital energy after Harrison update:  -4.35577275043
Orbital 0 error and eigenvalue residual:   -1.573e-04 and 8.179e-06
Orbital 0 wavefunction residual: 9.333e-07


Turning on Anderson Mixing for wavefunction 0
Used 1 iterations for orbital 0.



Working on orbital 1
Using singularity subtraction.  Convolution time:  13.339645624160767
Norm of psiNew =  1.00000274617
eigenvalueHistory: 
 -0.7060649056771495
Orbital energy after Harrison update:  -0.706064905677
Orbital 1 error and eigenvalue residual:   -6.504e-05 and 2.366e-06
Orbital 1 wavefunction residual: 4.493e-06


Turning on Anderson Mixing for wavefunction 1
Using singularity subtraction.  Convolution time:  13.336465120315552
Norm of psiNew =  0.999999752661
eigenvalueHistory: 
 [-0.70606491 -0.70606491]
Orbital energy after Harrison update:  -0.706064905927
Anderson mixing on the orbital.
Input densities has shape  (329280, 1)

Anderson weights:  [] 1.0
Orbital 1 error and eigenvalue residual:   -6.504e-05 and 2.496e-10
Orbital 1 wavefunction residual: 1.688e-06


Using singularity subtraction.  Convolution time:  13.325459241867065
Norm of psiNew =  0.999999770828
eigenvalueHistory: 
 [-0.70606491 -0.70606491 -0.70606491]
Orbital energy after Harrison update:  -0.706064905928
Anderson mixing on the orbital.
Input densities has shape  (329280, 2)

Anderson weights:  [-2.5913658] 3.59136580103
Orbital 1 error and eigenvalue residual:   -6.504e-05 and 1.563e-12
Orbital 1 wavefunction residual: 1.269e-06


Using singularity subtraction.  Convolution time:  13.327605485916138
Norm of psiNew =  0.999999828159
eigenvalueHistory: 
 [-0.70606491 -0.70606491 -0.70606491 -0.70606491]
Orbital energy after Harrison update:  -0.70606490593
Anderson mixing on the orbital.
Input densities has shape  (329280, 3)

Anderson weights:  [ 6.92522529 -9.7191733 ] 3.79394800601
Orbital 1 error and eigenvalue residual:   -6.504e-05 and 2.041e-12
Orbital 1 wavefunction residual: 4.043e-07


Used 4 iterations for orbital 1.



Sorted eigenvalues:  [-4.35577275 -0.70606491]
New order:  [0 1]
Fermi energy:  1.0
Occupations:  [ 2.  2.]


Integrated density:  4.0
Density Residual  3.66628994862e-06
Density Residual from arrays  3.66628994862e-06
Shape of density histories:  (329280, 3) (329280, 3)
Using anderson mixing.
Input densities has shape  (329280, 3)

Anderson weights:  [-0.60381467  1.2148925 ] 0.38892217329
Integrated anderson density:  4.0
Computing band energy.  Current orbital energies are:  [-4.35577275 -0.70606491]
Electrostatic Energies:
Hartree:          7.11520031882
External:         -33.3574029206
Nuclear-Nuclear:  0.0
Updating total energy without explicit kinetic evaluation.
Band energies after Veff update: -8.123675 H, -4.45e-04 H
Orbital Energy Errors after Veff Update:  [ -1.57332916e-04  -6.50354214e-05]
Orbital 0 error: -1.573e-04
Orbital 1 error: -6.504e-05
Orbital Energies:  [-4.35577275 -0.70606491]
Updated V_x:                           -3.0538831534 Hartree
Updated V_c:                           -0.2522041527 Hartree
Updated Band Energy:                   -8.1236753127 H, -4.4473668032e-04 H
Updated Kinetic Energy:                 14.3094142763 H, 3.5410589832e-04 H
Updated E_x:                           -2.2904123651 H, -2.0181700713e-05 H
Updated E_c:                           -0.2234317852 H, 2.7006629250e-07 H
Updated totalElectrostatic:            -26.2422026018 H, -7.6555194985e-04 H
Total Energy:                          -14.4466324758 H, -4.3135768594e-04 H
Energy Residual:                        1.144e-05
Density Residual:                       3.666e-06



Convergence to a tolerance of 0.000010 took 3 iterations
