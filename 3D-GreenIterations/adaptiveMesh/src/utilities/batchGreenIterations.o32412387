Running on
      1 nyx7509
Running from /home/njvaughn/Greens-Functions-Iterative-Methods/3D-GreenIterations/adaptiveMesh/src/utilities
gradientFree =  True
Mixing scheme =  Anderson
vtk directory =  /home/njvaughn/O_with_anderson/LW5_1500o5_plots_eigRes
======================================================================
======================================================================
====================================================================== 

Reading atomic coordinates from:  ../src/utilities/molecularConfigurations/carbonMonoxide.csv
Setting nOrbitals to seven for purposes of running Carbon monoxide.
in testBatchGreen..., nOrbitals =  7
['../src/utilities/molecularConfigurations/carbonMonoxide.csv', '/home/njvaughn/O_with_anderson/LW5o5_1500_6_orbitals.csv', 14.0, 7, -112.471443237994, -11.997011069615391, -0.94214407530225852, -62.898682441673358, -1.0]
[ -1.87191496e+01  -9.90709856e+00  -1.07530710e+00  -5.21534840e-01
  -4.45554611e-01  -4.45554331e-01  -3.35142164e-01  -8.27912477e-02
  -8.27912477e-02   1.29036768e-02]
(10,)
Reading atomic coordinates from:  ../src/utilities/molecularConfigurations/carbonMonoxide.csv
Using single atom data from:
/home/njvaughn/AtomicData/allElectron/z6/singleAtomData/
Using single atom data from:
/home/njvaughn/AtomicData/allElectron/z8/singleAtomData/
Gauge shift  -1.0
Nuclear energy:  22.5181832905
Atom is contained in cell    which has no children.  Divide at atomic location.
There are now 8 leaf cells.
Atom located inside child  111
Calling recursive divide for this child, but not others.
Atom is contained in cell  111  which has no children.  Divide at atomic location.
There are now 15 leaf cells.
After aspect ratio divide there are 825 leaf cells.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~ Atoms ~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Z = 6 located at (x, y, z) = ( 0.615,  0.615,  0.615)
Z = 8 located at (x, y, z) = (-0.615, -0.615, -0.615)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

On the tree, nOrbitals =  7
type:  <class 'int'>
max depth  20
Number of gridpoints:  786500
max density:  125.388686535
Integrated density before normalization:  6.0083931269
Integrated density after normalization:  6.0
max density:  306.671323615
Integrated density before normalization:  14.0000576751
Integrated density after normalization:  14.0
Initializing density EXTERNALLY took 9.443 seconds.
Initializing orbitals for atom Z = 6 located at (x, y, z) = ( 0.615,  0.615,  0.615)
Orbital index = 0
Orbital 0 filled with (n,ell,m) = (1,0,0) 
Orbital 1 filled with (n,ell,m) = (2,0,0) 
Initializing orbitals for atom Z = 8 located at (x, y, z) = (-0.615, -0.615, -0.615)
Orbital index = 2
Orbital 2 filled with (n,ell,m) = (1,0,0) 
Orbital 3 filled with (n,ell,m) = (2,0,0) 
Didn't fill all the orbitals.  Should you initialize more?  Randomly, or using more single atom data?
Filling extra orbitals with random initial data.
Initializing orbital  4  randomly...
Initializing orbitals randomly inside Tree Structure took 1.419 seconds.
Initializing orbital  5  randomly...
Initializing orbitals randomly inside Tree Structure took 1.518 seconds.
Initializing orbital  6  randomly...
Initializing orbitals randomly inside Tree Structure took 1.534 seconds.
Initializing orbitals EXTERNAL to Tree Structure took 75.530 seconds.
Tree build completed. 
Domain Size:                 [-20.0, 20.0] 
Divide Criterion:             LW5 
Divide Parameter:            1.00e+03 
Total Number of Cells:       7885 
Total Number of Leaf Cells:  6292 
Total Number of Gridpoints:  786500 
Minimum Depth                3 levels 
Maximum Depth:               12 levels 
Cell Order:                  5 
Construction time:           123 seconds.
Closest gridpoint to origin:  [-0.0075292575233478209, -0.0075292575233478209, -0.0075292575233478209]
For a distance of:  0.013041056573708638
Part of a cell centered at:  [-0.15383574999999999, -0.15383574999999999, -0.15383574999999999]

Entering greenIterations_KohnSham_SCF()

Number of targets:    786500
Threads per block:    512
Blocks per grid:      1537
[111.85061770418731, -11.997011069615391, -0.94214407530225852, -211.38290579726365, -112.471443237994, -1.0]
Integrated density:  14.0
Using Gaussian singularity subtraction, alpha =  1
Computing Vcoulomb took:    90.6476 seconds. 
Update orbital energies after computing the initial Veff.  Save them as the reference values for each cell
Computing orbital kinetics using Gradients
Orbital Energy:            [-11.00917496  -1.72094055 -19.86893231  -2.07798688   1.88344435
   9.37365378  10.03727652]
Sorted eigenvalues:  [-19.86893231 -11.00917496  -2.07798688  -1.72094055   1.88344435
   9.37365378  10.03727652]
New order:  [2 0 3 1 4 5 6]
Orbital energies after initial sort: 
 [-19.86893231 -11.00917496  -2.07798688  -1.72094055   1.88344435
   9.37365378  10.03727652]
Kinetic:    [ 15.71410223   1.64669004  28.75700974   3.19601829   2.88865659
  10.3778558   11.04132784]
Potential:  [-26.72327719  -3.36763058 -48.62594205  -5.27400518  -1.00521223
  -1.00420203  -1.00405132]
Computing band energy.  Current orbital energies are:  [-19.86893231 -11.00917496  -2.07798688  -1.72094055   1.88344435
   9.37365378  10.03727652]
Electrostatic Energies:
Hartree:          74.8683834662
External:         -308.495981402
Nuclear-Nuclear:  22.5181832905
Updating total energy WITH explicit kinetic evaluation.
Orbital Energies:  [-19.86893231 -11.00917496  -2.07798688  -1.72094055   1.88344435
   9.37365378  10.03727652]
Orbital Energy Errors after initialization:  [ -1.49782693e-01  -1.02076395e-01  -2.67978682e-03  -1.99405707e-01
   3.32899897e+00   1.08192081e+01   1.13724187e+01]
Updated V_x:                           -15.8117190048 Hartree
Updated V_c:                           -1.0427594488 Hartree
Updated Band Energy:                   -12.7653200870 H, -1.2461593779e+02 H
Updated Kinetic Energy:                 162.8483728358 H, 1.7484538391e+02 H
Updated E_x:                           -11.8587892536 H, -1.0916645178e+01 H
Updated E_c:                           -0.9340716599 H, 2.1044883414e+02 H
Updated totalElectrostatic:            -211.1094146448 H, -9.8637971407e+01 H
Total Energy:                          -61.0539027226 H, -6.0053902723e+01 H



SCF Count  1
Orbital Energies:  [-19.86893231 -11.00917496  -2.07798688  -1.72094055  -2.          -2.          -2.        ]
Working on orbital 0
Using singularity subtraction.  Convolution time:  74.94450259208679
Norm of psiNew =  1.00005664365
eigenvalueHistory:  -19.870242335862553
Orbital energy after Harrison update:  -19.8702423359
Orbital 0 error and eigenvalue residual:   -1.511e-01 and 1.310e-03
Orbital 0 wavefunction residual: 9.605e-04


Turning on Anderson Mixing for wavefunction 0
Using singularity subtraction.  Convolution time:  75.00271821022034
Norm of psiNew =  1.00000078116
eigenvalueHistory:  [-19.87024234 -19.87025752]
Orbital energy after Harrison update:  -19.8702575175
Anderson mixing on the orbital.
Input densities has shape  (786500, 1)

Anderson weights:  [] 1.0
Orbital 0 error and eigenvalue residual:   -1.511e-01 and 1.518e-05
Orbital 0 wavefunction residual: 3.158e-04


