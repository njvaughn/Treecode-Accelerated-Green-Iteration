Running on
      1 nyx7505
Running from /home/njvaughn/Greens-Functions-Iterative-Methods/3D-GreenIterations/adaptiveMesh/src/utilities
os.uname()[1] =  nyx7505.arc-ts.umich.edu
Unable to import directSumWrappers due to OSError
Unable to import treecodeWrapper due to OSError
gradientFree =  True
Mixing scheme =  Anderson
vtk directory =  /home/njvaughn/O_with_anderson/LW5_1500o5_plots_eigRes
======================================================================
======================================================================
====================================================================== 

Reading atomic coordinates from:  ../src/utilities/molecularConfigurations/berylliumAtom.csv
in testBatchGreen..., nOrbitals =  2
['../src/utilities/molecularConfigurations/berylliumAtom.csv', '/home/njvaughn/LWvsBiros/Beryllium/Biros_o8_5em3_max13.csv', 4.0, 2, -14.446201118081863, -2.2903921833555341, -0.22343205529440757, -8.1232305760491457, -0.5]
[-3.85561542 -0.20599987 -0.07579017]
(3,)
Reading atomic coordinates from:  ../src/utilities/molecularConfigurations/berylliumAtom.csv
Using single atom data from:
/home/njvaughn/AtomicData/allElectron/z4/singleAtomData/
Gauge shift  -0.5
Nuclear energy:  0.0
Atom is contained in cell    which has no children.  Divide at atomic location.
There are now 8 leaf cells.
After aspect ratio divide there are 8 leaf cells.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~ Atoms ~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Z = 4 located at (x, y, z) = ( 0.000,  0.000,  0.000)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

On the tree, nOrbitals =  2
type:  <class 'int'>
max depth  13
Number of gridpoints:  624000
max density:  31.3346218786
Integrated density before normalization:  4.00003428238
Integrated density after normalization:  4.0
Initializing density EXTERNALLY took 4.335 seconds.
Initializing orbitals for atom Z = 4 located at (x, y, z) = ( 0.000,  0.000,  0.000)
Orbital index = 0
Orbital 0 filled with (n,ell,m) = (1,0,0) 
Orbital 1 filled with (n,ell,m) = (2,0,0) 
Initializing orbitals EXTERNAL to Tree Structure took 3.945 seconds.
Tree build completed. 
Domain Size:                 [-20.0, 20.0] 
Divide Criterion:             Biros 
Divide Parameter:            5.00e-04 
Total Number of Cells:       713 
Total Number of Leaf Cells:  624 
Total Number of Gridpoints:  624000 
Minimum Depth                3 levels 
Maximum Depth:               5 levels 
Cell Order:                  10 
Construction time:           53.8 seconds.
Closest gridpoint to origin:  [-0.007694787128038838, -0.007694787128038838, -0.007694787128038838]
For a distance of:  0.013327762259190272
Part of a cell centered at:  [-0.625, -0.625, -0.625]

Entering greenIterations_KohnSham_SCF()

Number of targets:    624000
Threads per block:    512
Blocks per grid:      1219
[-8.1232305760491457, 14.309060170370618, -2.2903921833555341, -0.22343205529440757, -26.241437049802535, -14.446201118081863]
Integrated density:  4.0
Using Gaussian singularity subtraction, alpha =  1
GPUpresent set to  True
Type:  <class 'bool'>
Update orbital energies after computing the initial Veff.  Save them as the reference values for each cell
Computing orbital kinetics using Gradients
Orbital Energy:            [-4.44566222 -0.70978303]
Sorted eigenvalues:  [-4.44566222 -0.70978303]
New order:  [0 1]
Orbital energies after initial sort: 
 [-4.44566222 -0.70978303]
Kinetic:    [ 6.59800021  0.56790476]
Potential:  [-11.04366243  -1.27768779]
Computing band energy.  Current orbital energies are:  [-4.44566222 -0.70978303]
Electrostatic Energies:
Hartree:          7.11835278202
External:         -33.5736659668
Nuclear-Nuclear:  0.0
Updating total energy WITH explicit kinetic evaluation.
Orbital Energies:  [-4.44566222 -0.70978303]
Orbital Energy Errors after initialization:  [-0.0900468  -0.00378316]
Updated V_x:                           -3.0534371307 Hartree
Updated V_c:                           -0.2522013132 Hartree
Updated Band Energy:                   -8.3108904931 H, -1.8765991702e-01 H
Updated Kinetic Energy:                 14.3317083535 H, 2.2648183178e-02 H
Updated E_x:                           -2.2900778480 H, 3.1433535961e-04 H
Updated E_c:                           -0.2234272899 H, 4.7653821268e-06 H
Updated totalElectrostatic:            -26.4553131848 H, -2.1387613496e-01 H
Total Energy:                          -14.6371099691 H, -1.9090885104e-01 H



SCF Count  1
Orbital Energies:  [-4.44566222 -0.70978303]
Working on orbital 0
Using singularity subtraction.  Convolution time:  46.99696946144104
Norm of psiNew =  0.99395059711
eigenvalueHistory: 
 -4.55228048890778
Orbital energy after Harrison update:  -4.55228048891
Orbital 0 error and eigenvalue residual:   -1.967e-01 and 1.066e-01
Orbital 0 wavefunction residual: 1.129e-02


Using singularity subtraction.  Convolution time:  47.37346816062927
Norm of psiNew =  0.989059490107
eigenvalueHistory: 
 [-4.55228049 -4.57947081]
Orbital energy after Harrison update:  -4.5794708061
Orbital 0 error and eigenvalue residual:   -2.239e-01 and 2.719e-02
Orbital 0 wavefunction residual: 1.192e-02


Using singularity subtraction.  Convolution time:  47.3865487575531
Norm of psiNew =  0.992783441982
eigenvalueHistory: 
 [-4.55228049 -4.57947081 -4.58613807]
Orbital energy after Harrison update:  -4.58613807173
Orbital 0 error and eigenvalue residual:   -2.305e-01 and 6.667e-03
Orbital 0 wavefunction residual: 7.525e-03


Using singularity subtraction.  Convolution time:  47.384318351745605
Norm of psiNew =  0.996086729302
eigenvalueHistory: 
 [-4.55228049 -4.57947081 -4.58613807 -4.58783289]
Orbital energy after Harrison update:  -4.58783289457
Orbital 0 error and eigenvalue residual:   -2.322e-01 and 1.695e-03
Orbital 0 wavefunction residual: 4.038e-03


Using singularity subtraction.  Convolution time:  47.50140929222107
Norm of psiNew =  0.998019693743
eigenvalueHistory: 
 [-4.55228049 -4.57947081 -4.58613807 -4.58783289 -4.58824397]
Orbital energy after Harrison update:  -4.58824396574
Orbital 0 error and eigenvalue residual:   -2.326e-01 and 4.111e-04
Orbital 0 wavefunction residual: 2.034e-03


Using singularity subtraction.  Convolution time:  47.39783692359924
Norm of psiNew =  0.999030794502
eigenvalueHistory: 
 [-4.55228049 -4.57947081 -4.58613807 -4.58783289 -4.58824397 -4.58834035]
Orbital energy after Harrison update:  -4.58834035054
Orbital 0 error and eigenvalue residual:   -2.327e-01 and 9.638e-05
Orbital 0 wavefunction residual: 9.928e-04


Turning on Anderson Mixing for wavefunction 0
Using singularity subtraction.  Convolution time:  47.49752330780029
Norm of psiNew =  0.999533396583
eigenvalueHistory: 
 [-4.55228049 -4.57947081 -4.58613807 -4.58783289 -4.58824397 -4.58834035
 -4.58836249]
Orbital energy after Harrison update:  -4.58836248877
Anderson mixing on the orbital.
Input densities has shape  (624000, 1)

Anderson weights:  [] 1.0
Orbital 0 error and eigenvalue residual:   -2.327e-01 and 2.214e-05
Orbital 0 wavefunction residual: 4.774e-04


Using singularity subtraction.  Convolution time:  47.05040502548218
Norm of psiNew =  0.999653946016
eigenvalueHistory: 
 [-4.55228049 -4.57947081 -4.58613807 -4.58783289 -4.58824397 -4.58834035
 -4.58836249 -4.58836547]
Orbital energy after Harrison update:  -4.58836547
Anderson mixing on the orbital.
Input densities has shape  (624000, 2)

Anderson weights:  [-2.84352535] 3.8435253488
Orbital 0 error and eigenvalue residual:   -2.328e-01 and 2.981e-06
Orbital 0 wavefunction residual: 3.532e-04


Using singularity subtraction.  Convolution time:  47.05876183509827
Norm of psiNew =  1.00000371547
eigenvalueHistory: 
 [-4.55228049 -4.57947081 -4.58613807 -4.58783289 -4.58824397 -4.58834035
 -4.58836249 -4.58836547 -4.58836898]
Orbital energy after Harrison update:  -4.58836897503
Anderson mixing on the orbital.
Input densities has shape  (624000, 3)

Anderson weights:  [-0.61014132  0.83189686] 0.778244458682
Orbital 0 error and eigenvalue residual:   -2.328e-01 and 3.505e-06
Orbital 0 wavefunction residual: 3.349e-06


Using singularity subtraction.  Convolution time:  47.39764380455017
Norm of psiNew =  1.00000072272
eigenvalueHistory: 
 [-4.55228049 -4.57947081 -4.58613807 -4.58783289 -4.58824397 -4.58834035
 -4.58836249 -4.58836547 -4.58836898 -4.58836898]
Orbital energy after Harrison update:  -4.58836898281
Anderson mixing on the orbital.
Input densities has shape  (624000, 4)

Anderson weights:  [ 0.52789957 -0.72566272 -1.79703832] 2.99480147025
Orbital 0 error and eigenvalue residual:   -2.328e-01 and 7.787e-09
Orbital 0 wavefunction residual: 7.278e-07


Used 10 iterations for orbital 0.



Working on orbital 1
Using singularity subtraction.  Convolution time:  47.48367881774902
Norm of psiNew =  0.995512251655
eigenvalueHistory: 
 -0.7143064078011375
Orbital energy after Harrison update:  -0.714306407801
Orbital 1 error and eigenvalue residual:   -8.307e-03 and 4.523e-03
Orbital 1 wavefunction residual: 1.264e-02


Using singularity subtraction.  Convolution time:  47.38136601448059
Norm of psiNew =  0.999431969889
eigenvalueHistory: 
 [-0.71430641 -0.71507052]
Orbital energy after Harrison update:  -0.715070517288
Orbital 1 error and eigenvalue residual:   -9.071e-03 and 7.641e-04
Orbital 1 wavefunction residual: 1.020e-02


Using singularity subtraction.  Convolution time:  47.47529935836792
Norm of psiNew =  0.999409229101
eigenvalueHistory: 
 [-0.71430641 -0.71507052 -0.71555119]
Orbital energy after Harrison update:  -0.715551191245
Orbital 1 error and eigenvalue residual:   -9.551e-03 and 4.807e-04
Orbital 1 wavefunction residual: 6.518e-03


Using singularity subtraction.  Convolution time:  47.488685607910156
Norm of psiNew =  0.999437695644
eigenvalueHistory: 
 [-0.71430641 -0.71507052 -0.71555119 -0.71566445]
Orbital energy after Harrison update:  -0.715664447708
Orbital 1 error and eigenvalue residual:   -9.665e-03 and 1.133e-04
Orbital 1 wavefunction residual: 4.441e-03


Using singularity subtraction.  Convolution time:  47.463510274887085
Norm of psiNew =  0.999695854583
eigenvalueHistory: 
 [-0.71430641 -0.71507052 -0.71555119 -0.71566445 -0.71569712]
Orbital energy after Harrison update:  -0.715697124623
Orbital 1 error and eigenvalue residual:   -9.697e-03 and 3.268e-05
Orbital 1 wavefunction residual: 3.090e-03


Using singularity subtraction.  Convolution time:  47.05383110046387
Norm of psiNew =  0.999915600349
eigenvalueHistory: 
 [-0.71430641 -0.71507052 -0.71555119 -0.71566445 -0.71569712 -0.71570847]
Orbital energy after Harrison update:  -0.715708472493
Orbital 1 error and eigenvalue residual:   -9.709e-03 and 1.135e-05
Orbital 1 wavefunction residual: 2.179e-03


Using singularity subtraction.  Convolution time:  47.454181432724
Norm of psiNew =  1.00007358832
eigenvalueHistory: 
 [-0.71430641 -0.71507052 -0.71555119 -0.71566445 -0.71569712 -0.71570847
 -0.71571292]
Orbital energy after Harrison update:  -0.715712916674
Orbital 1 error and eigenvalue residual:   -9.713e-03 and 4.444e-06
Orbital 1 wavefunction residual: 1.550e-03


Using singularity subtraction.  Convolution time:  47.05315446853638
Norm of psiNew =  1.00018295772
eigenvalueHistory: 
 [-0.71430641 -0.71507052 -0.71555119 -0.71566445 -0.71569712 -0.71570847
 -0.71571292 -0.71571473]
Orbital energy after Harrison update:  -0.715714731377
Orbital 1 error and eigenvalue residual:   -9.715e-03 and 1.815e-06
Orbital 1 wavefunction residual: 1.108e-03


Using singularity subtraction.  Convolution time:  47.36699032783508
Norm of psiNew =  1.00025811837
eigenvalueHistory: 
 [-0.71430641 -0.71507052 -0.71555119 -0.71566445 -0.71569712 -0.71570847
 -0.71571292 -0.71571473 -0.71571545]
Orbital energy after Harrison update:  -0.715715447142
Orbital 1 error and eigenvalue residual:   -9.716e-03 and 7.158e-07
Orbital 1 wavefunction residual: 7.940e-04


Turning on Anderson Mixing for wavefunction 1
Using singularity subtraction.  Convolution time:  47.05715346336365
Norm of psiNew =  1.00030984387
eigenvalueHistory: 
 [-0.71430641 -0.71507052 -0.71555119 -0.71566445 -0.71569712 -0.71570847
 -0.71571292 -0.71571473 -0.71571545 -0.71571569]
Orbital energy after Harrison update:  -0.715715689866
Anderson mixing on the orbital.
Input densities has shape  (624000, 1)

Anderson weights:  [] 1.0
Orbital 1 error and eigenvalue residual:   -9.716e-03 and 2.427e-07
Orbital 1 wavefunction residual: 5.704e-04


Using singularity subtraction.  Convolution time:  47.3948130607605
Norm of psiNew =  1.00032755558
eigenvalueHistory: 
 [-0.71430641 -0.71507052 -0.71555119 -0.71566445 -0.71569712 -0.71570847
 -0.71571292 -0.71571473 -0.71571545 -0.71571569 -0.71571573]
Orbital energy after Harrison update:  -0.7157157282
Anderson mixing on the orbital.
Input densities has shape  (624000, 2)

Anderson weights:  [-6.03869898] 7.03869897992
Orbital 1 error and eigenvalue residual:   -9.716e-03 and 3.833e-08
Orbital 1 wavefunction residual: 4.903e-04


Using singularity subtraction.  Convolution time:  47.37663507461548
Norm of psiNew =  1.00043529947
eigenvalueHistory: 
 [-0.71430641 -0.71507052 -0.71555119 -0.71566445 -0.71569712 -0.71570847
 -0.71571292 -0.71571473 -0.71571545 -0.71571569 -0.71571573 -0.71571529]
Orbital energy after Harrison update:  -0.71571529384
Anderson mixing on the orbital.
Input densities has shape  (624000, 3)

Anderson weights:  [ 25.72710534 -29.98540055] 5.2582952112
Orbital 1 error and eigenvalue residual:   -9.715e-03 and 4.344e-07
Orbital 1 wavefunction residual: 4.777e-05


Using singularity subtraction.  Convolution time:  47.37659549713135
Norm of psiNew =  1.00042640527
eigenvalueHistory: 
 [-0.71430641 -0.71507052 -0.71555119 -0.71566445 -0.71569712 -0.71570847
 -0.71571292 -0.71571473 -0.71571545 -0.71571569 -0.71571573 -0.71571529
 -0.71571542]
Orbital energy after Harrison update:  -0.715715419692
Anderson mixing on the orbital.
Input densities has shape  (624000, 4)

Anderson weights:  [-1.26465918  1.46987823 -0.25990095] 1.05468190661
Orbital 1 error and eigenvalue residual:   -9.716e-03 and 1.259e-07
Orbital 1 wavefunction residual: 7.693e-06


Using singularity subtraction.  Convolution time:  47.0486900806427
Norm of psiNew =  1.00042774784
eigenvalueHistory: 
 [-0.71430641 -0.71507052 -0.71555119 -0.71566445 -0.71569712 -0.71570847
 -0.71571292 -0.71571473 -0.71571545 -0.71571569 -0.71571573 -0.71571529
 -0.71571542 -0.71571541]
Orbital energy after Harrison update:  -0.715715410025
Anderson mixing on the orbital.
Input densities has shape  (624000, 5)

Anderson weights:  [ -9.44090093  11.01370872  -1.93563375  -2.68108324] 4.04390920917
Orbital 1 error and eigenvalue residual:   -9.716e-03 and 9.666e-09
Orbital 1 wavefunction residual: 5.728e-06


Using singularity subtraction.  Convolution time:  47.46906757354736
Norm of psiNew =  1.00043053962
eigenvalueHistory: 
 [-0.71430641 -0.71507052 -0.71555119 -0.71566445 -0.71569712 -0.71570847
 -0.71571292 -0.71571473 -0.71571545 -0.71571569 -0.71571573 -0.71571529
 -0.71571542 -0.71571541 -0.71571539]
Orbital energy after Harrison update:  -0.715715388815
Anderson mixing on the orbital.
Input densities has shape  (624000, 6)

Anderson weights:  [ 10.29445265 -12.03598455   2.11450161  11.71430899 -15.71340136] 4.62612266012
Orbital 1 error and eigenvalue residual:   -9.716e-03 and 2.121e-08
Orbital 1 wavefunction residual: 1.899e-06


Using singularity subtraction.  Convolution time:  47.44565963745117
Norm of psiNew =  1.00042725353
eigenvalueHistory: 
 [-0.71430641 -0.71507052 -0.71555119 -0.71566445 -0.71569712 -0.71570847
 -0.71571292 -0.71571473 -0.71571545 -0.71571569 -0.71571573 -0.71571529
 -0.71571542 -0.71571541 -0.71571539 -0.7157154 ]
Orbital energy after Harrison update:  -0.715715397618
Anderson mixing on the orbital.
Input densities has shape  (624000, 7)

Anderson weights:  [ -3.93934099   4.66387565  -0.8131416  -24.17558896  31.29643326
  -8.98017729] 2.94793993079
Orbital 1 error and eigenvalue residual:   -9.716e-03 and 8.802e-09
Orbital 1 wavefunction residual: 1.817e-06


Using singularity subtraction.  Convolution time:  47.363553285598755
Norm of psiNew =  1.0004297222
eigenvalueHistory: 
 [-0.71430641 -0.71507052 -0.71555119 -0.71566445 -0.71569712 -0.71570847
 -0.71571292 -0.71571473 -0.71571545 -0.71571569 -0.71571573 -0.71571529
 -0.71571542 -0.71571541 -0.71571539 -0.7157154  -0.71571539]
Orbital energy after Harrison update:  -0.715715392141
Anderson mixing on the orbital.
Input densities has shape  (624000, 8)

Anderson weights:  [ -4.82627773   5.57903906  -0.99631356  16.90934622 -21.37041802
   6.03316119  -2.58135019] 2.25281303877
Orbital 1 error and eigenvalue residual:   -9.716e-03 and 5.476e-09
Orbital 1 wavefunction residual: 1.030e-06


Using singularity subtraction.  Convolution time:  47.47175407409668
Norm of psiNew =  1.00042970661
eigenvalueHistory: 
 [-0.71430641 -0.71507052 -0.71555119 -0.71566445 -0.71569712 -0.71570847
 -0.71571292 -0.71571473 -0.71571545 -0.71571569 -0.71571573 -0.71571529
 -0.71571542 -0.71571541 -0.71571539 -0.7157154  -0.71571539 -0.71571539]
Orbital energy after Harrison update:  -0.715715394682
Anderson mixing on the orbital.
Input densities has shape  (624000, 9)

Anderson weights:  [  7.25612812  -8.42747245   1.5240642  -14.01874085  17.42849024
  -4.93641229   3.4701018   -4.90606121] 3.6099024474
Orbital 1 error and eigenvalue residual:   -9.716e-03 and 2.540e-09
Orbital 1 wavefunction residual: 7.588e-07


Used 18 iterations for orbital 1.



Sorted eigenvalues:  [-4.58836898 -0.71571539]
New order:  [0 1]
../src/dataStructures/TreeStruct_CC.py:156: RuntimeWarning: overflow encountered in exp
  temp = 1/(1+np.exp( exponentialArg ) )
Fermi energy:  1.0
Occupations:  [ 2.  2.]


Integrated density:  3.99999551142
Density Residual  0.376921752068
Density Residual from arrays  0.376921752068
Shape of density histories:  (624000, 1) (624000, 1)
Using anderson mixing.
Input densities has shape  (624000, 1)

Anderson weights:  [] 1.0
Integrated anderson density:  3.99999775571
Computing band energy.  Current orbital energies are:  [-4.58836898 -0.71571539]
Electrostatic Energies:
Hartree:          7.25585905747
External:         -34.7655740526
Nuclear-Nuclear:  0.0
Updating total energy without explicit kinetic evaluation.
Band energies after Veff update: -8.608169 H, -4.85e-01 H
Orbital Energy Errors after Veff Update:  [-0.23275357 -0.00971552]
Orbital 0 error: -2.328e-01
Orbital 1 error: -9.716e-03
Orbital Energies:  [-4.58836898 -0.71571539]
Updated V_x:                           -3.1203386179 Hartree
Updated V_c:                           -0.2538033085 Hartree
Updated Band Energy:                   -8.6081687550 H, -4.8493817894e-01 H
Updated Kinetic Energy:                 15.0198291091 H, 7.1076893874e-01 H
Updated E_x:                           -2.3402539635 H, -4.9861780099e-02 H
Updated E_c:                           -0.2249416315 H, -1.5095762355e-03 H
Updated totalElectrostatic:            -27.5097149952 H, -1.2682779454e+00 H
Total Energy:                          -15.0550814810 H, -6.0888036297e-01 H
Energy Residual:                        1.406e+01
Density Residual:                       3.769e-01





SCF Count  2
Orbital Energies:  [-4.58836898 -0.71571539]
Working on orbital 0
Using singularity subtraction.  Convolution time:  47.450109243392944
Norm of psiNew =  0.994575300341
eigenvalueHistory: 
 -4.532030483648719
Orbital energy after Harrison update:  -4.53203048365
Orbital 0 error and eigenvalue residual:   -1.764e-01 and 5.634e-02
Orbital 0 wavefunction residual: 6.714e-04


Turning on Anderson Mixing for wavefunction 0
Using singularity subtraction.  Convolution time:  47.45311260223389
Norm of psiNew =  1.00176276795
eigenvalueHistory: 
 [-4.53203048 -4.53226486]
Orbital energy after Harrison update:  -4.53226486089
Anderson mixing on the orbital.
Input densities has shape  (624000, 1)

Anderson weights:  [] 1.0
Orbital 0 error and eigenvalue residual:   -1.766e-01 and 2.344e-04
Orbital 0 wavefunction residual: 2.593e-03


