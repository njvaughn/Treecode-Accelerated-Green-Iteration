Running on
      1 nyx7505
Running from /home/njvaughn/Greens-Functions-Iterative-Methods/3D-GreenIterations/adaptiveMesh/src/utilities
os.uname()[1] =  nyx7505.arc-ts.umich.edu
Unable to import directSumWrappers due to OSError
Unable to import treecodeWrapper due to OSError
gradientFree =  True
Mixing scheme =  Anderson
vtk directory =  /home/njvaughn/O_with_anderson/LW5_1500o5_plots_eigRes
======================================================================
======================================================================
====================================================================== 

Reading atomic coordinates from:  ../src/utilities/molecularConfigurations/berylliumAtom.csv
in testBatchGreen..., nOrbitals =  2
['../src/utilities/molecularConfigurations/berylliumAtom.csv', '/home/njvaughn/LWvsBiros/Beryllium/LW5o5_1000.csv', 4.0, 2, -14.446201118081863, -2.2903921833555341, -0.22343205529440757, -8.1232305760491457, -0.5]
[-3.85561542 -0.20599987 -0.07579017]
(3,)
Reading atomic coordinates from:  ../src/utilities/molecularConfigurations/berylliumAtom.csv
Using single atom data from:
/home/njvaughn/AtomicData/allElectron/z4/singleAtomData/
Gauge shift  -0.5
Nuclear energy:  0.0
Atom is contained in cell    which has no children.  Divide at atomic location.
There are now 8 leaf cells.
After aspect ratio divide there are 8 leaf cells.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~ Atoms ~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Z = 4 located at (x, y, z) = ( 0.000,  0.000,  0.000)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

On the tree, nOrbitals =  2
type:  <class 'int'>
max depth  15
Number of gridpoints:  484000
max density:  34.7391274047
Integrated density before normalization:  4.00004811829
Integrated density after normalization:  4.0
Initializing density EXTERNALLY took 3.455 seconds.
Initializing orbitals for atom Z = 4 located at (x, y, z) = ( 0.000,  0.000,  0.000)
Orbital index = 0
Orbital 0 filled with (n,ell,m) = (1,0,0) 
Orbital 1 filled with (n,ell,m) = (2,0,0) 
Initializing orbitals EXTERNAL to Tree Structure took 3.340 seconds.
Tree build completed. 
Domain Size:                 [-20.0, 20.0] 
Divide Criterion:             LW5 
Divide Parameter:            1.00e+03 
Total Number of Cells:       4425 
Total Number of Leaf Cells:  3872 
Total Number of Gridpoints:  484000 
Minimum Depth                3 levels 
Maximum Depth:               12 levels 
Cell Order:                  5 
Construction time:           20.5 seconds.
Closest gridpoint to origin:  [-0.00023898185402757011, -0.00023898185402757011, -0.00023898185402757011]
For a distance of:  0.00041392871326276036
Part of a cell centered at:  [-0.0048828125, -0.0048828125, -0.0048828125]

Entering greenIterations_KohnSham_SCF()

Number of targets:    484000
Threads per block:    512
Blocks per grid:      946
[-8.1232305760491457, 14.309060170370618, -2.2903921833555341, -0.22343205529440757, -26.241437049802535, -14.446201118081863]
Integrated density:  4.0
Using Gaussian singularity subtraction, alpha =  1
GPUpresent set to  True
Type:  <class 'bool'>
Update orbital energies after computing the initial Veff.  Save them as the reference values for each cell
Computing orbital kinetics using Gradients
Orbital Energy:            [-4.35564344 -0.70600138]
Sorted eigenvalues:  [-4.35564344 -0.70600138]
New order:  [0 1]
Orbital energies after initial sort: 
 [-4.35564344 -0.70600138]
Kinetic:    [ 6.58712807  0.56743436]
Potential:  [-10.94277151  -1.27343575]
Computing band energy.  Current orbital energies are:  [-4.35564344 -0.70600138]
Electrostatic Energies:
Hartree:          7.11519081565
External:         -33.3567172807
Nuclear-Nuclear:  0.0
Updating total energy WITH explicit kinetic evaluation.
Orbital Energies:  [-4.35564344 -0.70600138]
Orbital Energy Errors after initialization:  [ -2.80256100e-05  -1.51255675e-06]
Updated V_x:                           -3.0538445976 Hartree
Updated V_c:                           -0.2522041737 Hartree
Updated Band Energy:                   -8.1232896524 H, -5.9076338074e-05 H
Updated Kinetic Energy:                 14.3090947684 H, 3.4597982228e-05 H
Updated E_x:                           -2.2903834482 H, 8.7351462699e-06 H
Updated E_c:                           -0.2234317779 H, 2.7738864394e-07 H
Updated totalElectrostatic:            -26.2415264651 H, -8.9415275134e-05 H
Total Energy:                          -14.4462469228 H, -4.5804757988e-05 H



SCF Count  1
Orbital Energies:  [-4.35564344 -0.70600138]
Working on orbital 0
Using singularity subtraction.  Convolution time:  28.4579975605011
Norm of psiNew =  1.00000321224
eigenvalueHistory: 
 -4.355759066044163
Orbital energy after Harrison update:  -4.35575906604
Orbital 0 error and eigenvalue residual:   -1.436e-04 and 1.156e-04
Orbital 0 wavefunction residual: 4.842e-05


Turning on Anderson Mixing for wavefunction 0
Using singularity subtraction.  Convolution time:  28.47178030014038
Norm of psiNew =  0.999992370535
eigenvalueHistory: 
 [-4.35575907 -4.3557591 ]
Orbital energy after Harrison update:  -4.35575910126
Anderson mixing on the orbital.
Input densities has shape  (484000, 1)

Anderson weights:  [] 1.0
Orbital 0 error and eigenvalue residual:   -1.437e-04 and 3.521e-08
Orbital 0 wavefunction residual: 9.523e-06


Using singularity subtraction.  Convolution time:  28.494466304779053
Norm of psiNew =  0.999994501542
eigenvalueHistory: 
 [-4.35575907 -4.3557591  -4.3557591 ]
Orbital energy after Harrison update:  -4.35575910193
Anderson mixing on the orbital.
Input densities has shape  (484000, 2)

Anderson weights:  [-2.56083083] 3.5608308285
Orbital 0 error and eigenvalue residual:   -1.437e-04 and 6.719e-10
Orbital 0 wavefunction residual: 6.859e-06


Using singularity subtraction.  Convolution time:  28.48561429977417
Norm of psiNew =  0.999999983212
eigenvalueHistory: 
 [-4.35575907 -4.3557591  -4.3557591  -4.3557591 ]
Orbital energy after Harrison update:  -4.35575910263
Anderson mixing on the orbital.
Input densities has shape  (484000, 3)

Anderson weights:  [ 3.07161346 -4.27295779] 2.20134432504
Orbital 0 error and eigenvalue residual:   -1.437e-04 and 7.025e-10
Orbital 0 wavefunction residual: 3.034e-07


Used 4 iterations for orbital 0.



Working on orbital 1
Using singularity subtraction.  Convolution time:  28.48134708404541
Norm of psiNew =  1.00000652514
eigenvalueHistory: 
 -0.7060119668859286
Orbital energy after Harrison update:  -0.706011966886
Orbital 1 error and eigenvalue residual:   -1.210e-05 and 1.058e-05
Orbital 1 wavefunction residual: 1.556e-04


Turning on Anderson Mixing for wavefunction 1
Using singularity subtraction.  Convolution time:  28.495238542556763
Norm of psiNew =  1.00000084728
eigenvalueHistory: 
 [-0.70601197 -0.70601198]
Orbital energy after Harrison update:  -0.70601198308
Anderson mixing on the orbital.
Input densities has shape  (484000, 1)

Anderson weights:  [] 1.0
Orbital 1 error and eigenvalue residual:   -1.211e-05 and 1.619e-08
Orbital 1 wavefunction residual: 1.713e-05


Using singularity subtraction.  Convolution time:  28.490706205368042
Norm of psiNew =  1.00000108049
eigenvalueHistory: 
 [-0.70601197 -0.70601198 -0.70601198]
Orbital energy after Harrison update:  -0.70601198322
Anderson mixing on the orbital.
Input densities has shape  (484000, 2)

Anderson weights:  [-1.54367732] 2.54367731943
Orbital 1 error and eigenvalue residual:   -1.211e-05 and 1.392e-10
Orbital 1 wavefunction residual: 1.091e-05


Using singularity subtraction.  Convolution time:  28.481273651123047
Norm of psiNew =  1.00000159764
eigenvalueHistory: 
 [-0.70601197 -0.70601198 -0.70601198 -0.70601198]
Orbital energy after Harrison update:  -0.706011983285
Anderson mixing on the orbital.
Input densities has shape  (484000, 3)

Anderson weights:  [ 2.80838416 -4.7111053 ] 2.90272114643
Orbital 1 error and eigenvalue residual:   -1.211e-05 and 6.525e-11
Orbital 1 wavefunction residual: 2.994e-06


Using singularity subtraction.  Convolution time:  28.502076625823975
Norm of psiNew =  1.00000192446
eigenvalueHistory: 
 [-0.70601197 -0.70601198 -0.70601198 -0.70601198 -0.70601198]
Orbital energy after Harrison update:  -0.706011983267
Anderson mixing on the orbital.
Input densities has shape  (484000, 4)

Anderson weights:  [-3.89799221  6.54715238 -4.23424763] 2.58508746164
Orbital 1 error and eigenvalue residual:   -1.211e-05 and 1.815e-11
Orbital 1 wavefunction residual: 1.161e-06


Using singularity subtraction.  Convolution time:  28.50992465019226
Norm of psiNew =  1.0000020714
eigenvalueHistory: 
 [-0.70601197 -0.70601198 -0.70601198 -0.70601198 -0.70601198 -0.70601198]
Orbital energy after Harrison update:  -0.706011983259
Anderson mixing on the orbital.
Input densities has shape  (484000, 5)

Anderson weights:  [  8.61315049 -14.46639689   9.39927425  -6.09204806] 3.54602020505
Orbital 1 error and eigenvalue residual:   -1.211e-05 and 7.310e-12
Orbital 1 wavefunction residual: 5.898e-07


Used 6 iterations for orbital 1.



Sorted eigenvalues:  [-4.3557591  -0.70601198]
New order:  [0 1]
../src/dataStructures/TreeStruct_CC.py:156: RuntimeWarning: overflow encountered in exp
  temp = 1/(1+np.exp( exponentialArg ) )
Fermi energy:  1.0
Occupations:  [ 2.  2.]


Integrated density:  3.99999999999
Density Residual  0.000273504635225
Density Residual from arrays  0.000273504635225
Shape of density histories:  (484000, 1) (484000, 1)
Using anderson mixing.
Input densities has shape  (484000, 1)

Anderson weights:  [] 1.0
Integrated anderson density:  4.0
Computing band energy.  Current orbital energies are:  [-4.3557591  -0.70601198]
Electrostatic Energies:
Hartree:          7.11526438764
External:         -33.3572440258
Nuclear-Nuclear:  0.0
Updating total energy without explicit kinetic evaluation.
Band energies after Veff update: -8.123542 H, -3.12e-04 H
Orbital Energy Errors after Veff Update:  [ -1.43685112e-04  -1.21127503e-05]
Orbital 0 error: -1.437e-04
Orbital 1 error: -1.211e-05
Orbital Energies:  [-4.3557591  -0.70601198]
Updated V_x:                           -3.0538827667 Hartree
Updated V_c:                           -0.2522049275 Hartree
Updated Band Energy:                   -8.1235421718 H, -3.1159573005e-04 H
Updated Kinetic Energy:                 14.3092607729 H, 2.0060251549e-04 H
Updated E_x:                           -2.2904120750 H, -1.9891651889e-05 H
Updated E_c:                           -0.2234324970 H, -4.4171700739e-07 H
Updated totalElectrostatic:            -26.2419796382 H, -5.4258837241e-04 H
Total Energy:                          -14.4465634373 H, -3.6231922581e-04 H
Energy Residual:                        1.345e+01
Density Residual:                       2.735e-04





SCF Count  2
Orbital Energies:  [-4.3557591  -0.70601198]
Working on orbital 0
Using singularity subtraction.  Convolution time:  28.478315591812134
Norm of psiNew =  0.9999969754
eigenvalueHistory: 
 -4.355729055667168
Orbital energy after Harrison update:  -4.35572905567
Orbital 0 error and eigenvalue residual:   -1.136e-04 and 3.005e-05
Orbital 0 wavefunction residual: 2.824e-07


Turning on Anderson Mixing for wavefunction 0
Used 1 iterations for orbital 0.



Working on orbital 1
Using singularity subtraction.  Convolution time:  28.477238655090332
Norm of psiNew =  1.00000110819
eigenvalueHistory: 
 -0.7060100340620015
Orbital energy after Harrison update:  -0.706010034062
Orbital 1 error and eigenvalue residual:   -1.016e-05 and 1.949e-06
Orbital 1 wavefunction residual: 4.695e-07


Turning on Anderson Mixing for wavefunction 1
Used 1 iterations for orbital 1.



Sorted eigenvalues:  [-4.35572906 -0.70601003]
New order:  [0 1]
Fermi energy:  1.0
Occupations:  [ 2.  2.]


Integrated density:  4.0
Density Residual  0.00013838260804
Density Residual from arrays  0.00013838260804
Shape of density histories:  (484000, 2) (484000, 2)
Using anderson mixing.
Input densities has shape  (484000, 2)

Anderson weights:  [-1.02353008] 2.02353007868
Integrated anderson density:  4.0
Computing band energy.  Current orbital energies are:  [-4.35572906 -0.70601003]
Electrostatic Energies:
Hartree:          7.11533973988
External:         -33.357789313
Nuclear-Nuclear:  0.0
Updating total energy without explicit kinetic evaluation.
Band energies after Veff update: -8.123478 H, -2.48e-04 H
Orbital Energy Errors after Veff Update:  [ -1.13638149e-04  -1.01635530e-05]
Orbital 0 error: -1.136e-04
Orbital 1 error: -1.016e-05
Orbital Energies:  [-4.35572906 -0.70601003]
Updated V_x:                           -3.0539221292 Hartree
Updated V_c:                           -0.2522056966 Hartree
Updated Band Energy:                   -8.1234781795 H, -2.4760340919e-04 H
Updated Kinetic Energy:                 14.3097594796 H, 6.9930919760e-04 H
Updated E_x:                           -2.2904415969 H, -4.9413558487e-05 H
Updated E_c:                           -0.2234332309 H, -1.1756336256e-06 H
Updated totalElectrostatic:            -26.2424495731 H, -1.0125232875e-03 H
Total Energy:                          -14.4465649214 H, -3.6380328198e-04 H
Energy Residual:                        1.484e-06
Density Residual:                       1.384e-04





SCF Count  3
Orbital Energies:  [-4.35572906 -0.70601003]
Working on orbital 0
Using singularity subtraction.  Convolution time:  28.47727680206299
Norm of psiNew =  0.999997869556
eigenvalueHistory: 
 -4.355698259304623
Orbital energy after Harrison update:  -4.3556982593
Orbital 0 error and eigenvalue residual:   -8.284e-05 and 3.080e-05
Orbital 0 wavefunction residual: 1.350e-06


Turning on Anderson Mixing for wavefunction 0
Using singularity subtraction.  Convolution time:  28.483685731887817
Norm of psiNew =  1.00000140691
eigenvalueHistory: 
 [-4.35569826 -4.35569826]
Orbital energy after Harrison update:  -4.35569825926
Anderson mixing on the orbital.
Input densities has shape  (484000, 1)

Anderson weights:  [] 1.0
Orbital 0 error and eigenvalue residual:   -8.284e-05 and 4.928e-11
Orbital 0 wavefunction residual: 2.131e-06


Using singularity subtraction.  Convolution time:  28.48094630241394
Norm of psiNew =  1.00000100495
eigenvalueHistory: 
 [-4.35569826 -4.35569826 -4.35569826]
Orbital energy after Harrison update:  -4.35569825928
Anderson mixing on the orbital.
Input densities has shape  (484000, 2)

Anderson weights:  [-2.3446102] 3.34461020335
Orbital 0 error and eigenvalue residual:   -8.284e-05 and 1.994e-11
Orbital 0 wavefunction residual: 1.495e-06


Using singularity subtraction.  Convolution time:  28.498112201690674
Norm of psiNew =  1.00000004621
eigenvalueHistory: 
 [-4.35569826 -4.35569826 -4.35569826 -4.35569826]
Orbital energy after Harrison update:  -4.3556982593
Anderson mixing on the orbital.
Input densities has shape  (484000, 3)

Anderson weights:  [ 4.54762562 -6.50275209] 2.95512646702
Orbital 0 error and eigenvalue residual:   -8.284e-05 and 2.075e-11
Orbital 0 wavefunction residual: 5.245e-08


Used 4 iterations for orbital 0.



Working on orbital 1
Using singularity subtraction.  Convolution time:  28.48377275466919
Norm of psiNew =  1.00000233109
eigenvalueHistory: 
 -0.7060080925725215
Orbital energy after Harrison update:  -0.706008092573
Orbital 1 error and eigenvalue residual:   -8.222e-06 and 1.941e-06
Orbital 1 wavefunction residual: 2.530e-06


Turning on Anderson Mixing for wavefunction 1
Using singularity subtraction.  Convolution time:  28.47830319404602
Norm of psiNew =  1.00000279652
eigenvalueHistory: 
 [-0.70600809 -0.70600809]
Orbital energy after Harrison update:  -0.706008092455
Anderson mixing on the orbital.
Input densities has shape  (484000, 1)

Anderson weights:  [] 1.0
Orbital 1 error and eigenvalue residual:   -8.222e-06 and 1.172e-10
Orbital 1 wavefunction residual: 2.409e-06


Using singularity subtraction.  Convolution time:  28.49808406829834
Norm of psiNew =  1.00000269063
eigenvalueHistory: 
 [-0.70600809 -0.70600809 -0.70600809]
Orbital energy after Harrison update:  -0.706008092474
Anderson mixing on the orbital.
Input densities has shape  (484000, 2)

Anderson weights:  [-4.11579893] 5.11579893151
Orbital 1 error and eigenvalue residual:   -8.222e-06 and 1.901e-11
Orbital 1 wavefunction residual: 2.003e-06


Using singularity subtraction.  Convolution time:  28.47951316833496
Norm of psiNew =  1.00000224253
eigenvalueHistory: 
 [-0.70600809 -0.70600809 -0.70600809 -0.70600809]
Orbital energy after Harrison update:  -0.706008092533
Anderson mixing on the orbital.
Input densities has shape  (484000, 3)

Anderson weights:  [ 13.9839431  -17.47527854] 4.4913354349
Orbital 1 error and eigenvalue residual:   -8.222e-06 and 5.862e-11
Orbital 1 wavefunction residual: 6.791e-07


Used 4 iterations for orbital 1.



Sorted eigenvalues:  [-4.35569826 -0.70600809]
New order:  [0 1]
Fermi energy:  1.0
Occupations:  [ 2.  2.]


Integrated density:  3.99999999996
Density Residual  2.64508592283e-05
Density Residual from arrays  2.64508592283e-05
Shape of density histories:  (484000, 3) (484000, 3)
Using anderson mixing.
Input densities has shape  (484000, 3)

Anderson weights:  [-0.85785395  1.71315575] 0.144698202222
Integrated anderson density:  4.0
