Running on
      1 nyx7507
Running from /home/njvaughn/Greens-Functions-Iterative-Methods/3D-GreenIterations/adaptiveMesh/src/utilities
gradientFree =  True
Mixing scheme =  Anderson
vtk directory =  /home/njvaughn/O_with_anderson/LW5_1500o5_plots_eigRes
======================================================================
======================================================================
====================================================================== 

Reading atomic coordinates from:  ../src/utilities/molecularConfigurations/oxygenAtom.csv
Setting nOrbitals to seven for purposes of running Carbon monoxide.
in testBatchGreen..., nOrbitals =  7
['../src/utilities/molecularConfigurations/oxygenAtom.csv', '/home/njvaughn/O_with_anderson/LW5o5_1500_6_orbitals.csv', 8.0, 7, -74.469337501098821, -7.219370082893998, -0.54455323568788838, -40.613397710076626, -0.5]
[-18.75890296  -0.87120699  -0.33829445  -0.33829445  -0.33829445   0.           0.
   0.           0.        ]
(9,)
Reading atomic coordinates from:  ../src/utilities/molecularConfigurations/oxygenAtom.csv
Using single atom data from:
/home/njvaughn/AtomicData/allElectron/z8/singleAtomData/
Gauge shift  -0.5
Nuclear energy:  0.0
Atom is contained in cell    which has no children.  Divide at atomic location.
There are now 8 leaf cells.
After aspect ratio divide there are 8 leaf cells.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~ Atoms ~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Z = 8 located at (x, y, z) = ( 0.000,  0.000,  0.000)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

On the tree, nOrbitals =  7
type:  <class 'int'>
max depth  20
Number of gridpoints:  484000
max density:  306.586216826
Integrated density before normalization:  8.00005789033
Integrated density after normalization:  8.0
Initializing density EXTERNALLY took 3.453 seconds.
Initializing orbitals for atom Z = 8 located at (x, y, z) = ( 0.000,  0.000,  0.000)
Orbital index = 0
Orbital 0 filled with (n,ell,m) = (1,0,0) 
Orbital 1 filled with (n,ell,m) = (2,0,0) 
Didn't fill all the orbitals.  Should you initialize more?  Randomly, or using more single atom data?
Filling extra orbitals with random initial data.
Initializing orbital  2  randomly...
Initializing orbitals randomly inside Tree Structure took 0.918 seconds.
Initializing orbital  3  randomly...
Initializing orbitals randomly inside Tree Structure took 0.917 seconds.
Initializing orbital  4  randomly...
Initializing orbitals randomly inside Tree Structure took 0.894 seconds.
Initializing orbital  5  randomly...
Initializing orbitals randomly inside Tree Structure took 0.942 seconds.
Initializing orbital  6  randomly...
Initializing orbitals randomly inside Tree Structure took 0.904 seconds.
Initializing orbitals EXTERNAL to Tree Structure took 55.529 seconds.
Tree build completed. 
Domain Size:                 [-20.0, 20.0] 
Divide Criterion:             LW5 
Divide Parameter:            1.00e+03 
Total Number of Cells:       4425 
Total Number of Leaf Cells:  3872 
Total Number of Gridpoints:  484000 
Minimum Depth                3 levels 
Maximum Depth:               12 levels 
Cell Order:                  5 
Construction time:           79.5 seconds.
Closest gridpoint to origin:  [-0.00023898185402757011, -0.00023898185402757011, -0.00023898185402757011]
For a distance of:  0.00041392871326276036
Part of a cell centered at:  [-0.0048828125, -0.0048828125, -0.0048828125]

Entering greenIterations_KohnSham_SCF()

Number of targets:    484000
Threads per block:    512
Blocks per grid:      946
[74.112730191157425, -7.219370082893998, -0.54455323568788838, -140.81814437367436, -74.469337501098821, -0.5]
Integrated density:  8.0
Using Gaussian singularity subtraction, alpha =  1
Computing Vcoulomb took:    34.3017 seconds. 
Update orbital energies after computing the initial Veff.  Save them as the reference values for each cell
Computing orbital kinetics using Gradients
Orbital Energy:            [-19.25979178  -1.37123541   1.75435586   7.53308025   8.1271055
   8.26100887   8.38860455]
Sorted eigenvalues:  [-19.25979178  -1.37123541   1.75435586   7.53308025   8.1271055
   8.26100887   8.38860455]
New order:  [0 1 2 3 4 5 6]
Orbital energies after initial sort: 
 [-19.25979178  -1.37123541   1.75435586   7.53308025   8.1271055
   8.26100887   8.38860455]
Kinetic:    [ 28.75701121   3.19602104   2.25716855   8.03526162   8.62922978
   8.7630882    8.8906821 ]
Potential:  [-48.01680299  -4.56725646  -0.5028127   -0.50218137  -0.50212428
  -0.50207933  -0.50207755]
Computing band energy.  Current orbital energies are:  [-19.25979178  -1.37123541   1.75435586   7.53308025   8.1271055
   8.26100887   8.38860455]
Electrostatic Energies:
Hartree:          36.3250195668
External:         -177.146329145
Nuclear-Nuclear:  0.0
Updating total energy WITH explicit kinetic evaluation.
Orbital Energies:  [-19.25979178  -1.37123541   1.75435586   7.53308025   8.1271055
   8.26100887   8.38860455]
Orbital Energy Errors after initialization:  [ -8.88825266e-04  -2.84245901e-05   2.59265031e+00   8.37137470e+00
   8.96539995e+00   8.76100887e+00   8.88860455e+00]
Updated V_x:                           -9.6257967162 Hartree
Updated V_c:                           -0.6072438701 Hartree
Updated Band Energy:                   16.0890465489 H, -5.8023683642e+01 H
Updated Kinetic Energy:                 130.8183771465 H, 1.3803774723e+02 H
Updated E_x:                           -7.2193475372 H, -6.6747943015e+00 H
Updated E_c:                           -0.5445524598 H, 1.4027359191e+02 H
Updated totalElectrostatic:            -140.8213095781 H, -6.6351972077e+01 H
Total Energy:                          -17.7668324286 H, -1.7266832429e+01 H



SCF Count  1
Orbital Energies:  [-19.25979178  -1.37123541  -1.5         -1.5         -1.5         -1.5
  -1.5       ]
Working on orbital 0
Using singularity subtraction.  Convolution time:  28.28921413421631
Norm of psiNew =  0.999997957085
eigenvalueHistory:  -19.26107792102537
Orbital energy after Harrison update:  -19.261077921
Orbital 0 error and eigenvalue residual:   -2.175e-03 and 1.286e-03
Orbital 0 wavefunction residual: 9.352e-05


Turning on Anderson Mixing for wavefunction 0
Using singularity subtraction.  Convolution time:  28.28058648109436
Norm of psiNew =  0.999978804178
eigenvalueHistory:  [-19.26107792 -19.26107934]
Orbital energy after Harrison update:  -19.2610793422
Anderson mixing on the orbital.
Input densities has shape  (484000, 1)

Anderson weights:  [] 1.0
Orbital 0 error and eigenvalue residual:   -2.176e-03 and 1.421e-06
Orbital 0 wavefunction residual: 3.408e-05


Using singularity subtraction.  Convolution time:  28.319041967391968
Norm of psiNew =  0.999994980653
eigenvalueHistory:  [-19.26107792 -19.26107934 -19.26107937]
Orbital energy after Harrison update:  -19.2610793721
Anderson mixing on the orbital.
Input densities has shape  (484000, 2)

Anderson weights:  [ 0.01126551] 0.988734489264
Orbital 0 error and eigenvalue residual:   -2.176e-03 and 2.992e-08
Orbital 0 wavefunction residual: 2.121e-05


Using singularity subtraction.  Convolution time:  28.327725410461426
Norm of psiNew =  0.999996413825
eigenvalueHistory:  [-19.26107792 -19.26107934 -19.26107937 -19.26107939]
Orbital energy after Harrison update:  -19.2610793868
Anderson mixing on the orbital.
Input densities has shape  (484000, 3)

Anderson weights:  [ 0.00484148 -2.54998042] 3.54513894115
Orbital 0 error and eigenvalue residual:   -2.176e-03 and 1.474e-08
Orbital 0 wavefunction residual: 1.524e-05


Using singularity subtraction.  Convolution time:  28.29841160774231
Norm of psiNew =  1.00000000038
eigenvalueHistory:  [-19.26107792 -19.26107934 -19.26107937 -19.26107939 -19.2610794 ]
Orbital energy after Harrison update:  -19.261079402
Anderson mixing on the orbital.
Input densities has shape  (484000, 4)

Anderson weights:  [-0.00518783  3.2573116  -4.53309684] 2.28097306346
Orbital 0 error and eigenvalue residual:   -2.176e-03 and 1.516e-08
Orbital 0 wavefunction residual: 5.675e-07


Used 5 iterations for orbital 0.



Working on orbital 1
Using singularity subtraction.  Convolution time:  28.296973705291748
Norm of psiNew =  0.999988650394
eigenvalueHistory:  -1.3713381444587123
Orbital energy after Harrison update:  -1.37133814446
Orbital 1 error and eigenvalue residual:   -1.312e-04 and 1.027e-04
Orbital 1 wavefunction residual: 7.733e-05


Turning on Anderson Mixing for wavefunction 1
Using singularity subtraction.  Convolution time:  28.30593991279602
Norm of psiNew =  1.00000048961
eigenvalueHistory:  [-1.37133814 -1.37133822]
Orbital energy after Harrison update:  -1.37133821776
Anderson mixing on the orbital.
Input densities has shape  (484000, 1)

Anderson weights:  [] 1.0
Orbital 1 error and eigenvalue residual:   -1.312e-04 and 7.330e-08
Orbital 1 wavefunction residual: 4.277e-05


Using singularity subtraction.  Convolution time:  28.283788681030273
Norm of psiNew =  0.999999236839
eigenvalueHistory:  [-1.37133814 -1.37133822 -1.37133822]
Orbital energy after Harrison update:  -1.37133822209
Anderson mixing on the orbital.
Input densities has shape  (484000, 2)

Anderson weights:  [-2.17180725] 3.17180724962
Orbital 1 error and eigenvalue residual:   -1.312e-04 and 4.333e-09
Orbital 1 wavefunction residual: 3.099e-05


Using singularity subtraction.  Convolution time:  28.275951385498047
Norm of psiNew =  1.00000304795
eigenvalueHistory:  [-1.37133814 -1.37133822 -1.37133822 -1.37133822]
Orbital energy after Harrison update:  -1.37133822462
Anderson mixing on the orbital.
Input densities has shape  (484000, 3)

Anderson weights:  [ 0.00022984 -0.22742676] 1.22719692036
Orbital 1 error and eigenvalue residual:   -1.312e-04 and 2.527e-09
Orbital 1 wavefunction residual: 6.465e-06


Used 4 iterations for orbital 1.



Working on orbital 2
Using singularity subtraction.  Convolution time:  28.302759170532227
Norm of psiNew =  0.301604383768
eigenvalueHistory:  2.5036785268254924
Orbital energy after Harrison update:  2.50367852683
Setting energy to gauge shift - 0.5 because new value was positive.
Orbital 2 error and eigenvalue residual:   1.383e-01 and 4.004e+00
Orbital 2 wavefunction residual: 2.443e+00


Using singularity subtraction.  Convolution time:  28.298536777496338
Norm of psiNew =  2.29910173408
eigenvalueHistory:  [ 2.50367853 -0.36123605]
Orbital energy after Harrison update:  -0.361236045908
Setting energy to gauge shift - 0.5 because new value was positive.
Orbital 2 error and eigenvalue residual:   1.383e-01 and 3.388e-01
Orbital 2 wavefunction residual: 2.894e+00


Using singularity subtraction.  Convolution time:  28.27472233772278
Norm of psiNew =  0.309918360034
eigenvalueHistory:  [ 2.50367853 -0.36123605 -0.41333099]
Orbital energy after Harrison update:  -0.413330985451
Setting energy to gauge shift - 0.5 because new value was positive.
Orbital 2 error and eigenvalue residual:   1.383e-01 and 2.867e-01
Orbital 2 wavefunction residual: 2.794e+00


Using singularity subtraction.  Convolution time:  28.287183046340942
Norm of psiNew =  2.30940931202
eigenvalueHistory:  [ 2.50367853 -0.36123605 -0.41333099 -0.42075062]
Orbital energy after Harrison update:  -0.420750616589
Setting energy to gauge shift - 0.5 because new value was positive.
Orbital 2 error and eigenvalue residual:   1.383e-01 and 2.792e-01
Orbital 2 wavefunction residual: 2.794e+00


Using singularity subtraction.  Convolution time:  28.29511857032776
Norm of psiNew =  0.310329767429
eigenvalueHistory:  [ 2.50367853 -0.36123605 -0.41333099 -0.42075062 -0.42252583]
Orbital energy after Harrison update:  -0.422525834043
Setting energy to gauge shift - 0.5 because new value was positive.
Orbital 2 error and eigenvalue residual:   1.383e-01 and 2.775e-01
Orbital 2 wavefunction residual: 2.790e+00


Using singularity subtraction.  Convolution time:  28.277328968048096
Norm of psiNew =  2.31103574735
eigenvalueHistory:  [ 2.50367853 -0.36123605 -0.41333099 -0.42075062 -0.42252583 -0.42324469]
Orbital energy after Harrison update:  -0.423244694199
Setting energy to gauge shift - 0.5 because new value was positive.
Orbital 2 error and eigenvalue residual:   1.383e-01 and 2.768e-01
Orbital 2 wavefunction residual: 2.790e+00


Using singularity subtraction.  Convolution time:  28.272789001464844
Norm of psiNew =  0.310499562545
eigenvalueHistory:  [ 2.50367853 -0.36123605 -0.41333099 -0.42075062 -0.42252583 -0.42324469
 -0.42368995]
Orbital energy after Harrison update:  -0.423689945727
Setting energy to gauge shift - 0.5 because new value was positive.
Orbital 2 error and eigenvalue residual:   1.383e-01 and 2.763e-01
Orbital 2 wavefunction residual: 2.788e+00


Using singularity subtraction.  Convolution time:  28.29472541809082
Norm of psiNew =  2.31220673145
eigenvalueHistory:  [ 2.50367853 -0.36123605 -0.41333099 -0.42075062 -0.42252583 -0.42324469
 -0.42368995 -0.42404305]
Orbital energy after Harrison update:  -0.424043045765
Setting energy to gauge shift - 0.5 because new value was positive.
Orbital 2 error and eigenvalue residual:   1.383e-01 and 2.760e-01
Orbital 2 wavefunction residual: 2.788e+00


Using singularity subtraction.  Convolution time:  28.288586854934692
Norm of psiNew =  0.31065601891
eigenvalueHistory:  [ 2.50367853 -0.36123605 -0.41333099 -0.42075062 -0.42252583 -0.42324469
 -0.42368995 -0.42404305 -0.42435888]
Orbital energy after Harrison update:  -0.424358880642
Setting energy to gauge shift - 0.5 because new value was positive.
Orbital 2 error and eigenvalue residual:   1.383e-01 and 2.756e-01
Orbital 2 wavefunction residual: 2.787e+00


Using singularity subtraction.  Convolution time:  28.290242671966553
Norm of psiNew =  2.3134002481
eigenvalueHistory:  [ 2.50367853 -0.36123605 -0.41333099 -0.42075062 -0.42252583 -0.42324469
 -0.42368995 -0.42404305 -0.42435888 -0.42465832]
Orbital energy after Harrison update:  -0.424658320359
Energy still positive after 10 iterations.  The wavefunction isn't being resolved well enough. Setting energy to equal the gauge shift and exiting Green Iterations (maybe).
Orbital 2 error and eigenvalue residual:   3.383e-01 and 2.753e-01
Orbital 2 wavefunction residual: 1.470e+02


Using singularity subtraction.  Convolution time:  28.29840660095215
Norm of psiNew =  139.800036471
eigenvalueHistory:  [ 2.50367853 -0.36123605 -0.41333099 -0.42075062 -0.42252583 -0.42324469
 -0.42368995 -0.42404305 -0.42435888 -0.42465832 -0.44074773]
Orbital energy after Harrison update:  -0.440747734612
Energy still positive after 10 iterations.  The wavefunction isn't being resolved well enough. Setting energy to equal the gauge shift and exiting Green Iterations (maybe).
Orbital 2 error and eigenvalue residual:   3.383e-01 and 5.925e-02
Orbital 2 wavefunction residual: 1.049e+02


Using singularity subtraction.  Convolution time:  28.302274703979492
Norm of psiNew =  138.152092304
eigenvalueHistory:  [ 2.50367853 -0.36123605 -0.41333099 -0.42075062 -0.42252583 -0.42324469
 -0.42368995 -0.42404305 -0.42435888 -0.42465832 -0.44074773 -0.4379236 ]
Orbital energy after Harrison update:  -0.437923596482
Energy still positive after 10 iterations.  The wavefunction isn't being resolved well enough. Setting energy to equal the gauge shift and exiting Green Iterations (maybe).
Orbital 2 error and eigenvalue residual:   3.383e-01 and 6.208e-02
Orbital 2 wavefunction residual: 1.023e+02


Using singularity subtraction.  Convolution time:  28.283353805541992
Norm of psiNew =  138.492234486
eigenvalueHistory:  [ 2.50367853 -0.36123605 -0.41333099 -0.42075062 -0.42252583 -0.42324469
 -0.42368995 -0.42404305 -0.42435888 -0.42465832 -0.44074773 -0.4379236
 -0.44217386]
Orbital energy after Harrison update:  -0.442173856285
Energy still positive after 10 iterations.  The wavefunction isn't being resolved well enough. Setting energy to equal the gauge shift and exiting Green Iterations (maybe).
Orbital 2 error and eigenvalue residual:   3.383e-01 and 5.783e-02
Orbital 2 wavefunction residual: 9.976e+01


Using singularity subtraction.  Convolution time:  28.27465534210205
Norm of psiNew =  133.022449311
eigenvalueHistory:  [ 2.50367853 -0.36123605 -0.41333099 -0.42075062 -0.42252583 -0.42324469
 -0.42368995 -0.42404305 -0.42435888 -0.42465832 -0.44074773 -0.4379236
 -0.44217386 -0.43326704]
Orbital energy after Harrison update:  -0.433267043256
Energy still positive after 10 iterations.  The wavefunction isn't being resolved well enough. Setting energy to equal the gauge shift and exiting Green Iterations (maybe).
Orbital 2 error and eigenvalue residual:   3.383e-01 and 6.673e-02
Orbital 2 wavefunction residual: 1.059e+02


Using singularity subtraction.  Convolution time:  28.278647661209106
Norm of psiNew =  139.595489482
eigenvalueHistory:  [ 2.50367853 -0.36123605 -0.41333099 -0.42075062 -0.42252583 -0.42324469
 -0.42368995 -0.42404305 -0.42435888 -0.42465832 -0.44074773 -0.4379236
 -0.44217386 -0.43326704 -0.43812776]
Orbital energy after Harrison update:  -0.438127757936
Energy still positive after 10 iterations.  The wavefunction isn't being resolved well enough. Setting energy to equal the gauge shift and exiting Green Iterations (maybe).
Orbital 2 error and eigenvalue residual:   3.383e-01 and 6.187e-02
Orbital 2 wavefunction residual: 1.020e+02


