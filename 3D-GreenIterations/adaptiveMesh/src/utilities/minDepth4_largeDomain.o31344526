Running on
      1 nyx7507
Running from /home/njvaughn/Greens-Functions-Iterative-Methods/3D-GreenIterations/adaptiveMesh/src/utilities
======================================================================
======================================================================
====================================================================== 

Hard coding nOrbitals to 7
['../src/utilities/molecularConfigurations/carbonMonoxide.csv', '/home/njvaughn/results_CO/results.csv', 14, 7, -112.47200574178584, -11.99707904195925, -0.94214556068954625, -62.89904780033865, -2.0]
Gauge shift  -2.0
Reading atomic coordinates from:  ../src/utilities/molecularConfigurations/carbonMonoxide.csv
Using single atom data from:
/home/njvaughn/AtomicData/allElectron/z6/singleAtomData/
Atom with Z=6 will get 5 atomic orbitals initialized.
Using single atom data from:
/home/njvaughn/AtomicData/allElectron/z8/singleAtomData/
Atom with Z=8 will get 5 atomic orbitals initialized.
Nuclear energy:  22.5180848369

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~ Atoms ~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Z = 6 located at (x, y, z) = ( 1.066,  0.000,  0.000)
Z = 8 located at (x, y, z) = (-1.066,  0.000,  0.000)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

max depth  20
Initializing orbitals randomly...
Tree build completed. 
Domain Size:                 [-20.0, 20.0] 
Divide Criterion:             LW3 
Divide Parameter:            8.00e+02 
Total Number of Cells:       7457 
Total Number of Leaf Cells:  6480 
Total Number of Gridpoints:  414720 
Minimum Depth                4 levels 
Maximum Depth:               11 levels 
Cell Order:                  4 
Construction time:           7.89 seconds.
Closest gridpoint to origin:  [-0.01014124443176817, -0.01189382304511144, -0.01189382304511144]
For a distance of:  0.019641051190853222
Part of a cell centered at:  [-0.13322624999999999, -0.15625, -0.15625]

Entering greenIterations_KohnSham_SCF()

Number of targets:    414720
Threads per block:    512
Blocks per grid:      810
[-112.47200574178584, -11.99707904195925, -0.94214556068954625, -62.89904780033865]
Update orbital energies after computing the initial Veff.

Need to re-order orbitals.
New order:  [2 1 4 3 0 5 6]

Orbital Energy:            [ 3324.29848848  3359.77047421  3461.28320407  3625.38610911  3630.31512277
  3763.93076725  3889.55507275]
Warning: 0 orbital energy > 0.  Resetting to gauge shift.
Warning: 1 orbital energy > 0.  Resetting to gauge shift.
Warning: 2 orbital energy > 0.  Resetting to gauge shift.
Warning: 3 orbital energy > 0.  Resetting to gauge shift.
Warning: 4 orbital energy > 0.  Resetting to gauge shift.
Warning: 5 orbital energy > 0.  Resetting to gauge shift.
Warning: 6 orbital energy > 0.  Resetting to gauge shift.
New order:  [0 1 2 3 4 5 6]
Fermi energy:  1.0
Occupations:  [ 2.  2.  2.  2.  2.  2.  2.]




SCF Count  1
Using singularity skipping...
Only normalizing, not orthogonalizing orbitals
Residual for orbital 0: 1.45996e+02
Residual for orbital 1: 1.45691e+02
Residual for orbital 2: 1.45512e+02
Residual for orbital 3: 1.44895e+02
Residual for orbital 4: 1.45496e+02
Residual for orbital 5: 1.44886e+02
Residual for orbital 6: 1.45080e+02
Computing orbital energies before orthogonalizing.  Sort when needed.

Need to re-order orbitals.
New order:  [0 6 3 5 4 1 2]

Orbital Energy:            [-1.46785455 -1.46606573 -1.4657339  -1.46525011 -1.46523073 -1.46443444
 -1.46373748]
New order:  [0 1 2 3 4 5 6]
Fermi energy:  1.0
Occupations:  [ 2.  2.  2.  2.  2.  2.  2.]

Orthogonalizing based on new order.
Orthonormalizing orbitals within tree structure.
Compute new energies from the orthogonalized orbitals.  Hope no sorting needed.

Need to re-order orbitals.
New order:  [0 1 2 4 6 3 5]

Orbital Energy:            [-1.46785455  1.58960594  1.64672614  1.65814434  1.66849915  1.68602321
  1.68985302]
Warning: 1 orbital energy > 0.  Resetting to gauge shift.
Warning: 2 orbital energy > 0.  Resetting to gauge shift.
Warning: 3 orbital energy > 0.  Resetting to gauge shift.
Warning: 4 orbital energy > 0.  Resetting to gauge shift.
Warning: 5 orbital energy > 0.  Resetting to gauge shift.
Warning: 6 orbital energy > 0.  Resetting to gauge shift.
New order:  [1 2 3 4 5 6 0]
Fermi energy:  1.0
Occupations:  [ 2.  2.  2.  2.  2.  2.  2.]

Using DFT-FE results from after first SCF (after orthogonalization) ...
Orbital 0 error: 1.940e+01
Orbital 1 error: 1.000e+01
Orbital 2 error: 1.186e+00
Orbital 3 error: 6.071e-01
Orbital 4 error: 5.202e-01
Orbital 5 error: 5.202e-01
Orbital 6 error: 3.960e-01
Band energy after 1 iterations in SCF #1:  1.064291 H, 6.40e+01 H
Band energy residual:  23.4678545471



Traceback (most recent call last):
  File "testBatchGreenIterations_KS.py", line 137, in <module>
    testGreenIterationsGPU(tree,vtkExport=False,onTheFlyRefinement=False)
  File "testBatchGreenIterations_KS.py", line 92, in testGreenIterationsGPU
    onTheFlyRefinement=onTheFlyRefinement, vtkExport=vtkExport)
  File "../src/utilities/greenIterations.py", line 326, in greenIterations_KohnSham_SCF
    tree.orbitalEnergies-dftfeOrbitalEnergiesFirstSCF-tree.gaugeShift]
ValueError: operands could not be broadcast together with shapes (7,) (10,) 
