Running on
      1 nyx7509
Running from /home/njvaughn/Greens-Functions-Iterative-Methods/3D-GreenIterations/adaptiveMesh/src/utilities
os.uname()[1] =  nyx7509.arc-ts.umich.edu
Unable to import directSumWrappers due to OSError
Unable to import treecodeWrapper due to OSError
gradientFree =  True
Mixing scheme =  Anderson
vtk directory =  /home/njvaughn/O_with_anderson/LW5_1500o5_plots_eigRes
======================================================================
======================================================================
====================================================================== 

Reading atomic coordinates from:  ../src/utilities/molecularConfigurations/berylliumAtom.csv
in testBatchGreen..., nOrbitals =  2
['../src/utilities/molecularConfigurations/berylliumAtom.csv', '/home/njvaughn/LWMeshes/Beryllium_LW5o5_500.csv', 4.0, 2, -14.446201118081863, -2.2903921833555341, -0.22343205529440757, -8.1232305760491457, -0.5]
[-3.85561542 -0.20599987 -0.07579017]
(3,)
Reading atomic coordinates from:  ../src/utilities/molecularConfigurations/berylliumAtom.csv
Using single atom data from:
/home/njvaughn/AtomicData/allElectron/z4/singleAtomData/
Gauge shift  -0.5
Nuclear energy:  0.0
Atom is contained in cell    which has no children.  Divide at atomic location.
There are now 8 leaf cells.
After aspect ratio divide there are 8 leaf cells.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~ Atoms ~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Z = 4 located at (x, y, z) = ( 0.000,  0.000,  0.000)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

On the tree, nOrbitals =  2
type:  <class 'int'>
max depth  15
Number of gridpoints:  267000
max density:  34.6267056246
Integrated density before normalization:  4.00004763028
Integrated density after normalization:  4.0
Initializing density EXTERNALLY took 1.931 seconds.
Initializing orbitals for atom Z = 4 located at (x, y, z) = ( 0.000,  0.000,  0.000)
Orbital index = 0
Orbital 0 filled with (n,ell,m) = (1,0,0) 
Orbital 1 filled with (n,ell,m) = (2,0,0) 
Initializing orbitals EXTERNAL to Tree Structure took 2.029 seconds.
Tree build completed. 
Domain Size:                 [-20.0, 20.0] 
Divide Criterion:             LW5 
Divide Parameter:            5.00e+02 
Total Number of Cells:       2441 
Total Number of Leaf Cells:  2136 
Total Number of Gridpoints:  267000 
Minimum Depth                3 levels 
Maximum Depth:               11 levels 
Cell Order:                  5 
Construction time:           11.6 seconds.
Closest gridpoint to origin:  [-0.00047796370805514021, -0.00047796370805514021, -0.00047796370805514021]
For a distance of:  0.0008278574265255207
Part of a cell centered at:  [-0.009765625, -0.009765625, -0.009765625]

Entering greenIterations_KohnSham_SCF()

Number of targets:    267000
Threads per block:    512
Blocks per grid:      522
[-8.1232305760491457, 14.309060170370618, -2.2903921833555341, -0.22343205529440757, -26.241437049802535, -14.446201118081863]
Integrated density:  4.0
Using Gaussian singularity subtraction, alpha =  1
GPUpresent set to  True
Type:  <class 'bool'>
Update orbital energies after computing the initial Veff.  Save them as the reference values for each cell
Computing orbital kinetics using Gradients
Orbital Energy:            [-4.35579081 -0.70600495]
Sorted eigenvalues:  [-4.35579081 -0.70600495]
New order:  [0 1]
Orbital energies after initial sort: 
 [-4.35579081 -0.70600495]
Kinetic:    [ 6.58728674  0.56744561]
Potential:  [-10.94307755  -1.27345055]
Computing band energy.  Current orbital energies are:  [-4.35579081 -0.70600495]
Electrostatic Energies:
Hartree:          7.11517885603
External:         -33.3573270862
Nuclear-Nuclear:  0.0
Updating total energy WITH explicit kinetic evaluation.
Orbital Energies:  [-4.35579081 -0.70600495]
Orbital Energy Errors after initialization:  [ -1.75396633e-04  -5.07555810e-06]
Updated V_x:                           -3.0538438990 Hartree
Updated V_c:                           -0.2522041023 Hartree
Updated Band Energy:                   -8.1235915204 H, -3.6094438699e-04 H
Updated Kinetic Energy:                 14.3094258551 H, 3.6568470174e-04 H
Updated E_x:                           -2.2903829243 H, 9.2590779799e-06 H
Updated E_c:                           -0.2234318106 H, 2.4465143358e-07 H
Updated totalElectrostatic:            -26.2421482302 H, -7.1118039858e-04 H
Total Energy:                          -14.4465371100 H, -3.3599196743e-04 H



SCF Count  1
Orbital Energies:  [-4.35579081 -0.70600495]
Working on orbital 0
Using singularity subtraction.  Convolution time:  8.787397623062134
Norm of psiNew =  1.00000266943
eigenvalueHistory: 
 -4.35613983464895
Orbital energy after Harrison update:  -4.35613983465
Orbital 0 error and eigenvalue residual:   -5.244e-04 and 3.490e-04
Orbital 0 wavefunction residual: 9.717e-05


Turning on Anderson Mixing for wavefunction 0
Using singularity subtraction.  Convolution time:  8.784224510192871
Norm of psiNew =  0.99997365261
eigenvalueHistory: 
 [-4.35613983 -4.35614018]
Orbital energy after Harrison update:  -4.3561401816
Anderson mixing on the orbital.
Input densities has shape  (267000, 1)

Anderson weights:  [] 1.0
Orbital 0 error and eigenvalue residual:   -5.248e-04 and 3.470e-07
Orbital 0 wavefunction residual: 3.143e-05


Using singularity subtraction.  Convolution time:  8.793811798095703
Norm of psiNew =  0.999980959242
eigenvalueHistory: 
 [-4.35613983 -4.35614018 -4.35614019]
Orbital energy after Harrison update:  -4.35614019009
Anderson mixing on the orbital.
Input densities has shape  (267000, 2)

Anderson weights:  [-2.64187926] 3.64187925661
Orbital 0 error and eigenvalue residual:   -5.248e-04 and 8.490e-09
Orbital 0 wavefunction residual: 2.282e-05


Using singularity subtraction.  Convolution time:  8.785346746444702
Norm of psiNew =  1.00000030571
eigenvalueHistory: 
 [-4.35613983 -4.35614018 -4.35614019 -4.3561402 ]
Orbital energy after Harrison update:  -4.35614019878
Anderson mixing on the orbital.
Input densities has shape  (267000, 3)

Anderson weights:  [ 3.06574158 -4.21857767] 2.15283608624
Orbital 0 error and eigenvalue residual:   -5.248e-04 and 8.694e-09
Orbital 0 wavefunction residual: 8.386e-07


Used 4 iterations for orbital 0.



Working on orbital 1
Using singularity subtraction.  Convolution time:  8.784035682678223
Norm of psiNew =  1.00001662406
eigenvalueHistory: 
 -0.7060345199860234
Orbital energy after Harrison update:  -0.706034519986
Orbital 1 error and eigenvalue residual:   -3.465e-05 and 2.957e-05
Orbital 1 wavefunction residual: 3.030e-04


Turning on Anderson Mixing for wavefunction 1
Using singularity subtraction.  Convolution time:  8.785873651504517
Norm of psiNew =  1.00000418473
eigenvalueHistory: 
 [-0.70603452 -0.70603459]
Orbital energy after Harrison update:  -0.706034587964
Anderson mixing on the orbital.
Input densities has shape  (267000, 1)

Anderson weights:  [] 1.0
Orbital 1 error and eigenvalue residual:   -3.472e-05 and 6.798e-08
Orbital 1 wavefunction residual: 4.735e-05


Using singularity subtraction.  Convolution time:  8.793242692947388
Norm of psiNew =  1.0000049349
eigenvalueHistory: 
 [-0.70603452 -0.70603459 -0.70603459]
Orbital energy after Harrison update:  -0.706034588985
Anderson mixing on the orbital.
Input densities has shape  (267000, 2)

Anderson weights:  [-1.76255019] 2.76255019033
Orbital 1 error and eigenvalue residual:   -3.472e-05 and 1.022e-09
Orbital 1 wavefunction residual: 3.195e-05


Using singularity subtraction.  Convolution time:  8.78668212890625
Norm of psiNew =  1.0000068136
eigenvalueHistory: 
 [-0.70603452 -0.70603459 -0.70603459 -0.70603459]
Orbital energy after Harrison update:  -0.7060345893
Anderson mixing on the orbital.
Input densities has shape  (267000, 3)

Anderson weights:  [ 2.81517698 -4.51927223] 2.70409525258
Orbital 1 error and eigenvalue residual:   -3.472e-05 and 3.150e-10
Orbital 1 wavefunction residual: 9.657e-06


Using singularity subtraction.  Convolution time:  8.78492021560669
Norm of psiNew =  1.00000786134
eigenvalueHistory: 
 [-0.70603452 -0.70603459 -0.70603459 -0.70603459 -0.70603459]
Orbital energy after Harrison update:  -0.70603458906
Anderson mixing on the orbital.
Input densities has shape  (267000, 4)

Anderson weights:  [-4.2152802   6.78210564 -4.34483576] 2.77801032422
Orbital 1 error and eigenvalue residual:   -3.472e-05 and 2.404e-10
Orbital 1 wavefunction residual: 4.224e-06


Using singularity subtraction.  Convolution time:  8.793703079223633
Norm of psiNew =  1.00000844377
eigenvalueHistory: 
 [-0.70603452 -0.70603459 -0.70603459 -0.70603459 -0.70603459 -0.70603459]
Orbital energy after Harrison update:  -0.706034588961
Anderson mixing on the orbital.
Input densities has shape  (267000, 5)

Anderson weights:  [  8.91993651 -14.35092315   9.23952042  -6.19434643] 3.38581264837
Orbital 1 error and eigenvalue residual:   -3.472e-05 and 9.931e-11
Orbital 1 wavefunction residual: 1.961e-06


Using singularity subtraction.  Convolution time:  8.775962114334106
Norm of psiNew =  1.00000866188
eigenvalueHistory: 
 [-0.70603452 -0.70603459 -0.70603459 -0.70603459 -0.70603459 -0.70603459
 -0.70603459]
Orbital energy after Harrison update:  -0.706034588959
Anderson mixing on the orbital.
Input densities has shape  (267000, 6)

Anderson weights:  [-17.54253745  28.22240174 -18.18687039  12.1986713   -7.04549297] 3.35382777178
Orbital 1 error and eigenvalue residual:   -3.472e-05 and 2.153e-12
Orbital 1 wavefunction residual: 8.290e-07


Used 7 iterations for orbital 1.



Sorted eigenvalues:  [-4.3561402  -0.70603459]
New order:  [0 1]
Traceback (most recent call last):
  File "testBatchGreenIterations_KS.py", line 249, in <module>
    testGreenIterationsGPU(tree,vtkExport=False)
  File "testBatchGreenIterations_KS.py", line 158, in testGreenIterationsGPU
    onTheFlyRefinement=onTheFlyRefinement, vtkExport=vtkExport, maxOrbitals=maxOrbitals, maxSCFIterations=maxSCFIterations)
  File "../src/utilities/greenIterations.py", line 642, in greenIterations_KohnSham_SCF
    occupations = computeOccupations(tree.orbitalEnergies, tree.nElectrons, Temperature)
  File "../src/utilities/fermiDiracDistribution.py", line 24, in computeOccupations
    fermiEnergy = brentq(fermiObjectiveFunction, orbitalEnergies[0], 1, xtol=1e-14)
  File "/sw/lsa/centos7/python-anaconda3/created-20170424/lib/python3.5/site-packages/scipy/optimize/zeros.py", line 442, in brentq
    r = _zeros._brentq(f,a,b,xtol,rtol,maxiter,args,full_output,disp)
TypeError: fermiObjectiveFunction() missing 3 required positional arguments: 'nElectrons', 'fermiEnergy', and 'sigma'
