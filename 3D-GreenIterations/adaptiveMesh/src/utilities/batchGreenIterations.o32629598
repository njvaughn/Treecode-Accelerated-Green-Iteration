Running on
      1 nyx7505
Running from /home/njvaughn/Greens-Functions-Iterative-Methods/3D-GreenIterations/adaptiveMesh/src/utilities
os.uname()[1] =  nyx7505.arc-ts.umich.edu
Unable to import directSumWrappers due to OSError
Unable to import treecodeWrapper due to OSError
gradientFree =  True
Mixing scheme =  Anderson
vtk directory =  /home/njvaughn/O_with_anderson/LW5_1500o5_plots_eigRes
======================================================================
======================================================================
====================================================================== 

Reading atomic coordinates from:  ../src/utilities/molecularConfigurations/berylliumAtom.csv
in testBatchGreen..., nOrbitals =  2
['../src/utilities/molecularConfigurations/berylliumAtom.csv', '/home/njvaughn/LWvsBiros/Oxygen/Biros_o7_1em4.csv', 4.0, 2, -14.446201118081863, -2.2903921833555341, -0.22343205529440757, -8.1232305760491457, -0.5]
[-3.85561542 -0.20599987 -0.07579017]
(3,)
Reading atomic coordinates from:  ../src/utilities/molecularConfigurations/berylliumAtom.csv
Using single atom data from:
/home/njvaughn/AtomicData/allElectron/z4/singleAtomData/
Gauge shift  -0.5
Nuclear energy:  0.0
Atom is contained in cell    which has no children.  Divide at atomic location.
There are now 8 leaf cells.
After aspect ratio divide there are 8 leaf cells.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~ Atoms ~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Z = 4 located at (x, y, z) = ( 0.000,  0.000,  0.000)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

On the tree, nOrbitals =  2
type:  <class 'int'>
max depth  12
Number of gridpoints:  348488
max density:  34.8223895755
Integrated density before normalization:  4.0000485738
Integrated density after normalization:  4.0
Initializing density EXTERNALLY took 2.507 seconds.
Initializing orbitals for atom Z = 4 located at (x, y, z) = ( 0.000,  0.000,  0.000)
Orbital index = 0
Orbital 0 filled with (n,ell,m) = (1,0,0) 
Orbital 1 filled with (n,ell,m) = (2,0,0) 
Initializing orbitals EXTERNAL to Tree Structure took 2.477 seconds.
Tree build completed. 
Domain Size:                 [-20.0, 20.0] 
Divide Criterion:             Biros 
Divide Parameter:            1.00e-04 
Total Number of Cells:       1161 
Total Number of Leaf Cells:  1016 
Total Number of Gridpoints:  348488 
Minimum Depth                3 levels 
Maximum Depth:               12 levels 
Cell Order:                  7 
Construction time:           32 seconds.
Closest gridpoint to origin:  [0.00012242230379968936, 0.00012242230379968936, 0.00012242230379968936]
For a distance of:  0.00021204165016069438
Part of a cell centered at:  [0.0048828125, 0.0048828125, 0.0048828125]

Entering greenIterations_KohnSham_SCF()

Number of targets:    348488
Threads per block:    512
Blocks per grid:      681
[-8.1232305760491457, 14.309060170370618, -2.2903921833555341, -0.22343205529440757, -26.241437049802535, -14.446201118081863]
Integrated density:  4.0
Using Gaussian singularity subtraction, alpha =  1
GPUpresent set to  True
Type:  <class 'bool'>
Update orbital energies after computing the initial Veff.  Save them as the reference values for each cell
Computing orbital kinetics using Gradients
Orbital Energy:            [-4.35564384 -0.70601002]
Sorted eigenvalues:  [-4.35564384 -0.70601002]
New order:  [0 1]
Orbital energies after initial sort: 
 [-4.35564384 -0.70601002]
Kinetic:    [ 6.58706264  0.56743159]
Potential:  [-10.94270648  -1.27344161]
Computing band energy.  Current orbital energies are:  [-4.35564384 -0.70601002]
Electrostatic Energies:
Hartree:          7.11517332944
External:         -33.3565635131
Nuclear-Nuclear:  0.0
Updating total energy WITH explicit kinetic evaluation.
Orbital Energies:  [-4.35564384 -0.70601002]
Orbital Energy Errors after initialization:  [ -2.84258070e-05  -1.01457940e-05]
Updated V_x:                           -3.0538441876 Hartree
Updated V_c:                           -0.2522040963 Hartree
Updated Band Energy:                   -8.1233077193 H, -7.7143206676e-05 H
Updated Kinetic Energy:                 14.3089574189 H, -1.0275148432e-04 H
Updated E_x:                           -2.2903831407 H, 9.0426756465e-06 H
Updated E_c:                           -0.2234317252 H, 3.3007923714e-07 H
Updated totalElectrostatic:            -26.2413901837 H, 4.6866093285e-05 H
Total Energy:                          -14.4462476307 H, -4.6512636143e-05 H



SCF Count  1
Orbital Energies:  [-4.35564384 -0.70601002]
Working on orbital 0
Using singularity subtraction.  Convolution time:  15.094332933425903
Norm of psiNew =  1.00000510302
eigenvalueHistory: 
 -4.3557087083907415
Orbital energy after Harrison update:  -4.35570870839
Orbital 0 error and eigenvalue residual:   -9.329e-05 and 6.487e-05
Orbital 0 wavefunction residual: 9.082e-05


Turning on Anderson Mixing for wavefunction 0
Using singularity subtraction.  Convolution time:  15.100818395614624
Norm of psiNew =  0.99999726774
eigenvalueHistory: 
 [-4.35570871 -4.35570874]
Orbital energy after Harrison update:  -4.35570874152
Anderson mixing on the orbital.
Input densities has shape  (348488, 1)

Anderson weights:  [] 1.0
Orbital 0 error and eigenvalue residual:   -9.332e-05 and 3.313e-08
Orbital 0 wavefunction residual: 4.774e-06


Using singularity subtraction.  Convolution time:  15.116368055343628
Norm of psiNew =  0.999998040738
eigenvalueHistory: 
 [-4.35570871 -4.35570874 -4.35570874]
Orbital energy after Harrison update:  -4.35570874161
Anderson mixing on the orbital.
Input densities has shape  (348488, 2)

Anderson weights:  [-1.82076198] 2.82076198041
Orbital 0 error and eigenvalue residual:   -9.332e-05 and 8.992e-11
Orbital 0 wavefunction residual: 3.174e-06


Using singularity subtraction.  Convolution time:  15.110975742340088
Norm of psiNew =  0.999999609511
eigenvalueHistory: 
 [-4.35570871 -4.35570874 -4.35570874 -4.35570874]
Orbital energy after Harrison update:  -4.3557087417
Anderson mixing on the orbital.
Input densities has shape  (348488, 3)

Anderson weights:  [ 2.71408113 -4.28192211] 2.56784097786
Orbital 0 error and eigenvalue residual:   -9.332e-05 and 8.257e-11
Orbital 0 wavefunction residual: 6.205e-07


Used 4 iterations for orbital 0.



Working on orbital 1
Using singularity subtraction.  Convolution time:  15.106759071350098
Norm of psiNew =  1.00005143123
eigenvalueHistory: 
 -0.7060555396015384
Orbital energy after Harrison update:  -0.706055539602
Orbital 1 error and eigenvalue residual:   -5.567e-05 and 4.552e-05
Orbital 1 wavefunction residual: 5.578e-04


Turning on Anderson Mixing for wavefunction 1
Using singularity subtraction.  Convolution time:  15.120200634002686
Norm of psiNew =  1.00000090219
eigenvalueHistory: 
 [-0.70605554 -0.70605576]
Orbital energy after Harrison update:  -0.706055759482
Anderson mixing on the orbital.
Input densities has shape  (348488, 1)

Anderson weights:  [] 1.0
Orbital 1 error and eigenvalue residual:   -5.589e-05 and 2.199e-07
Orbital 1 wavefunction residual: 9.035e-05


Using singularity subtraction.  Convolution time:  15.129960298538208
Norm of psiNew =  1.00000038826
eigenvalueHistory: 
 [-0.70605554 -0.70605576 -0.70605576]
Orbital energy after Harrison update:  -0.706055763386
Anderson mixing on the orbital.
Input densities has shape  (348488, 2)

Anderson weights:  [-1.79214347] 2.7921434701
Orbital 1 error and eigenvalue residual:   -5.589e-05 and 3.904e-09
Orbital 1 wavefunction residual: 5.987e-05


Using singularity subtraction.  Convolution time:  15.123638391494751
Norm of psiNew =  0.999999800476
eigenvalueHistory: 
 [-0.70605554 -0.70605576 -0.70605576 -0.70605577]
Orbital energy after Harrison update:  -0.706055766488
Anderson mixing on the orbital.
Input densities has shape  (348488, 3)

Anderson weights:  [ 3.42918883 -5.41012913] 2.98094029943
Orbital 1 error and eigenvalue residual:   -5.590e-05 and 3.102e-09
Orbital 1 wavefunction residual: 1.385e-05


Using singularity subtraction.  Convolution time:  15.124510288238525
Norm of psiNew =  0.999999476052
eigenvalueHistory: 
 [-0.70605554 -0.70605576 -0.70605576 -0.70605577 -0.70605577]
Orbital energy after Harrison update:  -0.706055766688
Anderson mixing on the orbital.
Input densities has shape  (348488, 4)

Anderson weights:  [-4.78424095  7.55184875 -4.32299159] 2.5553837835
Orbital 1 error and eigenvalue residual:   -5.590e-05 and 1.998e-10
Orbital 1 wavefunction residual: 4.519e-06


Using singularity subtraction.  Convolution time:  30.950220346450806
Norm of psiNew =  0.999999330554
eigenvalueHistory: 
 [-0.70605554 -0.70605576 -0.70605576 -0.70605577 -0.70605577 -0.70605577]
Orbital energy after Harrison update:  -0.706055766707
Anderson mixing on the orbital.
Input densities has shape  (348488, 5)

Anderson weights:  [  8.60269929 -13.57990989   7.79062521  -4.90746419] 3.0940495795
Orbital 1 error and eigenvalue residual:   -5.590e-05 and 1.967e-11
Orbital 1 wavefunction residual: 1.913e-06


Using singularity subtraction.  Convolution time:  15.124613523483276
Norm of psiNew =  0.999999242758
eigenvalueHistory: 
 [-0.70605554 -0.70605576 -0.70605576 -0.70605577 -0.70605577 -0.70605577
 -0.70605577]
Orbital energy after Harrison update:  -0.70605576671
Anderson mixing on the orbital.
Input densities has shape  (348488, 6)

Anderson weights:  [-4.67168338  7.37480375 -4.22851069  2.69797719 -1.87530858] 1.70272171256
Orbital 1 error and eigenvalue residual:   -5.590e-05 and 2.995e-12
Orbital 1 wavefunction residual: 6.799e-07


Used 7 iterations for orbital 1.



Sorted eigenvalues:  [-4.35570874 -0.70605577]
New order:  [0 1]
../src/dataStructures/TreeStruct_CC.py:156: RuntimeWarning: overflow encountered in exp
  temp = 1/(1+np.exp( exponentialArg ) )
Fermi energy:  1.0
Occupations:  [ 2.  2.]


Integrated density:  4.0000000001
Density Residual  0.000223356275773
Density Residual from arrays  0.000223356275773
Shape of density histories:  (348488, 1) (348488, 1)
Using anderson mixing.
Input densities has shape  (348488, 1)

Anderson weights:  [] 1.0
Integrated anderson density:  4.00000000005
Computing band energy.  Current orbital energies are:  [-4.35570874 -0.70605577]
Electrostatic Energies:
Hartree:          7.115138855
External:         -33.3565936664
Nuclear-Nuclear:  0.0
Updating total energy without explicit kinetic evaluation.
Band energies after Veff update: -8.123529 H, -2.98e-04 H
Orbital Energy Errors after Veff Update:  [ -9.33241780e-05  -5.58962012e-05]
Orbital 0 error: -9.332e-05
Orbital 1 error: -5.590e-05
Orbital Energies:  [-4.35570874 -0.70605577]
Updated V_x:                           -3.0538418248 Hartree
Updated V_c:                           -0.2522035125 Hartree
Updated Band Energy:                   -8.1235290168 H, -2.9844076320e-04 H
Updated Kinetic Energy:                 14.3088322769 H, -2.2789346730e-04 H
Updated E_x:                           -2.2903813686 H, 1.0814728263e-05 H
Updated E_c:                           -0.2234311798 H, 8.7544959484e-07 H
Updated totalElectrostatic:            -26.2414548114 H, -1.7761595011e-05 H
Total Energy:                          -14.4464350830 H, -2.3396488445e-04 H
Energy Residual:                        1.345e+01
Density Residual:                       2.234e-04





SCF Count  2
Orbital Energies:  [-4.35570874 -0.70605577]
Working on orbital 0
Using singularity subtraction.  Convolution time:  15.11965274810791
Norm of psiNew =  1.00000153523
eigenvalueHistory: 
 -4.3557203719191175
Orbital energy after Harrison update:  -4.35572037192
Orbital 0 error and eigenvalue residual:   -1.050e-04 and 1.163e-05
Orbital 0 wavefunction residual: 6.848e-07


Turning on Anderson Mixing for wavefunction 0
Used 1 iterations for orbital 0.



Working on orbital 1
Using singularity subtraction.  Convolution time:  15.134374856948853
Norm of psiNew =  1.00000489316
eigenvalueHistory: 
 -0.7060610788110614
Orbital energy after Harrison update:  -0.706061078811
Orbital 1 error and eigenvalue residual:   -6.121e-05 and 5.312e-06
Orbital 1 wavefunction residual: 4.351e-06


Turning on Anderson Mixing for wavefunction 1
Using singularity subtraction.  Convolution time:  15.126821517944336
Norm of psiNew =  0.999998746063
eigenvalueHistory: 
 [-0.70606108 -0.70606108]
Orbital energy after Harrison update:  -0.706061079372
Anderson mixing on the orbital.
Input densities has shape  (348488, 1)

Anderson weights:  [] 1.0
Orbital 1 error and eigenvalue residual:   -6.121e-05 and 5.610e-10
Orbital 1 wavefunction residual: 2.155e-06


Using singularity subtraction.  Convolution time:  15.121911764144897
Norm of psiNew =  0.999998801505
eigenvalueHistory: 
 [-0.70606108 -0.70606108 -0.70606108]
Orbital energy after Harrison update:  -0.706061079376
Anderson mixing on the orbital.
Input densities has shape  (348488, 2)

Anderson weights:  [-3.17613848] 4.17613847524
Orbital 1 error and eigenvalue residual:   -6.121e-05 and 3.862e-12
Orbital 1 wavefunction residual: 1.726e-06


Using singularity subtraction.  Convolution time:  15.125580072402954
Norm of psiNew =  0.999998997874
eigenvalueHistory: 
 [-0.70606108 -0.70606108 -0.70606108 -0.70606108]
Orbital energy after Harrison update:  -0.706061079385
Anderson mixing on the orbital.
Input densities has shape  (348488, 3)

Anderson weights:  [  9.3502471  -12.48796882] 4.13772171309
Orbital 1 error and eigenvalue residual:   -6.121e-05 and 8.688e-12
Orbital 1 wavefunction residual: 6.621e-07


Used 4 iterations for orbital 1.



Sorted eigenvalues:  [-4.35572037 -0.70606108]
New order:  [0 1]
Fermi energy:  1.0
Occupations:  [ 2.  2.]


Integrated density:  3.99999999999
Density Residual  0.000111543172731
Density Residual from arrays  0.000111543172731
Shape of density histories:  (348488, 2) (348488, 2)
Using anderson mixing.
Input densities has shape  (348488, 2)

Anderson weights:  [-0.99558214] 1.99558213786
Integrated anderson density:  3.99999999999
Computing band energy.  Current orbital energies are:  [-4.35572037 -0.70606108]
Electrostatic Energies:
Hartree:          7.11511361145
External:         -33.3566249349
Nuclear-Nuclear:  0.0
Updating total energy without explicit kinetic evaluation.
Band energies after Veff update: -8.123563 H, -3.32e-04 H
Orbital Energy Errors after Veff Update:  [ -1.04954401e-04  -6.12088756e-05]
Orbital 0 error: -1.050e-04
Orbital 1 error: -6.121e-05
Orbital Energies:  [-4.35572037 -0.70606108]
Updated V_x:                           -3.0538406761 Hartree
Updated V_c:                           -0.2522031428 Hartree
Updated Band Energy:                   -8.1235629026 H, -3.3232655825e-04 H
Updated Kinetic Energy:                 14.3088786283 H, -1.8154211751e-04 H
Updated E_x:                           -2.2903805071 H, 1.1676301565e-05 H
Updated E_c:                           -0.2234308311 H, 1.2242268881e-06 H
Updated totalElectrostatic:            -26.2415113234 H, -7.4273645694e-05 H
Total Energy:                          -14.4464440333 H, -2.4291523475e-04 H
Energy Residual:                        8.950e-06
Density Residual:                       1.115e-04





SCF Count  3
Orbital Energies:  [-4.35572037 -0.70606108]
Working on orbital 0
Using singularity subtraction.  Convolution time:  15.131303787231445
Norm of psiNew =  1.00000095421
eigenvalueHistory: 
 -4.355729058678435
Orbital energy after Harrison update:  -4.35572905868
Orbital 0 error and eigenvalue residual:   -1.136e-04 and 8.687e-06
Orbital 0 wavefunction residual: 2.356e-07


Turning on Anderson Mixing for wavefunction 0
Used 1 iterations for orbital 0.



Working on orbital 1
Using singularity subtraction.  Convolution time:  15.125215291976929
Norm of psiNew =  1.00000311036
eigenvalueHistory: 
 -0.7060648673093857
Orbital energy after Harrison update:  -0.706064867309
Orbital 1 error and eigenvalue residual:   -6.500e-05 and 3.788e-06
Orbital 1 wavefunction residual: 4.506e-06


Turning on Anderson Mixing for wavefunction 1
Using singularity subtraction.  Convolution time:  15.140504598617554
Norm of psiNew =  0.999998778637
eigenvalueHistory: 
 [-0.70606487 -0.70606487]
Orbital energy after Harrison update:  -0.706064867708
Anderson mixing on the orbital.
Input densities has shape  (348488, 1)

Anderson weights:  [] 1.0
Orbital 1 error and eigenvalue residual:   -6.500e-05 and 3.990e-10
Orbital 1 wavefunction residual: 1.996e-06


Using singularity subtraction.  Convolution time:  15.124048948287964
Norm of psiNew =  0.999998823997
eigenvalueHistory: 
 [-0.70606487 -0.70606487 -0.70606487]
Orbital energy after Harrison update:  -0.706064867712
Anderson mixing on the orbital.
Input densities has shape  (348488, 2)

Anderson weights:  [-2.9451622] 3.94516219789
Orbital 1 error and eigenvalue residual:   -6.500e-05 and 3.294e-12
Orbital 1 wavefunction residual: 1.568e-06


